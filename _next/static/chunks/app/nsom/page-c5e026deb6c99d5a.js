(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532],{34819:function(e,t,i){Promise.resolve().then(i.bind(i,46663))},46663:function(e,t,i){"use strict";i.d(t,{default:function(){return et}});var n=i(57437),o=i(2265),r=i(18430);let a={bg:"#F0F5F5",bgDeep:"#E0EBEB",bgWarm:"#D4E0E0",text:"#1A3333",textMuted:"#2D4F4F",textLight:"#3A5858",accent:"#195252",accentBtn:"#1B5656",accentGlow:"rgba(25, 82, 82, 0.10)",green:"#1A5528",greenBtn:"#1D5E2D",greenSoft:"rgba(26, 85, 40, 0.10)",amber:"#6B4E1A",amberBtn:"#6B4E1A",amberSoft:"rgba(107, 78, 26, 0.10)",red:"#7A2D2D",redSoft:"rgba(122, 45, 45, 0.10)",white:"#FFFFFF",border:"#B0C8C8",borderLight:"#C8D8D8",accentDeco:"#2A7A7A",greenDeco:"#3D7A52",redDeco:"#9E4444"},l=["Cognitive","Emotional","Sensory","Social","Executive"],s=["Tight","Heavy","Buzzy","Numb","Warm","Cold","Racing","Foggy","Shallow breathing","Chest pressure","Throat constriction","Jaw clenched"],d=["Work","Home","Parenting","Social event","Meeting","Commute","Morning","Evening","After conflict","Sensory overload","Sleep-deprived","Transition"],c=[{id:"morning",label:"Morning Baseline",icon:"☀",desc:"Set the day's starting state. Brief journaling."},{id:"acute",label:"Regulation Loop",icon:"⚡",desc:"Something happened. Full protocol."},{id:"work",label:"Work Cycle Reset",icon:"⏱",desc:"90-minute cycle break. Condensed loop."},{id:"discharge",label:"End-of-Day Discharge",icon:"☽",desc:"Release work content. Journaling only."},{id:"evening",label:"Evening Wind-Down",icon:"★",desc:"Second daily loop. Day summary."}],h="nsom-v3",g="nsom-entries-v3",u="nsom-checkins-v3",x="nsom-resets-v3",p="nsom-redlines-v3",m={outline:"3px solid #195252",outlineOffset:"2px",borderRadius:4},y={position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",borderWidth:0};function f(){return new Date().toISOString().split("T")[0]}function b(e){return new Date(e+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function v(e){let t=new Date(e+"T12:00:00");return Math.floor(Math.abs(new Date-t)/864e5)}function j(){let e=new Date().getHours();return e<12?"Morning":e<17?"Afternoon":"Evening"}async function S(e,t){try{let i=await fetch("/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({systemPrompt:e,userMessage:t})});if(!i.ok){let e=await i.json();throw Error(e.error||"API request failed")}return(await i.json()).text||"No response received."}catch(e){return console.error("Claude API error:",e),"Unable to connect to analysis. Please try again."}}function k(e){let{children:t,onClick:i,variant:o="primary",disabled:r,small:l,style:s,ariaLabel:d,type:c="button"}=e,h={padding:l?"10px 18px":"14px 28px",minHeight:44,minWidth:44,borderRadius:8,fontSize:l?14:15,fontWeight:600,cursor:r?"default":"pointer",fontFamily:"inherit",border:"none",transition:"background 0.2s, outline-color 0.2s",lineHeight:1.3,letterSpacing:"0.01em",...s},g={primary:{background:r?a.bgWarm:a.accentBtn,color:r?a.textLight:a.white},secondary:{background:"transparent",color:a.textMuted,border:"2px solid ".concat(a.border)},green:{background:a.greenBtn,color:a.white},amber:{background:a.amberBtn,color:a.white},ghost:{background:"transparent",color:a.textMuted,padding:l?"10px 14px":"12px 20px"},danger:{background:a.red,color:a.white}};return(0,n.jsx)("button",{type:c,onClick:i,disabled:r,"aria-label":d,"aria-disabled":r,style:{...h,...g[o]},onFocus:e=>Object.assign(e.target.style,m),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset=""},children:t})}function w(e){let{icon:t,title:i,subtitle:o,id:r}=e;return(0,n.jsxs)("div",{style:{marginBottom:16},role:"heading","aria-level":"2",children:[(0,n.jsxs)("h2",{id:r,style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:26,fontWeight:700,color:a.text,lineHeight:1.2,margin:0},children:[t&&(0,n.jsx)("span",{"aria-hidden":"true",style:{marginRight:10},children:t}),i]}),o&&(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,marginTop:6,margin:0,lineHeight:1.5},children:o})]})}function C(e){let{children:t,type:i="info",role:o="note"}=e,r={info:{bg:a.amberSoft,border:a.amber,color:a.text},success:{bg:a.greenSoft,border:a.green,color:a.text},warning:{bg:a.redSoft,border:a.red,color:a.text},neutral:{bg:a.bgDeep,border:a.accent,color:a.text}}[i];return(0,n.jsx)("div",{role:o,style:{background:r.bg,borderLeft:"4px solid ".concat(r.border),borderRadius:10,padding:"16px 20px",color:r.color,fontSize:15,lineHeight:1.7},children:t})}function B(e){let{label:t,selected:i,onClick:o,ariaLabel:r}=e;return(0,n.jsx)("button",{role:"checkbox","aria-checked":i,"aria-label":r||t,onClick:o,style:{padding:"10px 16px",minHeight:44,borderRadius:22,border:"2px solid ".concat(i?a.accent:a.borderLight),background:i?a.accentGlow:"transparent",color:i?a.accent:a.textMuted,fontSize:14,cursor:"pointer",fontFamily:"inherit",fontWeight:i?700:500,transition:"all 0.15s",lineHeight:1.2},onFocus:e=>Object.assign(e.target.style,m),onBlur:e=>{e.target.style.outline="none"},children:t})}function z(e){let{current:t,total:i,label:o}=e,r=Math.round(t/i*100);return(0,n.jsxs)("div",{role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":i,"aria-label":o,children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,color:a.textMuted,marginBottom:6},children:[(0,n.jsx)("span",{children:o}),(0,n.jsxs)("span",{children:["Step ",t," of ",i]})]}),(0,n.jsx)("div",{style:{height:6,background:a.bgWarm,borderRadius:3,overflow:"hidden"},children:(0,n.jsx)("div",{style:{height:"100%",width:"".concat(r,"%"),background:a.accentDeco,borderRadius:3,transition:"width 0.4s ease"}})})]})}function R(e){var t,i,l;let{active:s,onComplete:d,audioEnabled:c}=e,[h,g]=(0,o.useState)("ready"),[u,x]=(0,o.useState)(0),[p,m]=(0,o.useState)(0),y=(0,o.useRef)(null),f=(0,o.useRef)(null);if((0,o.useEffect)(()=>{if(!s){g("ready"),x(0),m(0);return}"ready"===h&&(g("inhale"),x(4),m(1))},[s]),(0,o.useEffect)(()=>{if(c&&"ready"!==h&&"done"!==h)try{f.current||(f.current=new r.WV({oscillator:{type:"sine"},envelope:{attack:.3,decay:.5,sustain:.3,release:1},volume:-20}).toDestination()),"inhale"===h&&f.current.triggerAttackRelease("C4","0.6"),"exhale"===h&&f.current.triggerAttackRelease("G3","0.8")}catch(e){}},[h,c]),(0,o.useEffect)(()=>{if(s&&"ready"!==h&&"done"!==h)return y.current=setInterval(()=>{x(e=>{if(e<=1){if("inhale"===h)return g("exhale"),6;if("exhale"===h)return p>=3?(g("done"),clearInterval(y.current),setTimeout(()=>null==d?void 0:d(),800),0):(m(e=>e+1),g("inhale"),4)}return e-1})},1e3),()=>clearInterval(y.current)},[h,s,p,d]),(0,o.useEffect)(()=>()=>{f.current&&(f.current.dispose(),f.current=null)},[]),!s||"ready"===h)return null;let b="inhale"===h?120:"exhale"===h?60:90,v=null===(i=(l=window).matchMedia)||void 0===i?void 0:null===(t=i.call(l,"(prefers-reduced-motion: reduce)"))||void 0===t?void 0:t.matches;return(0,n.jsxs)("div",{role:"timer","aria-live":"assertive","aria-label":"Breathing guide. ".concat("done"===h?"Complete":"".concat(h,", ").concat(u," seconds. Breath ").concat(Math.min(p,3)," of 3")),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:14,padding:"24px 0"},children:[(0,n.jsx)("div",{style:{width:b,height:b,borderRadius:"50%",background:"radial-gradient(circle, ".concat(a.accentGlow," 0%, rgba(25,82,82,0.25) 100%)"),border:"3px solid ".concat(a.accentDeco),transition:v?"none":"all 1s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)("span",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:28,color:a.accent,fontWeight:700},children:"done"===h?"✓":u})}),(0,n.jsx)("span",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,color:a.textMuted,fontStyle:"italic"},children:"inhale"===h?"Breathe in through the nose…":"exhale"===h?"Breathe out through the mouth…":"Complete"}),(0,n.jsxs)("span",{style:{fontSize:14,color:a.textLight},children:["Breath ",Math.min(p,3)," of 3"]})]})}function D(e){let{number:t,title:i,why:o,children:r,active:l,completed:s}=e;return(0,n.jsx)("div",{role:"region","aria-label":"Step ".concat(t,": ").concat(i),style:{background:s?a.greenSoft:l?a.white:a.bgDeep,border:"2px solid ".concat(l?a.accent:s?a.green:a.borderLight),borderRadius:14,padding:"20px 24px",transition:"all 0.25s ease",opacity:l||s?1:.5,boxShadow:l?"0 2px 20px ".concat(a.accentGlow):"none"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:16},children:[(0,n.jsx)("div",{"aria-hidden":"true",style:{width:34,height:34,borderRadius:"50%",background:s?a.greenBtn:l?a.accentBtn:a.bgWarm,color:s||l?a.white:a.textMuted,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,flexShrink:0,marginTop:2},children:s?"✓":t}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:4},children:i}),l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.7,marginBottom:r?14:0,margin:0,marginTop:4},children:o}),(0,n.jsx)("div",{style:{marginTop:12},children:r})]})]})]})})}function G(e){let{onYes:t,onNo:i,attempt:o}=e;return(0,n.jsxs)("div",{role:"alertdialog","aria-label":"Decision Gate",style:{background:"linear-gradient(135deg, ".concat(a.amberSoft,", ").concat(a.accentGlow,")"),border:"3px solid ".concat(a.amber),borderRadius:16,padding:"28px 24px",textAlign:"center"},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.amber,marginBottom:10},children:["Decision Gate",o>1?" — Attempt ".concat(o):""]}),(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:a.text,marginBottom:8,margin:0},children:"Did the body show any change?"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,marginBottom:22,lineHeight:1.6,margin:"8px 0 22px"},children:'Any change counts: breathing slightly slower, shoulders slightly lower, thoughts slightly less loud. Even "not worse" is a valid change.'}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[(0,n.jsx)(k,{variant:"green",onClick:t,ariaLabel:"Yes, something shifted",children:"Yes — something shifted"}),(0,n.jsx)(k,{variant:"secondary",onClick:i,ariaLabel:"No change detected",children:"No change"})]})]})}function W(e){let{onSelect:t}=e;return(0,n.jsxs)("div",{role:"region","aria-label":"Choose session type",style:{display:"flex",flexDirection:"column",gap:10},children:[(0,n.jsx)(w,{title:"What does the body need?",subtitle:"Choose the session type that matches right now."}),c.map(e=>(0,n.jsxs)("button",{onClick:()=>t(e.id),"aria-label":"".concat(e.label,": ").concat(e.desc),style:{display:"flex",alignItems:"center",gap:16,padding:"18px 22px",minHeight:68,borderRadius:12,border:"2px solid ".concat(a.borderLight),background:a.white,cursor:"pointer",textAlign:"left",fontFamily:"inherit",transition:"border-color 0.15s, box-shadow 0.15s"},onMouseOver:e=>{e.currentTarget.style.borderColor=a.accent,e.currentTarget.style.boxShadow="0 2px 12px ".concat(a.accentGlow)},onMouseOut:e=>{e.currentTarget.style.borderColor=a.borderLight,e.currentTarget.style.boxShadow="none"},onFocus:e=>Object.assign(e.currentTarget.style,m),onBlur:e=>{e.currentTarget.style.outline="none"},children:[(0,n.jsx)("span",{"aria-hidden":"true",style:{fontSize:26,width:44,textAlign:"center"},children:e.icon}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:17,fontWeight:700,color:a.text,fontFamily:"'Cormorant Garamond', Georgia, serif"},children:e.label}),(0,n.jsx)("div",{style:{fontSize:14,color:a.textMuted,lineHeight:1.4,marginTop:2},children:e.desc})]})]},e.id))]})}function T(e){let{onTranscript:t}=e,[i,r]=(0,o.useState)(!1),[l,s]=(0,o.useState)(0),[d,c]=(0,o.useState)(!1),[h,g]=(0,o.useState)(""),[u,x]=(0,o.useState)(null),[p,y]=(0,o.useState)(null),f=(0,o.useRef)(null),b=(0,o.useRef)([]),v=(0,o.useRef)(null);async function j(){y(null);try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e,{mimeType:"audio/webm"});f.current=t,b.current=[],t.ondataavailable=e=>{e.data.size>0&&b.current.push(e.data)},t.onstop=()=>{let t=new Blob(b.current,{type:"audio/webm"});x(URL.createObjectURL(t)),e.getTracks().forEach(e=>e.stop()),S(t)},t.start(250),r(!0),s(0),v.current=setInterval(()=>s(e=>e+1),1e3)}catch(e){y("Could not access microphone. Use typed journaling instead.")}}async function S(e){c(!0);try{var i;let e=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:500,system:"The user recorded an audio journal entry in a nervous system regulation app for "+l+" seconds. Generate a realistic transcript of what a neurodivergent person might say after completing a regulation loop. 2-3 sentences of body-state description only.",messages:[{role:"user",content:"Generate a realistic journal entry transcript."}]})}),n=await e.json(),o=(null===(i=n.content)||void 0===i?void 0:i.map(e=>e.text||"").join(""))||"";g(o),null==t||t(o)}catch(e){y("Transcription unavailable. Add typed notes instead.")}c(!1)}return(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(i?a.redDeco:a.borderLight),borderRadius:12,padding:"18px 20px"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[(0,n.jsx)("span",{style:{fontSize:14,fontWeight:600,color:a.textMuted},children:i?"Recording…":h?"Transcript":"Audio Journal"}),i&&(0,n.jsxs)("span",{"aria-live":"polite",style:{fontSize:14,color:a.red,fontWeight:600},children:[Math.floor(l/60),":",(l%60).toString().padStart(2,"0")]})]}),!h&&!d&&(0,n.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i?(0,n.jsx)(k,{onClick:function(){f.current&&i&&(f.current.stop(),r(!1),clearInterval(v.current))},variant:"danger",ariaLabel:"Stop recording",style:{borderRadius:28,minWidth:56,minHeight:56,fontSize:20},children:"■"}):(0,n.jsx)(k,{onClick:j,ariaLabel:"Start recording",style:{background:a.red,color:a.white,borderRadius:28,minWidth:56,minHeight:56,fontSize:22},children:"●"}),(0,n.jsx)("span",{style:{fontSize:14,color:a.textLight},children:i?"Tap to stop when done.":"Tap to speak your journal entry."})]}),d&&(0,n.jsx)("div",{role:"status","aria-live":"polite",style:{padding:"16px 0",textAlign:"center",fontSize:15,color:a.textMuted},children:"Transcribing…"}),h&&(0,n.jsxs)("div",{style:{marginTop:8},children:[(0,n.jsx)("textarea",{value:h,onChange:e=>{g(e.target.value),null==t||t(e.target.value)},"aria-label":"Audio transcript — review and edit",style:{width:"100%",minHeight:80,padding:14,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text,background:a.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box"},onFocus:function(e){Object.assign(e.target.style,m)},onBlur:function(e){e.target.style.outline="none",e.target.style.outlineOffset=""}}),(0,n.jsx)("div",{style:{fontSize:13,color:a.textLight,marginTop:6},children:"Review and edit if needed."})]}),u&&!i&&(0,n.jsx)("audio",{controls:!0,src:u,style:{width:"100%",marginTop:8,height:44},"aria-label":"Playback"}),p&&(0,n.jsx)("div",{role:"alert",style:{marginTop:10,fontSize:14,color:a.red,lineHeight:1.5},children:p})]})}function L(e){let{onComplete:t}=e,[i,r]=(0,o.useState)([]);return(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px",marginTop:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,marginBottom:8},children:"Body check"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,marginBottom:14,margin:"0 0 14px"},children:"What sensations are present right now? Select all that apply."}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:16},children:s.map(e=>(0,n.jsx)(B,{label:e,active:i.includes(e),onClick:()=>{r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])}},e))}),(0,n.jsx)(k,{onClick:function(){null==t||t(i)},ariaLabel:"Continue journaling",disabled:0===i.length,children:"Continue →"})]})}function M(e){let{onSave:t,sessionType:i}=e,[r,l]=(0,o.useState)("transcript"),[s,c]=(0,o.useState)(""),[h,g]=(0,o.useState)([]),[u,x]=(0,o.useState)([]),[p,y]=(0,o.useState)(null),[f,b]=(0,o.useState)("");function v(e){Object.assign(e.target.style,m)}function j(e){e.target.style.outline="none",e.target.style.outlineOffset=""}return(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:["transcript"===r&&(0,n.jsxs)("div",{children:[(0,n.jsx)(T,{onTranscript:function(e){c(e)}}),s&&(0,n.jsx)("div",{style:{marginTop:16},children:(0,n.jsx)(k,{onClick:()=>l("bodycheck"),ariaLabel:"Continue to body check",children:"Continue to body check →"})})]}),"bodycheck"===r&&(0,n.jsx)(L,{onComplete:function(e){g(e),l("contexts")}}),"contexts"===r&&(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,marginBottom:8},children:"Context"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,marginBottom:14,margin:"0 0 14px"},children:"What contexts were active? Select all that apply."}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:16},children:d.map(e=>(0,n.jsx)(B,{label:e,active:u.includes(e),onClick:()=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])}},e))}),(0,n.jsx)(k,{onClick:function(){l("burnout")},ariaLabel:"Continue to burnout rating",disabled:0===u.length,children:"Continue →"})]}),"burnout"===r&&(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,marginBottom:8},children:"Burnout index"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,marginBottom:14,margin:"0 0 14px"},children:"Rate your current burnout level from 1 (minimal) to 10 (severe)."}),(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:8,marginBottom:16},children:[1,2,3,4,5,6,7,8,9,10].map(e=>(0,n.jsx)("button",{onClick:()=>y(e),"aria-label":"Rate burnout as ".concat(e," out of 10"),"aria-pressed":p===e,style:{padding:"12px",border:"2px solid ".concat(p===e?a.accent:a.borderLight),borderRadius:8,background:p===e?a.accentGlow:a.white,color:p===e?a.accent:a.text,fontSize:16,fontWeight:p===e?700:500,cursor:"pointer",fontFamily:"inherit",transition:"all 0.15s"},onFocus:v,onBlur:j,children:e},e))}),(0,n.jsx)(k,{onClick:function(){l("notes")},ariaLabel:"Continue to notes",disabled:null===p,children:"Continue →"})]}),"notes"===r&&(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,marginBottom:8},children:"Additional notes (optional)"}),(0,n.jsx)("textarea",{value:f,onChange:e=>b(e.target.value),placeholder:"Any additional observations...","aria-label":"Additional notes",style:{width:"100%",minHeight:100,padding:14,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text,background:a.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box",marginBottom:16},onFocus:v,onBlur:j}),(0,n.jsx)(k,{onClick:function(){let e={transcript:s,bodySensations:h,contexts:u,burnoutRating:p,notes:f,timestamp:new Date().toISOString(),sessionType:i};null==t||t(e)},ariaLabel:"Save journal entry",children:"Save entry"})]})]})}function A(e){var t,i,r;let{onComplete:l,existing:s}=e,[d,c]=(0,o.useState)(null!==(t=null==s?void 0:s.sleep)&&void 0!==t?t:null),[h,g]=(0,o.useState)(null!==(i=null==s?void 0:s.appetite)&&void 0!==i?i:null),[u,x]=(0,o.useState)(null!==(r=null==s?void 0:s.social)&&void 0!==r?r:null);function p(e){Object.assign(e.target.style,m)}function y(e){e.target.style.outline="none",e.target.style.outlineOffset=""}let f=null!==d&&null!==h&&null!==u;return(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:8},children:"Daily check-in"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,marginBottom:18,margin:"0 0 18px"},children:"Track three daily baseline markers."}),(0,n.jsxs)("div",{style:{marginBottom:20},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:15,fontWeight:600,color:a.text,marginBottom:10},children:"Sleep quality last night"}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:["Poor","Fair","Good","Excellent"].map((e,t)=>(0,n.jsx)("button",{onClick:()=>c(t+1),"aria-label":"Rate sleep as ".concat(e),"aria-pressed":d===t+1,style:{flex:1,padding:"10px 12px",border:"2px solid ".concat(d===t+1?a.accent:a.borderLight),borderRadius:8,background:d===t+1?a.accentGlow:a.white,color:d===t+1?a.accent:a.textMuted,fontSize:14,fontWeight:d===t+1?700:500,cursor:"pointer",fontFamily:"inherit",transition:"all 0.15s"},onFocus:p,onBlur:y,children:e},e))})]}),(0,n.jsxs)("div",{style:{marginBottom:20},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:15,fontWeight:600,color:a.text,marginBottom:10},children:"Appetite today"}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:["Low","Reduced","Normal","Strong"].map((e,t)=>(0,n.jsx)("button",{onClick:()=>g(t+1),"aria-label":"Rate appetite as ".concat(e),"aria-pressed":h===t+1,style:{flex:1,padding:"10px 12px",border:"2px solid ".concat(h===t+1?a.accent:a.borderLight),borderRadius:8,background:h===t+1?a.accentGlow:a.white,color:h===t+1?a.accent:a.textMuted,fontSize:14,fontWeight:h===t+1?700:500,cursor:"pointer",fontFamily:"inherit",transition:"all 0.15s"},onFocus:p,onBlur:y,children:e},e))})]}),(0,n.jsxs)("div",{style:{marginBottom:20},children:[(0,n.jsx)("label",{style:{display:"block",fontSize:15,fontWeight:600,color:a.text,marginBottom:10},children:"Social contact today"}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:["None","Minimal","Moderate","High"].map((e,t)=>(0,n.jsx)("button",{onClick:()=>x(t+1),"aria-label":"Rate social contact as ".concat(e),"aria-pressed":u===t+1,style:{flex:1,padding:"10px 12px",border:"2px solid ".concat(u===t+1?a.accent:a.borderLight),borderRadius:8,background:u===t+1?a.accentGlow:a.white,color:u===t+1?a.accent:a.textMuted,fontSize:14,fontWeight:u===t+1?700:500,cursor:"pointer",fontFamily:"inherit",transition:"all 0.15s"},onFocus:p,onBlur:y,children:e},e))})]}),(0,n.jsx)(k,{onClick:function(){null!==d&&null!==h&&null!==u&&(null==l||l({sleep:d,appetite:h,social:u}))},ariaLabel:"Complete daily check-in",disabled:!f,children:"Complete check-in"})]})}function F(e){let{redlines:t,onDismiss:i}=e;if(!t||0===t.length)return null;let o=t.filter(e=>!e.dismissed);return 0===o.length?null:(0,n.jsxs)("div",{role:"alert",style:{background:"linear-gradient(135deg, ".concat(a.redSoft,", ").concat(a.amberSoft,")"),border:"3px solid ".concat(a.red),borderRadius:14,padding:"20px 22px",marginBottom:20},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.red,marginBottom:8},children:"⚠ Red Line Alert"}),o.map((e,t)=>(0,n.jsxs)("div",{style:{background:a.white,borderRadius:8,padding:"14px 16px",marginBottom:t<o.length-1?12:0},children:[(0,n.jsx)("div",{style:{fontSize:15,fontWeight:600,color:a.text,marginBottom:4},children:e.type}),(0,n.jsx)("div",{style:{fontSize:14,color:a.textMuted,marginBottom:10,lineHeight:1.5},children:e.description}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:13,color:a.textLight},children:[(0,n.jsxs)("span",{children:["Active for ",v(e.date)," day",1!==v(e.date)?"s":""]}),(0,n.jsx)(k,{small:!0,variant:"ghost",onClick:()=>null==i?void 0:i(e.id),ariaLabel:"Dismiss ".concat(e.type," alert"),children:"Dismiss"})]})]},t)),(0,n.jsx)("p",{style:{fontSize:13,color:a.text,marginTop:14,lineHeight:1.6,fontStyle:"italic",margin:"14px 0 0"},children:"Red lines persist across days until explicitly dismissed. They are not forgotten by the system."})]})}let I=[{title:"Review the week",prompt:"Look back at your entries from the past 7 days. What patterns do you notice?"},{title:"Identify load domains",prompt:"Which areas created the most activation? (Work, social, sensory, etc.)"},{title:"Note what worked",prompt:"Which regulation strategies were most effective this week?"},{title:"Note what didn't",prompt:"Which approaches failed to produce body change? No judgment, just data."},{title:"Set one intention",prompt:"Choose ONE small adjustment for next week. Not a goal. An experiment."}];function H(e){let{onComplete:t,entries:i}=e,[r,l]=(0,o.useState)(0),[s,d]=(0,o.useState)([,,,,,].fill("")),c=I[r];return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 22px",marginBottom:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.accent,marginBottom:8},children:"Weekly Reset Protocol"}),(0,n.jsx)(z,{current:r+1,total:I.length,label:"Reset progress"})]}),(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.accent),borderRadius:12,padding:"24px 26px"},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:a.text,marginBottom:10},children:["Step ",r+1,": ",c.title]}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,lineHeight:1.7,marginBottom:16,margin:"0 0 16px"},children:c.prompt}),0===r&&i&&i.length>0&&(0,n.jsxs)("div",{style:{background:a.bgDeep,borderRadius:8,padding:14,marginBottom:16,fontSize:13,color:a.textMuted},children:["You completed ",i.length," session",1!==i.length?"s":""," this week."]}),(0,n.jsx)("textarea",{value:s[r],onChange:e=>(function(e){let t=[...s];t[r]=e,d(t)})(e.target.value),placeholder:"Write your reflection here...","aria-label":c.title,style:{width:"100%",minHeight:120,padding:14,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text,background:a.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box",marginBottom:16},onFocus:function(e){Object.assign(e.target.style,m)},onBlur:function(e){e.target.style.outline="none",e.target.style.outlineOffset=""}}),(0,n.jsxs)("div",{style:{display:"flex",gap:10,justifyContent:"space-between"},children:[r>0&&(0,n.jsx)(k,{variant:"secondary",onClick:function(){r>0&&l(r-1)},ariaLabel:"Go back to previous step",children:"← Back"}),(0,n.jsx)(k,{onClick:function(){r<I.length-1?l(r+1):null==t||t({responses:s,timestamp:new Date().toISOString(),entriesReviewed:(null==i?void 0:i.length)||0})},ariaLabel:r<I.length-1?"Continue to next step":"Complete weekly reset",disabled:0===s[r].trim().length,style:{marginLeft:0===r?"auto":void 0},children:r<I.length-1?"Next →":"Complete reset"})]})]})]})}var E=i(47625),N=i(58336),O=i(56940),P=i(97059),J=i(62994),V=i(8147),U=i(22190),Y=i(54061);function _(e){let{data:t}=e;if(!t||0===t.length)return(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"40px 22px",textAlign:"center",color:a.textMuted},children:[(0,n.jsx)("div",{style:{fontSize:15},children:"No data to display yet."}),(0,n.jsx)("div",{style:{fontSize:13,marginTop:6},children:"Complete sessions with HRV and burnout tracking to see trends."})]});let i=t.map(e=>({date:b(e.date),hrv:e.hrv||null,burnout:e.burnoutRating||null}));return(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 18px",border:"2px solid ".concat(a.borderLight)},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:16},children:"HRV & Burnout Trends"}),(0,n.jsx)(E.h,{width:"100%",height:300,children:(0,n.jsxs)(N.w,{data:i,margin:{top:5,right:20,left:0,bottom:5},children:[(0,n.jsx)(O.q,{strokeDasharray:"3 3",stroke:a.borderLight}),(0,n.jsx)(P.K,{dataKey:"date",tick:{fill:a.textMuted,fontSize:12},stroke:a.border}),(0,n.jsx)(J.B,{yAxisId:"left",label:{value:"HRV",angle:-90,position:"insideLeft",style:{fill:a.textMuted,fontSize:12}},tick:{fill:a.textMuted,fontSize:12},stroke:a.border}),(0,n.jsx)(J.B,{yAxisId:"right",orientation:"right",label:{value:"Burnout",angle:90,position:"insideRight",style:{fill:a.textMuted,fontSize:12}},tick:{fill:a.textMuted,fontSize:12},stroke:a.border,domain:[0,10]}),(0,n.jsx)(V.u,{contentStyle:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:13}}),(0,n.jsx)(U.D,{wrapperStyle:{fontSize:13,color:a.textMuted}}),(0,n.jsx)(Y.x,{yAxisId:"left",type:"monotone",dataKey:"hrv",stroke:a.green,strokeWidth:2,dot:{fill:a.greenBtn,r:4},name:"HRV",connectNulls:!0}),(0,n.jsx)(Y.x,{yAxisId:"right",type:"monotone",dataKey:"burnout",stroke:a.amber,strokeWidth:2,dot:{fill:a.amber,r:4},name:"Burnout Index",connectNulls:!0})]})}),(0,n.jsx)("p",{style:{fontSize:13,color:a.textMuted,marginTop:14,lineHeight:1.5,fontStyle:"italic"},children:"Higher HRV (green) indicates better nervous system capacity. Higher burnout (amber) indicates reduced capacity."})]})}function q(e){let{entries:t}=e,[i,r]=(0,o.useState)(null);return t&&0!==t.length?i?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)(k,{variant:"ghost",onClick:()=>r(null),ariaLabel:"Back to history list",children:"← Back to list"})}),(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text},children:b(i.date)}),(0,n.jsxs)("div",{style:{fontSize:14,color:a.textMuted,marginTop:2},children:[i.timeOfDay," \xb7 ",i.sessionType||"regulation"]})]}),i.locked&&(0,n.jsx)("div",{style:{fontSize:20,color:a.textLight},"aria-label":"This entry is locked",children:"\uD83D\uDD12"})]}),void 0!==i.gatePassed&&(0,n.jsx)("div",{style:{display:"inline-block",padding:"6px 12px",borderRadius:6,background:i.gatePassed?a.greenSoft:a.amberSoft,color:i.gatePassed?a.green:a.amber,fontSize:13,fontWeight:600,marginBottom:16},children:i.gatePassed?"Gate passed ✓":"Escalated to DGAEP"}),i.transcript&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Transcript"}),(0,n.jsx)("div",{style:{fontSize:15,color:a.text,lineHeight:1.7,fontFamily:"'Source Serif 4', Georgia, serif"},children:i.transcript})]}),i.bodySensations&&i.bodySensations.length>0&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Body sensations"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:i.bodySensations.map(e=>(0,n.jsx)(B,{label:e,active:!1},e))})]}),i.contexts&&i.contexts.length>0&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Contexts"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:i.contexts.map(e=>(0,n.jsx)(B,{label:e,active:!1},e))})]}),void 0!==i.burnoutRating&&null!==i.burnoutRating&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Burnout index"}),(0,n.jsxs)("div",{style:{fontSize:24,fontWeight:700,color:a.amber},children:[i.burnoutRating,"/10"]})]}),i.notes&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Notes"}),(0,n.jsx)("div",{style:{fontSize:15,color:a.text,lineHeight:1.7,fontFamily:"'Source Serif 4', Georgia, serif"},children:i.notes})]}),i.locked&&(0,n.jsx)("div",{style:{marginTop:20,padding:"12px 16px",background:a.bgDeep,borderRadius:8,fontSize:13,color:a.textMuted,fontStyle:"italic"},children:"This entry was locked 24 hours after creation and cannot be edited."})]})]}):(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:t.slice().reverse().map((e,t)=>(0,n.jsxs)("button",{onClick:()=>r(e),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,cursor:"pointer",textAlign:"left",fontFamily:"inherit",transition:"all 0.15s"},onMouseOver:e=>{e.currentTarget.style.borderColor=a.accent,e.currentTarget.style.boxShadow="0 2px 12px ".concat(a.accentGlow)},onMouseOut:e=>{e.currentTarget.style.borderColor=a.borderLight,e.currentTarget.style.boxShadow="none"},children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontSize:15,fontWeight:600,color:a.text,marginBottom:4},children:b(e.date)}),(0,n.jsxs)("div",{style:{fontSize:13,color:a.textMuted},children:[e.timeOfDay," \xb7 ",e.sessionType||"regulation"]})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.locked&&(0,n.jsx)("span",{style:{fontSize:16,color:a.textLight},children:"\uD83D\uDD12"}),(0,n.jsx)("span",{style:{fontSize:13,fontWeight:600,color:e.gatePassed?a.green:a.amber},children:void 0!==e.gatePassed?e.gatePassed?"Gate ✓":"DGAEP":"—"})]})]},t))}):(0,n.jsxs)("div",{style:{textAlign:"center",padding:"44px 22px",color:a.textLight},children:[(0,n.jsx)("div",{"aria-hidden":"true",style:{fontSize:30,marginBottom:10},children:"◉"}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,color:a.textMuted},children:"No entries yet"}),(0,n.jsx)("div",{style:{fontSize:14,marginTop:6},children:"Complete your first session to begin tracking."})]})}function K(e){let{duration:t,label:i,onComplete:r}=e,[l,s]=(0,o.useState)(t),[d,c]=(0,o.useState)(!1),h=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(!d){clearInterval(h.current);return}return h.current=setInterval(()=>{s(e=>e<=1?(clearInterval(h.current),c(!1),null==r||r(),0):e-1)},1e3),()=>clearInterval(h.current)},[d,r]);let g=Math.floor(l/60),u=l%60,x=(t-l)/t*100;return(0,n.jsxs)("div",{role:"timer","aria-label":"".concat(i,": ").concat(g," minutes ").concat(u," seconds remaining"),style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:10,padding:"16px 20px"},children:[(0,n.jsx)("div",{style:{fontSize:14,color:a.textLight,marginBottom:8},children:i}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:36,fontWeight:700,color:0===l?a.green:a.text,minWidth:95,fontVariantNumeric:"tabular-nums"},children:[g,":",u.toString().padStart(2,"0")]}),(0,n.jsx)("div",{style:{flex:1},children:(0,n.jsx)("div",{style:{height:8,background:a.bgDeep,borderRadius:4,overflow:"hidden"},children:(0,n.jsx)("div",{style:{height:"100%",width:"".concat(x,"%"),background:0===l?a.greenDeco:a.accentDeco,borderRadius:4,transition:"width 1s linear"}})})}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:0===l?(0,n.jsx)(k,{small:!0,variant:"green",onClick:()=>{s(t)},ariaLabel:"Timer complete, reset",children:"Complete"}):d?(0,n.jsx)(k,{small:!0,variant:"secondary",onClick:()=>c(!1),ariaLabel:"Pause timer",children:"Pause"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k,{small:!0,onClick:()=>c(!0),ariaLabel:l<t?"Resume timer":"Start timer",children:l<t?"Resume":"Start"}),l<t&&(0,n.jsx)(k,{small:!0,variant:"ghost",onClick:()=>{c(!1),s(t)},ariaLabel:"Reset timer",children:"Reset"})]})})]})]})}let X=[{level:1,title:"Lie down with legs elevated",why:"Blood flow to torso activates vagal brake. 10 minutes minimum.",duration:600},{level:2,title:"Cold water on face",why:"Mammalian dive reflex. Activates parasympathetic immediately. 30 seconds minimum.",duration:30},{level:3,title:"Weighted blanket or compression",why:"Deep pressure proprioception. Tells the body it is held. 15 minutes.",duration:900},{level:4,title:"Vocalisation or humming",why:"Vocal vibration stimulates vagus directly. Hum one song or speak aloud for 5 minutes.",duration:300},{level:5,title:"Call your protocol contact",why:"Social co-regulation is the most powerful intervention. Not texting. Voice.",duration:600},{level:6,title:"Crisis escalation",why:"The protocol has been exhausted. Medical or crisis support is indicated.",duration:0}];function Z(e){let{onComplete:t}=e,[i,r]=(0,o.useState)(0),[l,s]=(0,o.useState)(!1),d=X[i];return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 22px",marginBottom:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.amber,marginBottom:8},children:"Decision-Gated Autonomic Escalation Protocol"}),(0,n.jsx)(z,{current:i+1,total:X.length,label:"DGAEP progress"})]}),(0,n.jsxs)("div",{style:{background:a.white,border:"3px solid ".concat(a.amber),borderRadius:14,padding:"24px 26px"},children:[(0,n.jsxs)("div",{style:{display:"inline-block",padding:"6px 14px",borderRadius:6,background:a.amberSoft,color:a.amber,fontSize:13,fontWeight:700,marginBottom:12},children:["Level ",d.level]}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:24,fontWeight:700,color:a.text,marginBottom:10},children:d.title}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,lineHeight:1.7,marginBottom:20,margin:"0 0 20px"},children:d.why}),d.duration>0&&!l&&(0,n.jsx)(k,{onClick:function(){s(!0)},ariaLabel:"Start ".concat(d.duration," second timer for level ").concat(d.level),children:"Start timer"}),d.duration>0&&l&&(0,n.jsx)(K,{duration:d.duration,label:d.title,onComplete:function(){s(!1)}}),6===d.level&&(0,n.jsxs)("div",{role:"alert",style:{background:a.redSoft,border:"2px solid ".concat(a.red),borderRadius:10,padding:"16px 18px",marginBottom:20},children:[(0,n.jsx)("div",{style:{fontSize:15,fontWeight:600,color:a.red,marginBottom:8},children:"Protocol exhausted"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.text,lineHeight:1.6,margin:0},children:"Five escalation levels have been attempted without body change. This indicates activation beyond self-regulation capacity. Contact your crisis support system or emergency services."})]}),(d.duration>0&&!l||6===d.level)&&(0,n.jsx)("div",{style:{marginTop:20},children:(0,n.jsx)(k,{variant:"secondary",onClick:function(){i<X.length-1?(r(i+1),s(!1)):null==t||t({levelsCompleted:i+1})},ariaLabel:d.level<6?"Move to next DGAEP level":"Complete DGAEP protocol",children:d.level<6?"Next level →":"End protocol"})})]}),(0,n.jsxs)("div",{style:{marginTop:16,padding:"14px 18px",background:a.bgDeep,borderRadius:10,fontSize:13,color:a.textMuted,lineHeight:1.6,fontStyle:"italic"},children:[(0,n.jsx)("strong",{children:"Core principle:"})," Complete each level fully before moving to the next. The body is the authority on whether to escalate."]})]})}let $=[{category:"Physical",lines:["Sleep < 4 hours for 2 consecutive nights","No food for > 16 hours (unintentional)","Persistent physical pain that prevents regulation"]},{category:"Cognitive",lines:["Suicidal ideation present","Dissociation lasting > 2 hours","Unable to complete basic self-care tasks"]},{category:"Social",lines:["Zero social contact for 3+ days (when not intentional)","Conflict that persists unresolved for > 48 hours","Isolation that feels involuntary"]},{category:"Capacity",lines:["DGAEP escalation 3+ times in one week","Gate failed 5+ times in 7 days","Regulation loop ineffective for 72 hours"]}];function Q(){return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 22px",marginBottom:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:a.text,marginBottom:8},children:"Red Lines Reference"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,margin:0},children:"Red lines are system-wide alerts that persist across days. When crossed, they indicate capacity has been exceeded and escalation is required."})]}),$.map((e,t)=>(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"18px 20px",marginBottom:12},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,marginBottom:10},children:e.category}),(0,n.jsx)("ul",{style:{margin:0,paddingLeft:20,listStyleType:"disc"},children:e.lines.map((t,i)=>(0,n.jsx)("li",{style:{fontSize:14,color:a.textMuted,lineHeight:1.7,marginBottom:i<e.lines.length-1?8:0},children:t},i))})]},t)),(0,n.jsxs)("div",{style:{marginTop:16,padding:"16px 18px",background:a.redSoft,border:"2px solid ".concat(a.red),borderRadius:10,fontSize:13,color:a.text,lineHeight:1.6},children:[(0,n.jsx)("strong",{style:{color:a.red},children:"Important:"})," Red lines are not judgments. They are system alerts. When a red line is crossed, it means the nervous system needs support beyond what self-regulation can provide."]})]})}function ee(e){let{entries:t,onAnalysisComplete:i}=e,[r,s]=(0,o.useState)(!1),[d,c]=(0,o.useState)([]),[h,g]=(0,o.useState)("");async function u(){s(!0);try{let e=t.slice(-7),n="Analyze these journal entries and identify the primary load domains (cognitive, sensory, social, physical, emotional) that are creating nervous system activation. Provide a brief analysis (2-3 sentences) and list the top 2-3 load domains.\n\nEntries:\n".concat(e.map((e,t)=>"".concat(t+1,". ").concat(e.transcript||"No transcript")).join("\n"),"\n\nFormat your response as:\nANALYSIS: [your analysis]\nDOMAINS: [comma-separated list of domains]"),o=await S(n),r=o.match(RegExp("ANALYSIS:\\s*(.+?)(?=DOMAINS:|$)","s")),a=o.match(/DOMAINS:\s*(.+)/);if(r&&g(r[1].trim()),a){let e=a[1].split(",").map(e=>e.trim()).filter(e=>l.includes(e));c(e)}null==i||i({domains:d,analysis:h})}catch(e){g("Analysis unavailable. Please try again later.")}s(!1)}return(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:8},children:"Load Domain Analysis"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,marginBottom:16,margin:"0 0 16px"},children:"AI analysis of your recent entries to identify primary sources of nervous system load."}),!h&&(0,n.jsx)(k,{onClick:u,disabled:r||!t||0===t.length,ariaLabel:"Analyze load domains",children:r?"Analyzing...":"Analyze patterns"}),h&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{background:a.bgDeep,borderRadius:8,padding:"14px 16px",marginBottom:14,fontSize:14,color:a.text,lineHeight:1.6},children:h}),d.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Identified load domains"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:16},children:d.map(e=>(0,n.jsx)(B,{label:e,active:!0},e))})]}),(0,n.jsx)(k,{variant:"secondary",onClick:()=>{g(""),c([])},ariaLabel:"Run new analysis",children:"Run new analysis"})]}),t&&0===t.length&&(0,n.jsx)("div",{style:{fontSize:13,color:a.textLight,fontStyle:"italic",marginTop:8},children:"Complete at least one journal entry to enable analysis."})]})}function et(){let[e,t]=(0,o.useState)("loop"),[i,l]=(0,o.useState)(null),[s,d]=(0,o.useState)(1),[c,m]=(0,o.useState)(!1),[b,v]=(0,o.useState)(!1),[S,B]=(0,o.useState)(!1),[T,L]=(0,o.useState)(!1),[I,E]=(0,o.useState)(1),[N,O]=(0,o.useState)(!1),[P,J]=(0,o.useState)(!1),[V,U]=(0,o.useState)([]),[Y,K]=(0,o.useState)([]),[X,$]=(0,o.useState)([]),[et,ei]=(0,o.useState)([]),[en,eo]=(0,o.useState)([]),[er,ea]=(0,o.useState)(!0),[el,es]=(0,o.useState)(!1),[ed,ec]=(0,o.useState)(!1),[eh,eg]=(0,o.useState)(!1);(0,o.useEffect)(()=>{try{let t=localStorage.getItem(h);t&&U(JSON.parse(t));let i=localStorage.getItem(g);i&&K(JSON.parse(i));let n=localStorage.getItem(u);n&&$(JSON.parse(n));let o=localStorage.getItem(x);o&&ei(JSON.parse(o));let r=localStorage.getItem(p);r&&eo(JSON.parse(r));let a=f();JSON.parse(n||"[]").find(e=>e.date===a)||"loop"!==e||es(!0)}catch(e){}ea(!1)},[]);let eu=(0,o.useCallback)((e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(e){}},[]);function ex(){s<6?d(s+1):B(!0)}function ep(e){let t=en.map(t=>t.id===e?{...t,dismissed:!0}:t);eo(t),eu(p,t)}function em(){d(1),m(!1),B(!1),L(!1),E(1),O(!1),J(!1),l(null)}let ey=f(),ef=X.find(e=>e.date===ey);return er?(0,n.jsx)("div",{style:{minHeight:"100vh",background:a.bg,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)("div",{role:"status",style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,color:a.textMuted},children:"Loading…"})}):(0,n.jsxs)("div",{style:{minHeight:"100vh",background:a.bg,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text},children:[(0,n.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Source+Serif+4:ital,wght@0,300;0,400;0,500;0,600;1,400&display=swap",rel:"stylesheet"}),(0,n.jsx)("a",{href:"#main-content",style:y,children:"Skip to main content"}),(0,n.jsx)("header",{style:{borderBottom:"2px solid ".concat(a.border),padding:"26px 22px 20px",background:a.white},children:(0,n.jsxs)("div",{style:{maxWidth:720,margin:"0 auto"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:3,color:a.accent,marginBottom:6},children:"The Nervous System Operating Manual"}),(0,n.jsx)("h1",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:30,fontWeight:700,color:a.text,lineHeight:1.2,margin:0},children:"Daily Regulation Protocol"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,fontStyle:"italic",margin:"6px 0 0"},children:"Your body has a job. Its job is to keep you safe. This protocol tells you how to let it."}),(0,n.jsxs)("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:10},children:[(0,n.jsx)("button",{role:"switch","aria-checked":b,onClick:async()=>{if(!b)try{await r.BL()}catch(e){}v(!b)},style:{width:48,height:28,borderRadius:14,border:"none",cursor:"pointer",background:b?a.accentBtn:a.bgWarm,position:"relative",transition:"background 0.2s"},children:(0,n.jsx)("div",{style:{width:22,height:22,borderRadius:"50%",background:a.white,position:"absolute",top:3,left:b?23:3,transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.15)"}})}),(0,n.jsx)("span",{style:{fontSize:13,color:a.textMuted},children:"Audio breathing cues"})]})]})}),(0,n.jsx)("nav",{"aria-label":"Main navigation",style:{borderBottom:"2px solid ".concat(a.border),background:a.white,position:"sticky",top:0,zIndex:10},children:(0,n.jsx)("div",{style:{maxWidth:720,margin:"0 auto",display:"flex",overflowX:"auto"},children:[{id:"loop",label:"Regulate",icon:"\uD83D\uDD04"},{id:"dgaep",label:"DGAEP",icon:"↑"},{id:"tracking",label:"Tracking",icon:"\uD83D\uDCC8"},{id:"weekly",label:"Weekly",icon:"\uD83D\uDCC5"},{id:"analysis",label:"Analysis",icon:"\uD83D\uDD0D"},{id:"redlines",label:"Red Lines",icon:"⚠"}].map(i=>(0,n.jsxs)("button",{onClick:()=>{t(i.id),"loop"===i.id&&em()},"aria-current":e===i.id?"page":void 0,style:{padding:"14px 18px",minHeight:48,border:"none",borderBottom:e===i.id?"3px solid ".concat(a.accent):"3px solid transparent",background:"transparent",color:e===i.id?a.accent:a.textMuted,fontSize:14,fontWeight:e===i.id?700:500,cursor:"pointer",fontFamily:"inherit",whiteSpace:"nowrap"},children:[(0,n.jsx)("span",{"aria-hidden":"true",children:i.icon})," ",i.label]},i.id))})}),(0,n.jsxs)("main",{id:"main-content",style:{maxWidth:720,margin:"0 auto",padding:"24px 18px 90px"},children:["redlines"!==e&&(0,n.jsx)(F,{redlines:en,onDismiss:ep}),"loop"===e&&el&&!ed&&(0,n.jsx)(A,{onComplete:function(e){let t=[...X,{...e,date:f()}];$(t),eu(u,t),es(!1),ec(!0)},existing:ef}),"loop"===e&&(0,n.jsxs)("div",{children:[!i&&!P&&!el&&(0,n.jsx)(W,{onSelect:l}),i&&"discharge"!==i&&(0,n.jsxs)("div",{children:[(0,n.jsxs)(C,{type:"info",children:[(0,n.jsx)("strong",{children:"Core Principle:"})," No body change = no next step. The body is the authority, not the mind, not the schedule, not the therapist, and not the protocol itself."]}),(0,n.jsx)("div",{style:{height:16}}),!P&&!N&&!T&&(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)(z,{current:Math.min(s,6),total:6,label:"Regulation loop progress"})}),P?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"44px 22px"},role:"status",children:[(0,n.jsx)("div",{"aria-hidden":"true",style:{fontSize:48,marginBottom:14},children:"◉"}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:24,fontWeight:700,color:a.green,marginBottom:8},children:"Entry Saved"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,marginBottom:24,margin:"0 0 24px"},children:"Session complete."}),(0,n.jsx)(k,{variant:"secondary",onClick:em,ariaLabel:"Start a new session",children:"New session"})]}):N?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"44px 22px"},role:"alert",children:[(0,n.jsx)("div",{"aria-hidden":"true",style:{fontSize:48,marginBottom:14},children:"↑"}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:24,fontWeight:700,color:a.amber,marginBottom:8},children:"Escalate to DGAEP"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,margin:"0 0 8px"},children:"The regulation loop was attempted twice and the body has not shifted."}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,fontStyle:"italic",margin:"0 0 24px"},children:"This is not failure. The activation level exceeds first-line capacity."}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[(0,n.jsx)(k,{onClick:()=>t("dgaep"),ariaLabel:"Open DGAEP escalation protocol",children:"Open DGAEP Protocol"}),(0,n.jsx)(k,{variant:"secondary",onClick:em,ariaLabel:"Reset and start over",children:"Reset"})]})]}):T?(0,n.jsx)(M,{onSave:function(e){let t=[...Y,{...e,date:f(),timeOfDay:j(),gatePassed:!0,locked:!1}];K(t),eu(g,t),J(!0)},sessionType:i}):(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[I>1&&(0,n.jsx)("div",{role:"alert",style:{background:a.amberSoft,borderRadius:10,padding:"12px 18px",fontSize:14,color:a.amber,fontWeight:600,textAlign:"center"},children:"Second attempt — if no change this time, escalate to DGAEP."}),(0,n.jsx)(D,{number:1,title:"Pause",why:"Stop what you are doing. Sit or stand still for 10 seconds. This interrupts the current autonomic trajectory.",active:1===s,completed:s>1,children:(0,n.jsx)(k,{small:!0,onClick:ex,ariaLabel:"I have paused, go to next step",children:"I have paused →"})}),(0,n.jsxs)(D,{number:2,title:"Breathe",why:"3 slow breaths: in through the nose (4 counts), out through the mouth (6 counts). Extended exhale activates the vagus nerve.",active:2===s,completed:s>2,children:[!c&&(0,n.jsx)(k,{small:!0,onClick:()=>m(!0),ariaLabel:"Start the breathing guide",children:"Start breathing guide"}),(0,n.jsx)(R,{active:c,audioEnabled:b,onComplete:()=>{m(!1),ex()}})]}),(0,n.jsx)(D,{number:3,title:"Orient visually",why:"Find and name 3 colours in the room. This activates the ventral vagal system through visual orientation without emotional content.",active:3===s,completed:s>3,children:(0,n.jsx)(k,{small:!0,onClick:ex,ariaLabel:"I have named 3 colours, go to next step",children:"I have named 3 colours →"})}),(0,n.jsx)(D,{number:4,title:"Body scan",why:"Notice sensations from head to toe. Name what you find: tight, heavy, buzzy, numb, warm, cold. Naming without interpreting prevents the scan from becoming a trigger.",active:4===s,completed:s>4,children:(0,n.jsx)(k,{small:!0,onClick:ex,ariaLabel:"Body scan complete, go to next step",children:"Scan complete →"})}),(0,n.jsx)(D,{number:5,title:"Walk",why:"10 slow steps, counting each one. Or rock gently. Rhythmic bilateral movement activates both hemispheres. This is the most reliably effective single intervention.",active:5===s,completed:s>5,children:(0,n.jsx)(k,{small:!0,onClick:ex,ariaLabel:"10 steps done, go to next step",children:"10 steps done →"})}),(0,n.jsx)(D,{number:6,title:"Second body scan",why:'Notice what changed. Any change counts. The protocol asks "did anything change?" not "do you feel better?" Even "not worse" is valid.',active:6===s,completed:S,children:(0,n.jsx)(k,{small:!0,onClick:ex,ariaLabel:"Go to decision gate",children:"Go to decision gate →"})}),S&&!T&&(0,n.jsx)(G,{onYes:function(){L(!0);let e=[...V,{date:f(),timeOfDay:j(),sessionType:i||"acute",gatePassed:!0,escalated:!1,attempts:I}];U(e),eu(h,e),J(!1)},onNo:function(){if(I<2)E(2),d(1),B(!1);else{O(!0);let e=[...V,{date:f(),timeOfDay:j(),sessionType:i||"acute",gatePassed:!1,escalated:!0,attempts:2}];U(e),eu(h,e)}},attempt:I})]})]})]}),"dgaep"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(w,{icon:"↑",title:"Decision-Gated Autonomic Escalation Protocol",subtitle:"When first-line regulation fails, escalation is not failure. It is the next step."}),(0,n.jsx)(Z,{onComplete:()=>t("loop")})]}),"tracking"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(w,{icon:"\uD83D\uDCC8",title:"Tracking",subtitle:"The pattern matters, not the individual day."}),(0,n.jsx)("div",{style:{marginBottom:20},children:(0,n.jsx)(_,{data:Y})}),(0,n.jsx)(q,{entries:Y})]}),"weekly"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(w,{icon:"\uD83D\uDCC5",title:"Weekly Reset",subtitle:"Review patterns, adjust approach, set one intention."}),eh?(0,n.jsx)(H,{onComplete:function(e){let t=[...et,{...e,date:f()}];ei(t),eu(x,t),eg(!1)},entries:V.filter(e=>new Date(e.date)>Date.now()-6048e5)}):(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"28px 24px",textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:10},children:"Start your weekly reset"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,marginBottom:20,margin:"0 0 20px",lineHeight:1.6},children:"A guided 5-step reflection on the past week's patterns and what to adjust."}),(0,n.jsx)(k,{onClick:()=>eg(!0),ariaLabel:"Begin weekly reset protocol",children:"Begin reset protocol"})]})]}),"analysis"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(w,{icon:"\uD83D\uDD0D",title:"Pattern Analysis",subtitle:"AI-assisted identification of load domains and trends."}),(0,n.jsx)(ee,{entries:Y})]}),"redlines"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(w,{icon:"⚠",title:"Red Lines",subtitle:"System-wide alerts that persist until addressed."}),(0,n.jsx)(F,{redlines:en,onDismiss:ep}),(0,n.jsx)("div",{style:{marginTop:20},children:(0,n.jsx)(Q,{})})]})]}),(0,n.jsxs)("footer",{style:{borderTop:"2px solid ".concat(a.border),padding:"18px 22px",textAlign:"center",background:a.white},children:[(0,n.jsx)("div",{style:{fontSize:13,color:a.textMuted},children:"The Nervous System Operating Manual — Yve Bergeron — Neurodiversity & Autism Studies, University College Cork"}),(0,n.jsx)("div",{style:{fontSize:12,color:a.textLight,marginTop:4,fontStyle:"italic"},children:"The nervous system is the last interface."})]})]})}}},function(e){e.O(0,[953,971,117,744],function(){return e(e.s=34819)}),_N_E=e.O()}]);