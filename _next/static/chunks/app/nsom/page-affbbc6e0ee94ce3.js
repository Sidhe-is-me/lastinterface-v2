(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532],{34819:function(e,t,i){Promise.resolve().then(i.bind(i,34652))},34652:function(e,t,i){"use strict";i.d(t,{default:function(){return eg}});var n=i(57437),o=i(2265),r=i(18430);let a={bg:"#F0F5F5",bgDeep:"#E0EBEB",bgWarm:"#D4E0E0",text:"#1A3333",textMuted:"#2D4F4F",textLight:"#3A5858",accent:"#195252",accentBtn:"#1B5656",accentGlow:"rgba(25, 82, 82, 0.10)",green:"#1A5528",greenBtn:"#1D5E2D",greenSoft:"rgba(26, 85, 40, 0.10)",amber:"#6B4E1A",amberBtn:"#6B4E1A",amberSoft:"rgba(107, 78, 26, 0.10)",red:"#7A2D2D",redSoft:"rgba(122, 45, 45, 0.10)",blue:"#24506B",blueSoft:"rgba(36, 80, 107, 0.10)",white:"#FFFFFF",border:"#B0C8C8",borderLight:"#C8D8D8",accentDeco:"#2A7A7A",greenDeco:"#3D7A52",redDeco:"#9E4444"},l=["Cognitive","Emotional","Sensory","Social","Executive"],s=["Tight","Heavy","Buzzy","Numb","Warm","Cold","Racing","Foggy","Shallow breathing","Chest pressure","Throat constriction","Jaw clenched"],d=["Work","Home","Parenting","Social event","Meeting","Commute","Morning","Evening","After conflict","Sensory overload","Sleep-deprived","Transition"],c=[{id:"morning",label:"Morning Baseline",icon:"☀",desc:"Set the day's starting state. Brief journaling."},{id:"acute",label:"Regulation Loop",icon:"⚡",desc:"Something happened. Full protocol."},{id:"work",label:"Work Cycle Reset",icon:"⏱",desc:"90-minute cycle break. Condensed loop."},{id:"discharge",label:"End-of-Day Discharge",icon:"☽",desc:"Release work content. Journaling only."},{id:"evening",label:"Evening Wind-Down",icon:"★",desc:"Second daily loop. Day summary."}],g="nsom-v4-entries",h="nsom-v4-checkins",u="nsom-v4-resets",x="nsom-v4-redlines",p="nsom-v4-work",m="nsom-v4-transitions",f="nsom-v4-defects",y=["Missed regulation break","Insufficient recovery buffer","Sensory overload","Social masking cost","Sleep deficit","Nutrition skip","Transition failure","Underestimated task load","Unexpected demand","Custom"],b=["Work task","Meeting","Break","Email","Commute","Childcare","Meal","Exercise","Social","Rest","Other"],v={outline:"3px solid #195252",outlineOffset:"2px",borderRadius:4},j={position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",borderWidth:0};function S(){return new Date().toISOString().split("T")[0]}function k(e){return new Date(e+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function w(e){let t=new Date(e+"T12:00:00");return Math.floor(Math.abs(new Date-t)/864e5)}function C(){return new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}function z(){let e=new Date().getHours();return e<12?"Morning":e<17?"Afternoon":"Evening"}async function B(e,t){try{let i=await fetch("/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({systemPrompt:e,userMessage:t})});if(!i.ok){let e=await i.json();throw Error(e.error||"API request failed")}return(await i.json()).text||"No response received."}catch(e){return console.error("Claude API error:",e),"Unable to connect to analysis. Please try again."}}function D(e){let{children:t,onClick:i,variant:o="primary",disabled:r,small:l,style:s,ariaLabel:d,type:c="button"}=e,g={padding:l?"10px 18px":"14px 28px",minHeight:44,minWidth:44,borderRadius:8,fontSize:l?14:15,fontWeight:600,cursor:r?"default":"pointer",fontFamily:"inherit",border:"none",transition:"background 0.2s, outline-color 0.2s",lineHeight:1.3,letterSpacing:"0.01em",...s},h={primary:{background:r?a.bgWarm:a.accentBtn,color:r?a.textLight:a.white},secondary:{background:"transparent",color:a.textMuted,border:"2px solid ".concat(a.border)},green:{background:a.greenBtn,color:a.white},amber:{background:a.amberBtn,color:a.white},ghost:{background:"transparent",color:a.textMuted,padding:l?"10px 14px":"12px 20px"},danger:{background:a.red,color:a.white}};return(0,n.jsx)("button",{type:c,onClick:i,disabled:r,"aria-label":d,"aria-disabled":r,style:{...g,...h[o]},onFocus:e=>Object.assign(e.target.style,v),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset=""},children:t})}function W(e){let{icon:t,title:i,subtitle:o,id:r}=e;return(0,n.jsxs)("div",{style:{marginBottom:16},role:"heading","aria-level":"2",children:[(0,n.jsxs)("h2",{id:r,style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:26,fontWeight:700,color:a.text,lineHeight:1.2,margin:0},children:[t&&(0,n.jsx)("span",{"aria-hidden":"true",style:{marginRight:10},children:t}),i]}),o&&(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,marginTop:6,margin:0,lineHeight:1.5},children:o})]})}function R(e){let{children:t,type:i="info",role:o="note"}=e,r={info:{bg:a.amberSoft,border:a.amber,color:a.text},success:{bg:a.greenSoft,border:a.green,color:a.text},warning:{bg:a.redSoft,border:a.red,color:a.text},neutral:{bg:a.bgDeep,border:a.accent,color:a.text}}[i];return(0,n.jsx)("div",{role:o,style:{background:r.bg,borderLeft:"4px solid ".concat(r.border),borderRadius:10,padding:"16px 20px",color:r.color,fontSize:15,lineHeight:1.7},children:t})}function G(e){let{label:t,selected:i,onClick:o,ariaLabel:r}=e;return(0,n.jsx)("button",{role:"checkbox","aria-checked":i,"aria-label":r||t,onClick:o,style:{padding:"10px 16px",minHeight:44,borderRadius:22,border:"2px solid ".concat(i?a.accent:a.borderLight),background:i?a.accentGlow:"transparent",color:i?a.accent:a.textMuted,fontSize:14,cursor:"pointer",fontFamily:"inherit",fontWeight:i?700:500,transition:"all 0.15s",lineHeight:1.2},onFocus:e=>Object.assign(e.target.style,v),onBlur:e=>{e.target.style.outline="none"},children:t})}function M(e){let{current:t,total:i,label:o}=e,r=Math.round(t/i*100);return(0,n.jsxs)("div",{role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":i,"aria-label":o,children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,color:a.textMuted,marginBottom:6},children:[(0,n.jsx)("span",{children:o}),(0,n.jsxs)("span",{children:["Step ",t," of ",i]})]}),(0,n.jsx)("div",{style:{height:6,background:a.bgWarm,borderRadius:3,overflow:"hidden"},children:(0,n.jsx)("div",{style:{height:"100%",width:"".concat(r,"%"),background:a.accentDeco,borderRadius:3,transition:"width 0.4s ease"}})})]})}function T(e){let{label:t,selected:i,onClick:o,ariaLabel:r}=e;return(0,n.jsx)("button",{onClick:o,"aria-pressed":i,"aria-label":r||t,style:{padding:"12px 18px",minHeight:44,borderRadius:10,border:"2px solid ".concat(i?a.accent:a.borderLight),background:i?a.accentGlow:a.white,color:i?a.accent:a.textMuted,fontSize:14,fontWeight:i?700:500,cursor:"pointer",fontFamily:"inherit",textAlign:"left",lineHeight:1.3},onFocus:e=>Object.assign(e.target.style,v),onBlur:e=>{e.target.style.outline="none"},children:t})}function L(e){var t,i,l;let{active:s,onComplete:d,audioEnabled:c}=e,[g,h]=(0,o.useState)("ready"),[u,x]=(0,o.useState)(0),[p,m]=(0,o.useState)(0),f=(0,o.useRef)(null),y=(0,o.useRef)(null);if((0,o.useEffect)(()=>{if(!s){h("ready"),x(0),m(0);return}"ready"===g&&(h("inhale"),x(4),m(1))},[s]),(0,o.useEffect)(()=>{if(c&&"ready"!==g&&"done"!==g)try{y.current||(y.current=new r.WV({oscillator:{type:"sine"},envelope:{attack:.3,decay:.5,sustain:.3,release:1},volume:-20}).toDestination()),"inhale"===g&&y.current.triggerAttackRelease("C4","0.6"),"exhale"===g&&y.current.triggerAttackRelease("G3","0.8")}catch(e){}},[g,c]),(0,o.useEffect)(()=>{if(s&&"ready"!==g&&"done"!==g)return f.current=setInterval(()=>{x(e=>{if(e<=1){if("inhale"===g)return h("exhale"),6;if("exhale"===g)return p>=3?(h("done"),clearInterval(f.current),setTimeout(()=>null==d?void 0:d(),800),0):(m(e=>e+1),h("inhale"),4)}return e-1})},1e3),()=>clearInterval(f.current)},[g,s,p,d]),(0,o.useEffect)(()=>()=>{y.current&&(y.current.dispose(),y.current=null)},[]),!s||"ready"===g)return null;let b="inhale"===g?120:"exhale"===g?60:90,v=null===(i=(l=window).matchMedia)||void 0===i?void 0:null===(t=i.call(l,"(prefers-reduced-motion: reduce)"))||void 0===t?void 0:t.matches;return(0,n.jsxs)("div",{role:"timer","aria-live":"assertive","aria-label":"Breathing guide. ".concat("done"===g?"Complete":"".concat(g,", ").concat(u," seconds. Breath ").concat(Math.min(p,3)," of 3")),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:14,padding:"24px 0"},children:[(0,n.jsx)("div",{style:{width:b,height:b,borderRadius:"50%",background:"radial-gradient(circle, ".concat(a.accentGlow," 0%, rgba(25,82,82,0.25) 100%)"),border:"3px solid ".concat(a.accentDeco),transition:v?"none":"all 1s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)("span",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:28,color:a.accent,fontWeight:700},children:"done"===g?"✓":u})}),(0,n.jsx)("span",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,color:a.textMuted,fontStyle:"italic"},children:"inhale"===g?"Breathe in through the nose…":"exhale"===g?"Breathe out through the mouth…":"Complete"}),(0,n.jsxs)("span",{style:{fontSize:14,color:a.textLight},children:["Breath ",Math.min(p,3)," of 3"]})]})}function F(e){let{number:t,title:i,why:o,children:r,active:l,completed:s}=e;return(0,n.jsx)("div",{role:"region","aria-label":"Step ".concat(t,": ").concat(i),style:{background:s?a.greenSoft:l?a.white:a.bgDeep,border:"2px solid ".concat(l?a.accent:s?a.green:a.borderLight),borderRadius:14,padding:"20px 24px",transition:"all 0.25s ease",opacity:l||s?1:.5,boxShadow:l?"0 2px 20px ".concat(a.accentGlow):"none"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:16},children:[(0,n.jsx)("div",{"aria-hidden":"true",style:{width:34,height:34,borderRadius:"50%",background:s?a.greenBtn:l?a.accentBtn:a.bgWarm,color:s||l?a.white:a.textMuted,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,flexShrink:0,marginTop:2},children:s?"✓":t}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:4},children:i}),l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.7,marginBottom:r?14:0,margin:0,marginTop:4},children:o}),(0,n.jsx)("div",{style:{marginTop:12},children:r})]})]})]})})}function A(e){let{onYes:t,onNo:i,attempt:o}=e;return(0,n.jsxs)("div",{role:"alertdialog","aria-label":"Decision Gate",style:{background:"linear-gradient(135deg, ".concat(a.amberSoft,", ").concat(a.accentGlow,")"),border:"3px solid ".concat(a.amber),borderRadius:16,padding:"28px 24px",textAlign:"center"},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.amber,marginBottom:10},children:["Decision Gate",o>1?" — Attempt ".concat(o):""]}),(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:a.text,marginBottom:8,margin:0},children:"Did the body show any change?"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,marginBottom:22,lineHeight:1.6,margin:"8px 0 22px"},children:'Any change counts: breathing slightly slower, shoulders slightly lower, thoughts slightly less loud. Even "not worse" is a valid change.'}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[(0,n.jsx)(D,{variant:"green",onClick:t,ariaLabel:"Yes, something shifted",children:"Yes — something shifted"}),(0,n.jsx)(D,{variant:"secondary",onClick:i,ariaLabel:"No change detected",children:"No change"})]})]})}function I(e){let{onSelect:t}=e;return(0,n.jsxs)("div",{role:"region","aria-label":"Choose session type",style:{display:"flex",flexDirection:"column",gap:10},children:[(0,n.jsx)(W,{title:"What does the body need?",subtitle:"Choose the session type that matches right now."}),c.map(e=>(0,n.jsxs)("button",{onClick:()=>t(e.id),"aria-label":"".concat(e.label,": ").concat(e.desc),style:{display:"flex",alignItems:"center",gap:16,padding:"18px 22px",minHeight:68,borderRadius:12,border:"2px solid ".concat(a.borderLight),background:a.white,cursor:"pointer",textAlign:"left",fontFamily:"inherit",transition:"border-color 0.15s, box-shadow 0.15s"},onMouseOver:e=>{e.currentTarget.style.borderColor=a.accent,e.currentTarget.style.boxShadow="0 2px 12px ".concat(a.accentGlow)},onMouseOut:e=>{e.currentTarget.style.borderColor=a.borderLight,e.currentTarget.style.boxShadow="none"},onFocus:e=>Object.assign(e.currentTarget.style,v),onBlur:e=>{e.currentTarget.style.outline="none"},children:[(0,n.jsx)("span",{"aria-hidden":"true",style:{fontSize:26,width:44,textAlign:"center"},children:e.icon}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:17,fontWeight:700,color:a.text,fontFamily:"'Cormorant Garamond', Georgia, serif"},children:e.label}),(0,n.jsx)("div",{style:{fontSize:14,color:a.textMuted,lineHeight:1.4,marginTop:2},children:e.desc})]})]},e.id))]})}function H(e){let{onTranscript:t}=e,[i,r]=(0,o.useState)(!1),[l,s]=(0,o.useState)(0),[d,c]=(0,o.useState)(!1),[g,h]=(0,o.useState)(""),[u,x]=(0,o.useState)(null),[p,m]=(0,o.useState)(null),f=(0,o.useRef)(null),y=(0,o.useRef)([]),b=(0,o.useRef)(null);async function j(){m(null);try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e,{mimeType:"audio/webm"});f.current=t,y.current=[],t.ondataavailable=e=>{e.data.size>0&&y.current.push(e.data)},t.onstop=()=>{let t=new Blob(y.current,{type:"audio/webm"});x(URL.createObjectURL(t)),e.getTracks().forEach(e=>e.stop()),S(t)},t.start(250),r(!0),s(0),b.current=setInterval(()=>s(e=>e+1),1e3)}catch(e){m("Could not access microphone. Use typed journaling instead.")}}async function S(e){c(!0);try{var i;let e=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:500,system:"The user recorded an audio journal entry in a nervous system regulation app for "+l+" seconds. Generate a realistic transcript of what a neurodivergent person might say after completing a regulation loop. 2-3 sentences of body-state description only.",messages:[{role:"user",content:"Generate a realistic journal entry transcript."}]})}),n=await e.json(),o=(null===(i=n.content)||void 0===i?void 0:i.map(e=>e.text||"").join(""))||"";h(o),null==t||t(o)}catch(e){m("Transcription unavailable. Add typed notes instead.")}c(!1)}return(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(i?a.redDeco:a.borderLight),borderRadius:12,padding:"18px 20px"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[(0,n.jsx)("span",{style:{fontSize:14,fontWeight:600,color:a.textMuted},children:i?"Recording…":g?"Transcript":"Audio Journal"}),i&&(0,n.jsxs)("span",{"aria-live":"polite",style:{fontSize:14,color:a.red,fontWeight:600},children:[Math.floor(l/60),":",(l%60).toString().padStart(2,"0")]})]}),!g&&!d&&(0,n.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i?(0,n.jsx)(D,{onClick:function(){f.current&&i&&(f.current.stop(),r(!1),clearInterval(b.current))},variant:"danger",ariaLabel:"Stop recording",style:{borderRadius:28,minWidth:56,minHeight:56,fontSize:20},children:"■"}):(0,n.jsx)(D,{onClick:j,ariaLabel:"Start recording",style:{background:a.red,color:a.white,borderRadius:28,minWidth:56,minHeight:56,fontSize:22},children:"●"}),(0,n.jsx)("span",{style:{fontSize:14,color:a.textLight},children:i?"Tap to stop when done.":"Tap to speak your journal entry."})]}),d&&(0,n.jsx)("div",{role:"status","aria-live":"polite",style:{padding:"16px 0",textAlign:"center",fontSize:15,color:a.textMuted},children:"Transcribing…"}),g&&(0,n.jsxs)("div",{style:{marginTop:8},children:[(0,n.jsx)("textarea",{value:g,onChange:e=>{h(e.target.value),null==t||t(e.target.value)},"aria-label":"Audio transcript — review and edit",style:{width:"100%",minHeight:80,padding:14,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text,background:a.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box"},onFocus:function(e){Object.assign(e.target.style,v)},onBlur:function(e){e.target.style.outline="none",e.target.style.outlineOffset=""}}),(0,n.jsx)("div",{style:{fontSize:13,color:a.textLight,marginTop:6},children:"Review and edit if needed."})]}),u&&!i&&(0,n.jsx)("audio",{controls:!0,src:u,style:{width:"100%",marginTop:8,height:44},"aria-label":"Playback"}),p&&(0,n.jsx)("div",{role:"alert",style:{marginTop:10,fontSize:14,color:a.red,lineHeight:1.5},children:p})]})}function N(e){let{entry:t,setEntry:i,sensations:r,setSensations:c,loadDomain:g,setLoadDomain:h,hrv:u,setHrv:x,hr:p,setHr:m,onSave:f,notes:y,setNotes:b,sessionType:j,onEscalate:S,burnout:k,setBurnout:w}=e,[C,z]=(0,o.useState)("type"),[B,W]=(0,o.useState)(!1),[M,T]=(0,o.useState)(!1),L=e=>c(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]),F=e=>{let t=y?y.split(", ").filter(Boolean):[];b((t.includes(e)?t.filter(t=>t!==e):[...t,e]).join(", "))};(0,o.useEffect)(()=>{if(M)return;let e=setTimeout(()=>{W(!0),setTimeout(()=>W(!1),15e3)},9e4);return()=>clearTimeout(e)},[M]);let A="discharge"===j;function I(e){Object.assign(e.target.style,v)}function N(e){e.target.style.outline="none",e.target.style.outlineOffset=""}return(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:18},role:"region","aria-label":"Journaling",children:[(0,n.jsx)("div",{style:{background:a.greenSoft,borderRadius:10,padding:"12px 18px",textAlign:"center"},children:(0,n.jsx)("span",{style:{fontSize:14,fontWeight:700,color:a.green,textTransform:"uppercase",letterSpacing:1.5},children:A?"End-of-Day Discharge":"Gate Passed — Journaling Unlocked"})}),(0,n.jsxs)(R,{type:"neutral",children:[(0,n.jsx)("strong",{children:"Rules:"})," Storage, not understanding. No decisions. No reviewing after. If body worsens, stop."]}),"morning"===j&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Burnout Score (0–10)"}),(0,n.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:Array.from({length:11},(e,t)=>(0,n.jsx)("button",{onClick:()=>w(t),"aria-pressed":k===t,style:{width:44,height:44,borderRadius:8,border:"2px solid ".concat(k===t?a.accent:a.borderLight),background:k===t?a.accentGlow:"transparent",color:k===t?a.accent:a.textMuted,fontSize:16,fontWeight:k===t?700:500,cursor:"pointer",fontFamily:"inherit"},onFocus:I,onBlur:N,children:t},t))}),(0,n.jsx)("div",{style:{fontSize:13,color:a.textLight,marginTop:6},children:"0 = resourced, 10 = depleted"})]}),(0,n.jsxs)("fieldset",{style:{border:"none",padding:0,margin:0},children:[(0,n.jsx)("legend",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:10},children:"Body sensations"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:s.map(e=>(0,n.jsx)(G,{label:e,selected:r.includes(e),onClick:()=>L(e)},e))})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"ld",style:{display:"block",fontSize:14,color:a.textMuted,marginBottom:6,fontWeight:600},children:"Load Domain"}),(0,n.jsxs)("select",{id:"ld",value:g,onChange:e=>h(e.target.value),style:{width:"100%",padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg},onFocus:I,onBlur:N,children:[(0,n.jsx)("option",{value:"",children:"Select…"}),l.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"hv",style:{display:"block",fontSize:14,color:a.textMuted,marginBottom:6,fontWeight:600},children:"HRV (ms)"}),(0,n.jsx)("input",{id:"hv",type:"number",value:u,onChange:e=>x(e.target.value),placeholder:"38",style:{width:"100%",padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box"},onFocus:I,onBlur:N})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"hrt",style:{display:"block",fontSize:14,color:a.textMuted,marginBottom:6,fontWeight:600},children:"HR (bpm)"}),(0,n.jsx)("input",{id:"hrt",type:"number",value:p,onChange:e=>m(e.target.value),placeholder:"68",style:{width:"100%",padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box"},onFocus:I,onBlur:N})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{display:"flex",gap:4,marginBottom:12,background:a.bgDeep,borderRadius:8,padding:4},role:"tablist",children:[{id:"type",label:"Type"},{id:"audio",label:"Speak"}].map(e=>(0,n.jsx)("button",{role:"tab","aria-selected":C===e.id,onClick:()=>z(e.id),style:{flex:1,padding:"12px 16px",minHeight:44,border:"none",borderRadius:6,background:C===e.id?a.white:"transparent",color:C===e.id?a.accent:a.textMuted,fontSize:15,fontWeight:C===e.id?700:500,cursor:"pointer",fontFamily:"inherit"},onFocus:I,onBlur:N,children:e.label},e.id))}),"type"===C?(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"jt",style:{display:"block",fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:A?"What is unfinished, pending, held":"Describe — no analysis"}),(0,n.jsx)("textarea",{id:"jt",value:t,onChange:e=>i(e.target.value),placeholder:A?"What work tasks are unfinished?":'"Chest tight. Shoulders high." Description only.',style:{width:"100%",minHeight:110,padding:16,border:"2px solid ".concat(a.borderLight),borderRadius:10,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text,background:a.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box"},onFocus:I,onBlur:N})]}):(0,n.jsx)(H,{onTranscript:e=>i(e)})]}),!A&&(0,n.jsxs)("fieldset",{style:{border:"none",padding:0,margin:0},children:[(0,n.jsx)("legend",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:10},children:"Context"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:d.map(e=>(0,n.jsx)(G,{label:e,selected:(y||"").split(", ").includes(e),onClick:()=>F(e)},e))})]}),B&&(0,n.jsxs)("div",{role:"alert","aria-live":"polite",style:{background:a.amberSoft,border:"2px solid ".concat(a.amber),borderRadius:10,padding:"14px 18px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:10},children:[(0,n.jsx)("span",{style:{fontSize:14,color:a.text,fontWeight:500},children:"Quick check — body still OK?"}),(0,n.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,n.jsx)(D,{small:!0,variant:"green",onClick:()=>{W(!1),T(!0)},children:"Still OK"}),(0,n.jsx)(D,{small:!0,variant:"amber",onClick:()=>{W(!1),null==S||S()},children:"Escalating"})]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:8},children:[(0,n.jsx)("span",{style:{fontSize:14,color:a.textLight},children:"Store. Save and close. Do not re-read."}),(0,n.jsx)(D,{onClick:f,children:"Store & Close"})]})]})}function E(e){var t,i,r;let{checkins:l,onSave:s}=e,d=l.find(e=>e.date===S()),[c,g]=(0,o.useState)(null!==(t=null==d?void 0:d.sleep)&&void 0!==t?t:""),[h,u]=(0,o.useState)(null!==(i=null==d?void 0:d.ate)&&void 0!==i?i:null),[x,p]=(0,o.useState)(null!==(r=null==d?void 0:d.social)&&void 0!==r?r:null),[m,f]=(0,o.useState)(!!d);return m?(0,n.jsxs)("div",{style:{background:a.greenSoft,borderRadius:12,padding:"14px 20px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)("span",{style:{fontSize:14,color:a.green,fontWeight:600},children:"✓ Check-in complete"}),(0,n.jsx)(D,{small:!0,variant:"ghost",onClick:()=>f(!1),children:"Edit"})]}):(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:14,padding:"20px 22px"},children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:"0 0 14px"},children:"Daily Check-In"}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"slp",style:{display:"block",fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Hours of sleep"}),(0,n.jsx)("input",{id:"slp",type:"number",step:"0.5",value:c,onChange:e=>g(e.target.value),placeholder:"6.5",style:{width:120,padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box"},onFocus:function(e){Object.assign(e.target.style,v)},onBlur:function(e){e.target.style.outline="none",e.target.style.outlineOffset=""}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Did you eat today?"}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:[!0,!1].map(e=>(0,n.jsx)(T,{label:e?"Yes":"No",selected:h===e,onClick:()=>u(e)},String(e)))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Social contact today?"}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:[!0,!1].map(e=>(0,n.jsx)(T,{label:e?"Yes":"No",selected:x===e,onClick:()=>p(e)},String(e)))})]}),(0,n.jsx)(D,{small:!0,onClick:()=>{s({date:S(),sleep:c?Number(c):null,ate:h,social:x}),f(!0)},children:"Save"})]})]})}function O(e){let{redlines:t,onDismiss:i}=e;if(!t||0===t.length)return null;let o=t.filter(e=>!e.dismissed);return 0===o.length?null:(0,n.jsxs)("div",{role:"alert",style:{background:"linear-gradient(135deg, ".concat(a.redSoft,", ").concat(a.amberSoft,")"),border:"3px solid ".concat(a.red),borderRadius:14,padding:"20px 22px",marginBottom:20},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.red,marginBottom:8},children:"⚠ Red Line Alert"}),o.map((e,t)=>(0,n.jsxs)("div",{style:{background:a.white,borderRadius:8,padding:"14px 16px",marginBottom:t<o.length-1?12:0},children:[(0,n.jsx)("div",{style:{fontSize:15,fontWeight:600,color:a.text,marginBottom:4},children:e.type}),(0,n.jsx)("div",{style:{fontSize:14,color:a.textMuted,marginBottom:10,lineHeight:1.5},children:e.description}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:13,color:a.textLight},children:[(0,n.jsxs)("span",{children:["Active for ",w(e.date)," day",1!==w(e.date)?"s":""]}),(0,n.jsx)(D,{small:!0,variant:"ghost",onClick:()=>null==i?void 0:i(e.id),ariaLabel:"Dismiss ".concat(e.type," alert"),children:"Dismiss"})]})]},t)),(0,n.jsx)("p",{style:{fontSize:13,color:a.text,marginTop:14,lineHeight:1.6,fontStyle:"italic",margin:"14px 0 0"},children:"Red lines persist across days until explicitly dismissed. They are not forgotten by the system."})]})}let P=[{title:"Review the week",prompt:"Look back at your entries from the past 7 days. What patterns do you notice?"},{title:"Identify load domains",prompt:"Which areas created the most activation? (Work, social, sensory, etc.)"},{title:"Note what worked",prompt:"Which regulation strategies were most effective this week?"},{title:"Note what didn't",prompt:"Which approaches failed to produce body change? No judgment, just data."},{title:"Set one intention",prompt:"Choose ONE small adjustment for next week. Not a goal. An experiment."}];function J(e){let{onComplete:t,entries:i}=e,[r,l]=(0,o.useState)(0),[s,d]=(0,o.useState)([,,,,,].fill("")),c=P[r];return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 22px",marginBottom:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.accent,marginBottom:8},children:"Weekly Reset Protocol"}),(0,n.jsx)(M,{current:r+1,total:P.length,label:"Reset progress"})]}),(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.accent),borderRadius:12,padding:"24px 26px"},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:a.text,marginBottom:10},children:["Step ",r+1,": ",c.title]}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,lineHeight:1.7,marginBottom:16,margin:"0 0 16px"},children:c.prompt}),0===r&&i&&i.length>0&&(0,n.jsxs)("div",{style:{background:a.bgDeep,borderRadius:8,padding:14,marginBottom:16,fontSize:13,color:a.textMuted},children:["You completed ",i.length," session",1!==i.length?"s":""," this week."]}),(0,n.jsx)("textarea",{value:s[r],onChange:e=>(function(e){let t=[...s];t[r]=e,d(t)})(e.target.value),placeholder:"Write your reflection here...","aria-label":c.title,style:{width:"100%",minHeight:120,padding:14,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text,background:a.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box",marginBottom:16},onFocus:function(e){Object.assign(e.target.style,v)},onBlur:function(e){e.target.style.outline="none",e.target.style.outlineOffset=""}}),(0,n.jsxs)("div",{style:{display:"flex",gap:10,justifyContent:"space-between"},children:[r>0&&(0,n.jsx)(D,{variant:"secondary",onClick:function(){r>0&&l(r-1)},ariaLabel:"Go back to previous step",children:"← Back"}),(0,n.jsx)(D,{onClick:function(){r<P.length-1?l(r+1):null==t||t({responses:s,timestamp:new Date().toISOString(),entriesReviewed:(null==i?void 0:i.length)||0})},ariaLabel:r<P.length-1?"Continue to next step":"Complete weekly reset",disabled:0===s[r].trim().length,style:{marginLeft:0===r?"auto":void 0},children:r<P.length-1?"Next →":"Complete reset"})]})]})]})}var _=i(47625),U=i(58336),V=i(56940),Y=i(97059),q=i(62994),K=i(8147),Q=i(22190),X=i(54061);function Z(e){let{data:t}=e;if(!t||0===t.length)return(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"40px 22px",textAlign:"center",color:a.textMuted},children:[(0,n.jsx)("div",{style:{fontSize:15},children:"No data to display yet."}),(0,n.jsx)("div",{style:{fontSize:13,marginTop:6},children:"Complete sessions with HRV and burnout tracking to see trends."})]});let i=t.map(e=>({date:k(e.date),hrv:e.hrv||null,burnout:e.burnoutRating||null}));return(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 18px",border:"2px solid ".concat(a.borderLight)},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:16},children:"HRV & Burnout Trends"}),(0,n.jsx)(_.h,{width:"100%",height:300,children:(0,n.jsxs)(U.w,{data:i,margin:{top:5,right:20,left:0,bottom:5},children:[(0,n.jsx)(V.q,{strokeDasharray:"3 3",stroke:a.borderLight}),(0,n.jsx)(Y.K,{dataKey:"date",tick:{fill:a.textMuted,fontSize:12},stroke:a.border}),(0,n.jsx)(q.B,{yAxisId:"left",label:{value:"HRV",angle:-90,position:"insideLeft",style:{fill:a.textMuted,fontSize:12}},tick:{fill:a.textMuted,fontSize:12},stroke:a.border}),(0,n.jsx)(q.B,{yAxisId:"right",orientation:"right",label:{value:"Burnout",angle:90,position:"insideRight",style:{fill:a.textMuted,fontSize:12}},tick:{fill:a.textMuted,fontSize:12},stroke:a.border,domain:[0,10]}),(0,n.jsx)(K.u,{contentStyle:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:13}}),(0,n.jsx)(Q.D,{wrapperStyle:{fontSize:13,color:a.textMuted}}),(0,n.jsx)(X.x,{yAxisId:"left",type:"monotone",dataKey:"hrv",stroke:a.green,strokeWidth:2,dot:{fill:a.greenBtn,r:4},name:"HRV",connectNulls:!0}),(0,n.jsx)(X.x,{yAxisId:"right",type:"monotone",dataKey:"burnout",stroke:a.amber,strokeWidth:2,dot:{fill:a.amber,r:4},name:"Burnout Index",connectNulls:!0})]})}),(0,n.jsx)("p",{style:{fontSize:13,color:a.textMuted,marginTop:14,lineHeight:1.5,fontStyle:"italic"},children:"Higher HRV (green) indicates better nervous system capacity. Higher burnout (amber) indicates reduced capacity."})]})}function $(e){let{entries:t}=e,[i,r]=(0,o.useState)(null);return t&&0!==t.length?i?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)(D,{variant:"ghost",onClick:()=>r(null),ariaLabel:"Back to history list",children:"← Back to list"})}),(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text},children:k(i.date)}),(0,n.jsxs)("div",{style:{fontSize:14,color:a.textMuted,marginTop:2},children:[i.timeOfDay," \xb7 ",i.sessionType||"regulation"]})]}),i.locked&&(0,n.jsx)("div",{style:{fontSize:20,color:a.textLight},"aria-label":"This entry is locked",children:"\uD83D\uDD12"})]}),void 0!==i.gatePassed&&(0,n.jsx)("div",{style:{display:"inline-block",padding:"6px 12px",borderRadius:6,background:i.gatePassed?a.greenSoft:a.amberSoft,color:i.gatePassed?a.green:a.amber,fontSize:13,fontWeight:600,marginBottom:16},children:i.gatePassed?"Gate passed ✓":"Escalated to DGAEP"}),i.transcript&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Transcript"}),(0,n.jsx)("div",{style:{fontSize:15,color:a.text,lineHeight:1.7,fontFamily:"'Source Serif 4', Georgia, serif"},children:i.transcript})]}),i.bodySensations&&i.bodySensations.length>0&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Body sensations"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:i.bodySensations.map(e=>(0,n.jsx)(G,{label:e,active:!1},e))})]}),i.contexts&&i.contexts.length>0&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Contexts"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:i.contexts.map(e=>(0,n.jsx)(G,{label:e,active:!1},e))})]}),void 0!==i.burnoutRating&&null!==i.burnoutRating&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Burnout index"}),(0,n.jsxs)("div",{style:{fontSize:24,fontWeight:700,color:a.amber},children:[i.burnoutRating,"/10"]})]}),i.notes&&(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Notes"}),(0,n.jsx)("div",{style:{fontSize:15,color:a.text,lineHeight:1.7,fontFamily:"'Source Serif 4', Georgia, serif"},children:i.notes})]}),i.locked&&(0,n.jsx)("div",{style:{marginTop:20,padding:"12px 16px",background:a.bgDeep,borderRadius:8,fontSize:13,color:a.textMuted,fontStyle:"italic"},children:"This entry was locked 24 hours after creation and cannot be edited."})]})]}):(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:t.slice().reverse().map((e,t)=>(0,n.jsxs)("button",{onClick:()=>r(e),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,cursor:"pointer",textAlign:"left",fontFamily:"inherit",transition:"all 0.15s"},onMouseOver:e=>{e.currentTarget.style.borderColor=a.accent,e.currentTarget.style.boxShadow="0 2px 12px ".concat(a.accentGlow)},onMouseOut:e=>{e.currentTarget.style.borderColor=a.borderLight,e.currentTarget.style.boxShadow="none"},children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{fontSize:15,fontWeight:600,color:a.text,marginBottom:4},children:k(e.date)}),(0,n.jsxs)("div",{style:{fontSize:13,color:a.textMuted},children:[e.timeOfDay," \xb7 ",e.sessionType||"regulation"]})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.locked&&(0,n.jsx)("span",{style:{fontSize:16,color:a.textLight},children:"\uD83D\uDD12"}),(0,n.jsx)("span",{style:{fontSize:13,fontWeight:600,color:e.gatePassed?a.green:a.amber},children:void 0!==e.gatePassed?e.gatePassed?"Gate ✓":"DGAEP":"—"})]})]},t))}):(0,n.jsxs)("div",{style:{textAlign:"center",padding:"44px 22px",color:a.textLight},children:[(0,n.jsx)("div",{"aria-hidden":"true",style:{fontSize:30,marginBottom:10},children:"◉"}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,color:a.textMuted},children:"No entries yet"}),(0,n.jsx)("div",{style:{fontSize:14,marginTop:6},children:"Complete your first session to begin tracking."})]})}function ee(e){let{duration:t,label:i,onComplete:r}=e,[l,s]=(0,o.useState)(t),[d,c]=(0,o.useState)(!1),g=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(!d){clearInterval(g.current);return}return g.current=setInterval(()=>{s(e=>e<=1?(clearInterval(g.current),c(!1),null==r||r(),0):e-1)},1e3),()=>clearInterval(g.current)},[d,r]);let h=Math.floor(l/60),u=l%60,x=(t-l)/t*100;return(0,n.jsxs)("div",{role:"timer","aria-label":"".concat(i,": ").concat(h," minutes ").concat(u," seconds remaining"),style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:10,padding:"16px 20px"},children:[(0,n.jsx)("div",{style:{fontSize:14,color:a.textLight,marginBottom:8},children:i}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:36,fontWeight:700,color:0===l?a.green:a.text,minWidth:95,fontVariantNumeric:"tabular-nums"},children:[h,":",u.toString().padStart(2,"0")]}),(0,n.jsx)("div",{style:{flex:1},children:(0,n.jsx)("div",{style:{height:8,background:a.bgDeep,borderRadius:4,overflow:"hidden"},children:(0,n.jsx)("div",{style:{height:"100%",width:"".concat(x,"%"),background:0===l?a.greenDeco:a.accentDeco,borderRadius:4,transition:"width 1s linear"}})})}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:0===l?(0,n.jsx)(D,{small:!0,variant:"green",onClick:()=>{s(t)},ariaLabel:"Timer complete, reset",children:"Complete"}):d?(0,n.jsx)(D,{small:!0,variant:"secondary",onClick:()=>c(!1),ariaLabel:"Pause timer",children:"Pause"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D,{small:!0,onClick:()=>c(!0),ariaLabel:l<t?"Resume timer":"Start timer",children:l<t?"Resume":"Start"}),l<t&&(0,n.jsx)(D,{small:!0,variant:"ghost",onClick:()=>{c(!1),s(t)},ariaLabel:"Reset timer",children:"Reset"})]})})]})]})}let et=[{level:1,title:"Lie down with legs elevated",why:"Blood flow to torso activates vagal brake. 10 minutes minimum.",duration:600},{level:2,title:"Cold water on face",why:"Mammalian dive reflex. Activates parasympathetic immediately. 30 seconds minimum.",duration:30},{level:3,title:"Weighted blanket or compression",why:"Deep pressure proprioception. Tells the body it is held. 15 minutes.",duration:900},{level:4,title:"Vocalisation or humming",why:"Vocal vibration stimulates vagus directly. Hum one song or speak aloud for 5 minutes.",duration:300},{level:5,title:"Call your protocol contact",why:"Social co-regulation is the most powerful intervention. Not texting. Voice.",duration:600},{level:6,title:"Crisis escalation",why:"The protocol has been exhausted. Medical or crisis support is indicated.",duration:0}];function ei(e){let{onComplete:t}=e,[i,r]=(0,o.useState)(0),[l,s]=(0,o.useState)(!1),d=et[i];return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 22px",marginBottom:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:a.amber,marginBottom:8},children:"Decision-Gated Autonomic Escalation Protocol"}),(0,n.jsx)(M,{current:i+1,total:et.length,label:"DGAEP progress"})]}),(0,n.jsxs)("div",{style:{background:a.white,border:"3px solid ".concat(a.amber),borderRadius:14,padding:"24px 26px"},children:[(0,n.jsxs)("div",{style:{display:"inline-block",padding:"6px 14px",borderRadius:6,background:a.amberSoft,color:a.amber,fontSize:13,fontWeight:700,marginBottom:12},children:["Level ",d.level]}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:24,fontWeight:700,color:a.text,marginBottom:10},children:d.title}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,lineHeight:1.7,marginBottom:20,margin:"0 0 20px"},children:d.why}),d.duration>0&&!l&&(0,n.jsx)(D,{onClick:function(){s(!0)},ariaLabel:"Start ".concat(d.duration," second timer for level ").concat(d.level),children:"Start timer"}),d.duration>0&&l&&(0,n.jsx)(ee,{duration:d.duration,label:d.title,onComplete:function(){s(!1)}}),6===d.level&&(0,n.jsxs)("div",{role:"alert",style:{background:a.redSoft,border:"2px solid ".concat(a.red),borderRadius:10,padding:"16px 18px",marginBottom:20},children:[(0,n.jsx)("div",{style:{fontSize:15,fontWeight:600,color:a.red,marginBottom:8},children:"Protocol exhausted"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.text,lineHeight:1.6,margin:0},children:"Five escalation levels have been attempted without body change. This indicates activation beyond self-regulation capacity. Contact your crisis support system or emergency services."})]}),(d.duration>0&&!l||6===d.level)&&(0,n.jsx)("div",{style:{marginTop:20},children:(0,n.jsx)(D,{variant:"secondary",onClick:function(){i<et.length-1?(r(i+1),s(!1)):null==t||t({levelsCompleted:i+1})},ariaLabel:d.level<6?"Move to next DGAEP level":"Complete DGAEP protocol",children:d.level<6?"Next level →":"End protocol"})})]}),(0,n.jsxs)("div",{style:{marginTop:16,padding:"14px 18px",background:a.bgDeep,borderRadius:10,fontSize:13,color:a.textMuted,lineHeight:1.6,fontStyle:"italic"},children:[(0,n.jsx)("strong",{children:"Core principle:"})," Complete each level fully before moving to the next. The body is the authority on whether to escalate."]})]})}let en=[{category:"Physical",lines:["Sleep < 4 hours for 2 consecutive nights","No food for > 16 hours (unintentional)","Persistent physical pain that prevents regulation"]},{category:"Cognitive",lines:["Suicidal ideation present","Dissociation lasting > 2 hours","Unable to complete basic self-care tasks"]},{category:"Social",lines:["Zero social contact for 3+ days (when not intentional)","Conflict that persists unresolved for > 48 hours","Isolation that feels involuntary"]},{category:"Capacity",lines:["DGAEP escalation 3+ times in one week","Gate failed 5+ times in 7 days","Regulation loop ineffective for 72 hours"]}];function eo(){return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{background:a.white,borderRadius:12,padding:"20px 22px",marginBottom:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:a.text,marginBottom:8},children:"Red Lines Reference"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,margin:0},children:"Red lines are system-wide alerts that persist across days. When crossed, they indicate capacity has been exceeded and escalation is required."})]}),en.map((e,t)=>(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"18px 20px",marginBottom:12},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,marginBottom:10},children:e.category}),(0,n.jsx)("ul",{style:{margin:0,paddingLeft:20,listStyleType:"disc"},children:e.lines.map((t,i)=>(0,n.jsx)("li",{style:{fontSize:14,color:a.textMuted,lineHeight:1.7,marginBottom:i<e.lines.length-1?8:0},children:t},i))})]},t)),(0,n.jsxs)("div",{style:{marginTop:16,padding:"16px 18px",background:a.redSoft,border:"2px solid ".concat(a.red),borderRadius:10,fontSize:13,color:a.text,lineHeight:1.6},children:[(0,n.jsx)("strong",{style:{color:a.red},children:"Important:"})," Red lines are not judgments. They are system alerts. When a red line is crossed, it means the nervous system needs support beyond what self-regulation can provide."]})]})}function er(e){let{entries:t,onAnalysisComplete:i}=e,[r,s]=(0,o.useState)(!1),[d,c]=(0,o.useState)([]),[g,h]=(0,o.useState)("");async function u(){s(!0);try{let e=t.slice(-7),n="Analyze these journal entries and identify the primary load domains (cognitive, sensory, social, physical, emotional) that are creating nervous system activation. Provide a brief analysis (2-3 sentences) and list the top 2-3 load domains.\n\nEntries:\n".concat(e.map((e,t)=>"".concat(t+1,". ").concat(e.transcript||"No transcript")).join("\n"),"\n\nFormat your response as:\nANALYSIS: [your analysis]\nDOMAINS: [comma-separated list of domains]"),o=await B(n),r=o.match(RegExp("ANALYSIS:\\s*(.+?)(?=DOMAINS:|$)","s")),a=o.match(/DOMAINS:\s*(.+)/);if(r&&h(r[1].trim()),a){let e=a[1].split(",").map(e=>e.trim()).filter(e=>l.includes(e));c(e)}null==i||i({domains:d,analysis:g})}catch(e){h("Analysis unavailable. Please try again later.")}s(!1)}return(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:12,padding:"20px 22px"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:a.text,marginBottom:8},children:"Load Domain Analysis"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,lineHeight:1.6,marginBottom:16,margin:"0 0 16px"},children:"AI analysis of your recent entries to identify primary sources of nervous system load."}),!g&&(0,n.jsx)(D,{onClick:u,disabled:r||!t||0===t.length,ariaLabel:"Analyze load domains",children:r?"Analyzing...":"Analyze patterns"}),g&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{background:a.bgDeep,borderRadius:8,padding:"14px 16px",marginBottom:14,fontSize:14,color:a.text,lineHeight:1.6},children:g}),d.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Identified load domains"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:16},children:d.map(e=>(0,n.jsx)(G,{label:e,active:!0},e))})]}),(0,n.jsx)(D,{variant:"secondary",onClick:()=>{h(""),c([])},ariaLabel:"Run new analysis",children:"Run new analysis"})]}),t&&0===t.length&&(0,n.jsx)("div",{style:{fontSize:13,color:a.textLight,fontStyle:"italic",marginTop:8},children:"Complete at least one journal entry to enable analysis."})]})}function ea(e){var t,i;let{workData:r,onSave:l,onNavigateToLoop:s}=e,[d,c]=(0,o.useState)(!1),[g,h]=(0,o.useState)(0),[u,x]=(0,o.useState)(!1),[p,m]=(0,o.useState)(""),[f,y]=(0,o.useState)(""),[b,v]=(0,o.useState)(!1),[j,k]=(0,o.useState)(0),[z,B]=(0,o.useState)(r.dischargeTime||"17:00"),W=(0,o.useRef)(null),R=(0,o.useRef)(null),G=(null===(t=r.days)||void 0===t?void 0:t.find(e=>e.date===S()))||{date:S(),cycles:0,cyclesWithBreak:0,meetings:[],dischargeCompleted:!1};function M(e){x(!1),L({...G,cycles:G.cycles+1,cyclesWithBreak:G.cyclesWithBreak+(e?1:0)}),e?null==s||s():c(!0)}function L(e){let t=(r.days||[]).filter(e=>e.date!==S());t.push(e),l({...r,days:t,dischargeTime:z})}(0,o.useEffect)(()=>{if(!d){clearInterval(W.current);return}return W.current=setInterval(()=>{h(e=>e>=5400?(x(!0),c(!1),0):e+1)},1e3),()=>clearInterval(W.current)},[d]),(0,o.useEffect)(()=>{if(!b){clearInterval(R.current);return}return R.current=setInterval(()=>{k(e=>e>=600?(v(!1),0):e+1)},1e3),()=>clearInterval(R.current)},[b]);let F=(r.days||[]).filter(e=>7>=w(e.date)),A=F.reduce((e,t)=>e+(t.cycles||0),0),I=F.reduce((e,t)=>e+(t.cyclesWithBreak||0),0),H=F.reduce((e,t)=>{var i;return e+((null===(i=t.meetings)||void 0===i?void 0:i.length)||0)},0),N=F.length>0?Math.round(F.filter(e=>e.dischargeCompleted).length/F.length*100):0,E=Math.floor(g/60);return(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:18},children:[u&&(0,n.jsxs)("div",{role:"alertdialog","aria-label":"90-minute cycle complete",style:{background:"linear-gradient(135deg, ".concat(a.accentGlow,", ").concat(a.amberSoft,")"),border:"3px solid ".concat(a.accent),borderRadius:16,padding:"28px 24px",textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:a.text,marginBottom:8},children:"90-minute cycle complete"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,margin:"0 0 22px",lineHeight:1.6},children:"Cognitive performance operates in 90-minute ultradian cycles. Take a deliberate regulation break. This is not optional — it is nervous system maintenance."}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[(0,n.jsx)(D,{variant:"green",onClick:()=>M(!0),children:"Take regulation break"}),(0,n.jsx)(D,{variant:"secondary",onClick:()=>M(!1),children:"Skip this time"})]})]}),(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(d?a.accent:a.borderLight),borderRadius:14,padding:"20px 22px"},children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:"0 0 12px"},children:"Ultradian Cycle Timer"}),d?(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{role:"timer","aria-label":"Work cycle: ".concat(E," minutes elapsed"),style:{display:"flex",alignItems:"center",gap:16},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:42,fontWeight:700,color:a.accent},children:[E,":",(g%60).toString().padStart(2,"0")]}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("div",{style:{height:8,background:a.bgDeep,borderRadius:4,overflow:"hidden"},children:(0,n.jsx)("div",{style:{height:"100%",width:"".concat(g/5400*100,"%"),background:a.accentDeco,borderRadius:4,transition:"width 1s linear"}})}),(0,n.jsxs)("div",{style:{fontSize:13,color:a.textLight,marginTop:6},children:[90-E," min until regulation break"]})]})]}),(0,n.jsx)("div",{style:{marginTop:12},children:(0,n.jsx)(D,{small:!0,variant:"secondary",onClick:()=>{c(!1),h(0)},children:"End cycle"})})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,margin:"0 0 12px"},children:"Start a 90-minute focused work cycle. The app will prompt a regulation break when the timer completes."}),(0,n.jsx)(D,{onClick:()=>{c(!0),h(0)},children:"Start work cycle"})]})]}),b&&(0,n.jsxs)("div",{role:"alert",style:{background:a.blueSoft,border:"2px solid ".concat(a.blue),borderRadius:14,padding:"18px 22px"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:16,fontWeight:700,color:a.blue,marginBottom:6},children:"Meeting recovery buffer"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,margin:"0 0 8px"},children:"The NSOM says: allow a minimum 10-minute buffer before beginning cognitive work after a 30+ minute meeting."}),(0,n.jsxs)("div",{role:"timer",style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:28,fontWeight:700,color:a.blue},children:[Math.floor((600-j)/60),":",((600-j)%60).toString().padStart(2,"0")," remaining"]}),(0,n.jsx)("div",{style:{marginTop:10},children:(0,n.jsx)(D,{small:!0,variant:"ghost",onClick:()=>null==s?void 0:s(),children:"Use buffer for regulation loop"})})]}),(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:14,padding:"20px 22px"},children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:"0 0 12px"},children:"Log a Meeting"}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"flex-end"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"mtg-dur",style:{display:"block",fontSize:13,color:a.textMuted,marginBottom:4,fontWeight:600},children:"Duration (min)"}),(0,n.jsx)("input",{id:"mtg-dur",type:"number",value:p,onChange:e=>m(e.target.value),placeholder:"30",style:{width:80,padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:13,color:a.textMuted,marginBottom:4,fontWeight:600},children:"Intensity"}),(0,n.jsx)("div",{style:{display:"flex",gap:6},children:["Low","Medium","High"].map(e=>(0,n.jsx)(T,{label:e,selected:f===e.toLowerCase(),onClick:()=>y(e.toLowerCase())},e))})]}),(0,n.jsx)(D,{small:!0,onClick:function(){if(!p)return;let e=Number(p),t={time:C(),duration:e,intensity:f||"medium"};L({...G,meetings:[...G.meetings||[],t]}),m(""),y(""),e>=30&&(v(!0),k(0))},disabled:!p,children:"Log meeting"})]}),(null===(i=G.meetings)||void 0===i?void 0:i.length)>0&&(0,n.jsxs)("div",{style:{marginTop:14},children:[(0,n.jsx)("div",{style:{fontSize:13,color:a.textLight,marginBottom:6},children:"Today's meetings"}),G.meetings.map((e,t)=>(0,n.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center",padding:"6px 0",borderBottom:t<G.meetings.length-1?"1px solid ".concat(a.borderLight):"none"},children:[(0,n.jsx)("span",{style:{fontSize:14,color:a.text},children:e.time}),(0,n.jsxs)("span",{style:{fontSize:14,color:a.textMuted},children:[e.duration," min"]}),(0,n.jsx)("span",{style:{padding:"2px 10px",borderRadius:10,fontSize:12,background:"high"===e.intensity?a.redSoft:"medium"===e.intensity?a.amberSoft:a.greenSoft,color:"high"===e.intensity?a.red:"medium"===e.intensity?a.amber:a.green},children:e.intensity})]},t))]})]}),(0,n.jsx)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:14,padding:"20px 22px"},children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:0},children:"End-of-Day Discharge"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,margin:"4px 0 0"},children:"Work-related cognitive loops do not stop at 5 PM."})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,n.jsx)("label",{htmlFor:"discharge-time",style:{fontSize:13,color:a.textLight},children:"Trigger at:"}),(0,n.jsx)("input",{id:"discharge-time",type:"time",value:z,onChange:e=>{B(e.target.value),l({...r,dischargeTime:e.target.value})},style:{padding:"10px 12px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg}})]})]})}),(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:14,padding:"20px 22px"},children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:"0 0 14px"},children:"Work Stats (7 days)"}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:10},children:[(0,n.jsxs)("div",{style:{background:a.accentGlow,borderRadius:10,padding:14,textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:26,fontWeight:700,color:a.accent},children:A}),(0,n.jsx)("div",{style:{fontSize:12,color:a.textMuted},children:"Cycles"})]}),(0,n.jsxs)("div",{style:{background:A>0?a.greenSoft:a.bgDeep,borderRadius:10,padding:14,textAlign:"center"},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:26,fontWeight:700,color:a.green},children:[A>0?Math.round(I/A*100):0,"%"]}),(0,n.jsx)("div",{style:{fontSize:12,color:a.textMuted},children:"Break compliance"})]}),(0,n.jsxs)("div",{style:{background:a.blueSoft,borderRadius:10,padding:14,textAlign:"center"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:26,fontWeight:700,color:a.blue},children:H}),(0,n.jsx)("div",{style:{fontSize:12,color:a.textMuted},children:"Meetings"})]}),(0,n.jsxs)("div",{style:{background:a.amberSoft,borderRadius:10,padding:14,textAlign:"center"},children:[(0,n.jsxs)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:26,fontWeight:700,color:a.amber},children:[N,"%"]}),(0,n.jsx)("div",{style:{fontSize:12,color:a.textMuted},children:"Discharge rate"})]})]})]})]})}function el(e){let{transitions:t,onComplete:i}=e,[r,l]=(0,o.useState)(0),[s,d]=(0,o.useState)(""),[c,g]=(0,o.useState)(""),[h,u]=(0,o.useState)(!1),[x,p]=(0,o.useState)(!1),[m,f]=(0,o.useState)(!1),y=[{name:"Close",q:"What are you finishing?",options:b},{name:"Orient",q:"What's next?",options:b},{name:"Stabilise",q:"One breath.",options:null},{name:"Begin",q:"Ready to start.",options:null}];return m?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"32px 20px",background:a.greenSoft,borderRadius:14},children:[(0,n.jsxs)("div",{style:{fontSize:15,color:a.green,fontWeight:600},children:["✓ Transition complete: ",s," → ",c]}),(0,n.jsx)("div",{style:{marginTop:12},children:(0,n.jsx)(D,{small:!0,variant:"secondary",onClick:function(){l(0),d(""),g(""),u(!1),p(!1),f(!1)},children:"New transition"})})]}):x?(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.accent),borderRadius:14,padding:"22px 24px"},children:[(0,n.jsx)(M,{current:r+1,total:4,label:"Transition"}),(0,n.jsxs)("div",{style:{marginTop:16},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2,color:a.accent,marginBottom:6},children:y[r].name}),(0,n.jsx)("div",{style:{fontSize:18,fontWeight:700,color:a.text,fontFamily:"'Cormorant Garamond', Georgia, serif",marginBottom:14},children:y[r].q}),(0===r||1===r)&&(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:y[r].options.map(e=>(0,n.jsx)(T,{label:e,selected:0===r?s===e:c===e,onClick:()=>{0===r?(d(e),l(1)):1===r&&(g(e),l(2),u(!0))}},e))}),2===r&&(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:12},children:(0,n.jsx)(es,{active:h,onComplete:function(){u(!1),l(3)}})}),3===r&&(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsxs)("p",{style:{fontSize:15,color:a.textMuted,margin:"0 0 16px"},children:[s," → ",c]}),(0,n.jsx)(D,{variant:"green",onClick:function(){i({date:S(),time:C(),closing:s,orienting:c,timestamp:Date.now()}),f(!0)},children:"Begin"})]})]})]}):(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:14,padding:"20px 22px",textAlign:"center"},children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:"0 0 8px"},children:"Transition"}),(0,n.jsx)("p",{style:{fontSize:14,color:a.textMuted,margin:"0 0 16px",lineHeight:1.6},children:"Four taps, ten seconds. Prevents the executive function freefall between activities."}),(0,n.jsx)(D,{onClick:()=>p(!0),children:"Start transition"})]})}function es(e){let{active:t,onComplete:i}=e,[r,l]=(0,o.useState)("in"),[s,d]=(0,o.useState)(4),c=(0,o.useRef)(null);if((0,o.useEffect)(()=>{if(t)return l("in"),d(4),c.current=setInterval(()=>{d(e=>e<=1?"in"===r?(l("out"),6):(clearInterval(c.current),null==i||i(),0):e-1)},1e3),()=>clearInterval(c.current)},[t,r]),!t)return(0,n.jsx)(D,{onClick:i,children:"Skip breath"});let g="in"===r?80:50;return(0,n.jsxs)("div",{role:"timer","aria-live":"polite","aria-label":"".concat("in"===r?"Inhale":"Exhale",", ").concat(s),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10},children:[(0,n.jsx)("div",{style:{width:g,height:g,borderRadius:"50%",background:a.accentGlow,border:"2px solid ".concat(a.accentDeco),transition:"all 0.8s",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)("span",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,color:a.accent,fontWeight:700},children:s})}),(0,n.jsx)("span",{style:{fontSize:15,color:a.textMuted,fontStyle:"italic"},children:"in"===r?"In…":"Out…"})]})}function ed(e){let{transitions:t}=e,i=[...t].sort((e,t)=>t.timestamp-e.timestamp).slice(0,15);if(0===i.length)return null;let o={},r={};t.filter(e=>{let t=new Date(e.date+"T12:00:00");return 7>=Math.floor((new Date-t)/864e5)}).forEach(e=>{o[e.closing]=(o[e.closing]||0)+1,r[e.orienting]=(r[e.orienting]||0)+1});let l=Object.entries(o).sort((e,t)=>t[1]-e[1])[0];return(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:14,padding:"20px 22px"},children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:"0 0 12px"},children:"Transition Patterns"}),l&&(0,n.jsxs)("div",{style:{fontSize:14,color:a.textMuted,marginBottom:14},children:["Most frequent transition from: ",(0,n.jsx)("strong",{style:{color:a.accent},children:l[0]})," (",l[1],"x this week)"]}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:i.map((e,t)=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 0",borderBottom:t<i.length-1?"1px solid ".concat(a.borderLight):"none",fontSize:14},children:[(0,n.jsx)("span",{style:{color:a.textLight,minWidth:80},children:e.time}),(0,n.jsx)("span",{style:{color:a.text},children:e.closing}),(0,n.jsx)("span",{style:{color:a.textLight},children:"→"}),(0,n.jsx)("span",{style:{color:a.text},children:e.orienting})]},t))})]})}function ec(e){var t,i;let{defects:r,onSave:l}=e,[s,d]=(0,o.useState)(!1),[c,g]=(0,o.useState)(""),[h,u]=(0,o.useState)(""),[x,p]=(0,o.useState)(""),[m,f]=(0,o.useState)(""),[b,v]=(0,o.useState)(""),[j,w]=(0,o.useState)(""),[z,B]=(0,o.useState)(null),[W,R]=(0,o.useState)(!1);async function G(){if(0!==r.length){R(!0);try{var e;let t=r.slice(-20).map(e=>"".concat(e.date," ").concat(e.time,": ").concat(e.description," | Expected: ").concat(e.expected," | Actual: ").concat(e.actual," | Cause: ").concat(e.rootCause," | Fix: ").concat(e.corrective)).join("\n"),i=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1e3,system:'You are trained on the NSOM framework. Analyse defect logs from a neurodivergent person\'s behavioural debugging system. Look for recurring root causes and patterns. Suggest preventive controls. Respond JSON only:\n{"recurring_causes":["cause 1","cause 2"],"patterns":["pattern"],"preventive_actions":["action"],"summary":"3-4 sentences"}',messages:[{role:"user",content:"Defect logs:\n\n".concat(t)}]})}),n=await i.json(),o=(null===(e=n.content)||void 0===e?void 0:e.map(e=>e.text||"").join("\n"))||"";B(JSON.parse(o.replace(/```json|```/g,"").trim()))}catch(e){B({summary:"Unable to analyse.",recurring_causes:[],patterns:[],preventive_actions:[]})}R(!1)}}let M=[...r].sort((e,t)=>t.timestamp-e.timestamp);return(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:18},children:[s?(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.accent),borderRadius:14,padding:"22px 24px"},children:[(0,n.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:a.text,margin:"0 0 14px"},children:"New Defect Log"}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"df-what",style:{display:"block",fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"What happened?"}),(0,n.jsx)("textarea",{id:"df-what",value:c,onChange:e=>g(e.target.value),placeholder:"Brief description of the event",style:{width:"100%",minHeight:60,padding:14,border:"2px solid ".concat(a.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text,background:a.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"df-exp",style:{display:"block",fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Expected"}),(0,n.jsx)("input",{id:"df-exp",value:h,onChange:e=>u(e.target.value),placeholder:"What you planned",style:{width:"100%",padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"df-act",style:{display:"block",fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Actual"}),(0,n.jsx)("input",{id:"df-act",value:x,onChange:e=>p(e.target.value),placeholder:"What happened",style:{width:"100%",padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box"}})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:8},children:"Suspected root cause"}),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:y.map(e=>(0,n.jsx)(T,{label:e,selected:m===e,onClick:()=>f(e)},e))}),"Custom"===m&&(0,n.jsx)("input",{value:b,onChange:e=>v(e.target.value),placeholder:"Describe the cause",style:{width:"100%",padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box",marginTop:8}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"df-fix",style:{display:"block",fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:6},children:"Corrective action (one concrete change)"}),(0,n.jsx)("input",{id:"df-fix",value:j,onChange:e=>w(e.target.value),placeholder:"One specific thing to change",style:{width:"100%",padding:"12px 14px",minHeight:44,borderRadius:8,border:"2px solid ".concat(a.borderLight),fontSize:15,fontFamily:"inherit",color:a.text,background:a.bg,boxSizing:"border-box"}})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,n.jsx)(D,{onClick:function(){l({id:Date.now(),date:S(),time:C(),description:c,expected:h,actual:x,rootCause:"Custom"===m?b:m,corrective:j,timestamp:Date.now()}),g(""),u(""),p(""),f(""),v(""),w(""),d(!1)},disabled:!c.trim(),children:"Save defect"}),(0,n.jsx)(D,{variant:"ghost",onClick:()=>d(!1),children:"Cancel"})]})]})]}):(0,n.jsxs)("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[(0,n.jsx)(D,{onClick:()=>d(!0),children:"Log a defect"}),r.length>=3&&(0,n.jsx)(D,{variant:"secondary",onClick:G,disabled:W,children:W?"Analysing…":"Analyse ".concat(r.length," defects")})]}),z&&(0,n.jsxs)("div",{style:{background:a.bgDeep,borderRadius:14,padding:"20px 22px"},children:[(0,n.jsx)("div",{style:{fontSize:15,color:a.text,lineHeight:1.7,marginBottom:14},children:z.summary}),(null===(t=z.recurring_causes)||void 0===t?void 0:t.length)>0&&(0,n.jsxs)("div",{style:{marginBottom:12},children:[(0,n.jsx)("div",{style:{fontSize:13,fontWeight:700,color:a.red,marginBottom:6,textTransform:"uppercase",letterSpacing:1},children:"Recurring causes"}),z.recurring_causes.map((e,t)=>(0,n.jsx)("div",{style:{fontSize:14,color:a.text,paddingLeft:14,borderLeft:"3px solid ".concat(a.red),marginBottom:6},children:e},t))]}),(null===(i=z.preventive_actions)||void 0===i?void 0:i.length)>0&&(0,n.jsxs)("div",{style:{padding:14,background:a.greenSoft,borderRadius:10},children:[(0,n.jsx)("div",{style:{fontSize:13,fontWeight:700,color:a.green,marginBottom:6},children:"Preventive actions"}),z.preventive_actions.map((e,t)=>(0,n.jsx)("div",{style:{fontSize:14,color:a.text,lineHeight:1.6},children:e},t))]})]}),M.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{fontSize:14,fontWeight:600,color:a.textMuted,marginBottom:10},children:[M.length," defects logged"]}),M.slice(0,15).map((e,t)=>(0,n.jsxs)("div",{style:{background:a.white,border:"2px solid ".concat(a.borderLight),borderRadius:10,padding:"14px 18px",marginBottom:8},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[(0,n.jsxs)("span",{style:{fontSize:14,fontWeight:600,color:a.text},children:[k(e.date)," \xb7 ",e.time]}),(0,n.jsx)("span",{style:{padding:"2px 10px",borderRadius:10,fontSize:12,background:a.amberSoft,color:a.amber},children:e.rootCause})]}),(0,n.jsx)("div",{style:{fontSize:14,color:a.text,lineHeight:1.5,marginBottom:6},children:e.description}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,fontSize:13},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{style:{color:a.textLight},children:"Expected:"})," ",(0,n.jsx)("span",{style:{color:a.textMuted},children:e.expected})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{style:{color:a.textLight},children:"Actual:"})," ",(0,n.jsx)("span",{style:{color:a.textMuted},children:e.actual})]})]}),e.corrective&&(0,n.jsxs)("div",{style:{marginTop:8,padding:"8px 12px",background:a.greenSoft,borderRadius:8,fontSize:13,color:a.green},children:[(0,n.jsx)("strong",{children:"Fix:"})," ",e.corrective]})]},e.id))]})]})}function eg(){let[e,t]=(0,o.useState)("loop"),[i,l]=(0,o.useState)(null),[s,d]=(0,o.useState)(1),[c,y]=(0,o.useState)(!1),[b,k]=(0,o.useState)(!1),[w,C]=(0,o.useState)(!1),[B,G]=(0,o.useState)(!1),[T,H]=(0,o.useState)(1),[P,_]=(0,o.useState)(!1),[U,V]=(0,o.useState)(!1),[Y,q]=(0,o.useState)(""),[K,Q]=(0,o.useState)([]),[X,ee]=(0,o.useState)(""),[et,en]=(0,o.useState)(""),[es,eg]=(0,o.useState)(""),[eh,eu]=(0,o.useState)(""),[ex,ep]=(0,o.useState)(null),[em,ef]=(0,o.useState)([]),[ey,eb]=(0,o.useState)([]),[ev,ej]=(0,o.useState)([]),[eS,ek]=(0,o.useState)([]),[ew,eC]=(0,o.useState)({days:[],dischargeTime:"17:00"}),[ez,eB]=(0,o.useState)([]),[eD,eW]=(0,o.useState)([]),[eR,eG]=(0,o.useState)(!0);(0,o.useEffect)(()=>{try{ef(JSON.parse(localStorage.getItem(g)||"[]"))}catch(e){}try{eb(JSON.parse(localStorage.getItem(h)||"[]"))}catch(e){}try{ej(JSON.parse(localStorage.getItem(u)||"[]"))}catch(e){}try{ek(JSON.parse(localStorage.getItem(x)||"[]"))}catch(e){}try{eC(JSON.parse(localStorage.getItem(p)||'{"days":[],"dischargeTime":"17:00"}'))}catch(e){}try{eB(JSON.parse(localStorage.getItem(m)||"[]"))}catch(e){}try{eW(JSON.parse(localStorage.getItem(f)||"[]"))}catch(e){}eG(!1)},[]);let eM=(0,o.useCallback)((e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(e){}},[]);function eT(){s<6?d(s+1):C(!0)}function eL(){d(1),y(!1),C(!1),G(!1),H(1),_(!1),q(""),Q([]),ee(""),en(""),eg(""),eu(""),V(!1),l(null),ep(null)}function eF(e){Object.assign(e.target.style,v)}function eA(e){e.target.style.outline="none",e.target.style.outlineOffset=""}return(ev.length>0&&ev[ev.length-1],eR)?(0,n.jsx)("div",{style:{minHeight:"100vh",background:a.bg,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)("div",{role:"status",style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,color:a.textMuted},children:"Loading…"})}):(0,n.jsxs)("div",{style:{minHeight:"100vh",background:a.bg,fontFamily:"'Source Serif 4', Georgia, serif",color:a.text},children:[(0,n.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Source+Serif+4:ital,wght@0,300;0,400;0,500;0,600;1,400&display=swap",rel:"stylesheet"}),(0,n.jsx)("a",{href:"#main-content",style:j,children:"Skip to main content"}),(0,n.jsx)("header",{style:{borderBottom:"2px solid ".concat(a.border),padding:"26px 22px 20px",background:a.white},children:(0,n.jsxs)("div",{style:{maxWidth:720,margin:"0 auto"},children:[(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:3,color:a.accent,marginBottom:6},children:"The Nervous System Operating Manual"}),(0,n.jsx)("h1",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:30,fontWeight:700,color:a.text,lineHeight:1.2,margin:0},children:"Daily Regulation Protocol"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,fontStyle:"italic",margin:"6px 0 0"},children:"Your body has a job. Its job is to keep you safe."}),(0,n.jsxs)("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:10},children:[(0,n.jsx)("button",{role:"switch","aria-checked":b,onClick:async()=>{if(!b)try{await r.BL()}catch(e){}k(!b)},style:{width:48,height:28,borderRadius:14,border:"none",cursor:"pointer",background:b?a.accentBtn:a.bgWarm,position:"relative",transition:"background 0.2s"},onFocus:eF,onBlur:eA,children:(0,n.jsx)("div",{style:{width:22,height:22,borderRadius:"50%",background:a.white,position:"absolute",top:3,left:b?23:3,transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.15)"}})}),(0,n.jsx)("span",{style:{fontSize:13,color:a.textMuted},children:"Audio cues"})]})]})}),(0,n.jsx)("nav",{"aria-label":"Main",style:{borderBottom:"2px solid ".concat(a.border),background:a.white,position:"sticky",top:0,zIndex:10},children:(0,n.jsx)("div",{style:{maxWidth:720,margin:"0 auto",display:"flex",overflowX:"auto"},children:[{id:"loop",label:"Regulate",icon:"\uD83D\uDD04"},{id:"work",label:"Work",icon:"⏱"},{id:"dgaep",label:"DGAEP",icon:"↑"},{id:"tracking",label:"Tracking",icon:"\uD83D\uDCC8"},{id:"weekly",label:"Reset",icon:"\uD83D\uDD04"},{id:"defects",label:"Defects",icon:"\uD83D\uDD27"},{id:"analysis",label:"Analysis",icon:"\uD83E\uDDE0"},{id:"redlines",label:"Red Lines",icon:"\uD83D\uDCD5"}].map(i=>(0,n.jsxs)("button",{onClick:()=>{t(i.id),"loop"===i.id&&eL()},"aria-current":e===i.id?"page":void 0,style:{padding:"14px 14px",minHeight:48,border:"none",borderBottom:e===i.id?"3px solid ".concat(a.accent):"3px solid transparent",background:"transparent",color:e===i.id?a.accent:a.textMuted,fontSize:12,fontWeight:e===i.id?700:500,cursor:"pointer",fontFamily:"inherit",whiteSpace:"nowrap"},onFocus:eF,onBlur:eA,children:[(0,n.jsx)("span",{"aria-hidden":"true",children:i.icon})," ",i.label]},i.id))})}),(0,n.jsxs)("main",{id:"main-content",style:{maxWidth:720,margin:"0 auto",padding:"24px 18px 90px"},children:[(0,n.jsx)(O,{entries:em,checkins:ey,onAcknowledge:e=>{let t=[...eS,{type:e,date:S()}];ek(t),eM(x,t)},activeAlerts:eS}),"loop"===e&&(0,n.jsxs)("div",{children:[!i&&!U&&(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,n.jsx)(E,{checkins:ey,onSave:e=>{let t=[...ey.filter(t=>t.date!==e.date),e];eb(t),eM(h,t)}}),(0,n.jsx)(I,{onSelect:e=>{l(e),"discharge"===e&&G(!0)}})]}),i&&(0,n.jsxs)("div",{children:[(0,n.jsxs)(R,{type:"info",children:[(0,n.jsx)("strong",{children:"Core Principle:"})," No body change = no next step."]}),(0,n.jsx)("div",{style:{height:16}}),!U&&!P&&!B&&(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)(M,{current:Math.min(s,6),total:6,label:"Regulation loop"})}),U?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"44px 22px"},role:"status",children:[(0,n.jsx)("div",{style:{fontSize:48,marginBottom:14},children:"◉"}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:24,fontWeight:700,color:a.green,marginBottom:8},children:"Entry Stored"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,margin:"0 0 24px"},children:"Do not re-read."}),(0,n.jsx)(D,{variant:"secondary",onClick:eL,children:"New session"})]}):P?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"44px 22px"},role:"alert",children:[(0,n.jsx)("div",{style:{fontSize:48,marginBottom:14},children:"↑"}),(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:24,fontWeight:700,color:a.amber,marginBottom:8},children:"Escalate to DGAEP"}),(0,n.jsx)("p",{style:{fontSize:15,color:a.textMuted,margin:"0 0 24px"},children:"Not failure. Activation exceeds first-line capacity."}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[(0,n.jsx)(D,{onClick:()=>t("dgaep"),children:"Open DGAEP"}),(0,n.jsx)(D,{variant:"secondary",onClick:eL,children:"Reset"})]})]}):B?(0,n.jsx)(N,{entry:Y,setEntry:q,sensations:K,setSensations:Q,loadDomain:X,setLoadDomain:ee,hrv:et,setHrv:en,hr:es,setHr:eg,notes:eh,setNotes:eu,onSave:function(){let e=[...em,{date:S(),timeOfDay:z(),sessionType:i||"acute",gatePassed:!0,escalated:!1,attempts:T,journal:Y.trim()||null,sensations:K,loadDomain:X,hrv:et?Number(et):null,hr:es?Number(es):null,notes:eh.trim()||null,burnout:ex,redLine:!1}];ef(e),eM(g,e),V(!0)},sessionType:i,onEscalate:function(){if(Y.trim()){let e=[...em,{date:S(),timeOfDay:z(),sessionType:i||"acute",gatePassed:!0,escalated:!1,attempts:T,journal:Y.trim(),sensations:K,loadDomain:X,hrv:et?Number(et):null,hr:es?Number(es):null,notes:"Body escalated during journaling",burnout:ex,redLine:!1}];ef(e),eM(g,e)}V(!0)},burnout:ex,setBurnout:ep}):(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[T>1&&(0,n.jsx)("div",{role:"alert",style:{background:a.amberSoft,borderRadius:10,padding:"12px 18px",fontSize:14,color:a.amber,fontWeight:600,textAlign:"center"},children:"Second attempt — escalate if no change."}),(0,n.jsx)(F,{number:1,title:"Pause",why:"Stop. Stand still 10 seconds.",active:1===s,completed:s>1,children:(0,n.jsx)(D,{small:!0,onClick:eT,children:"Paused →"})}),(0,n.jsxs)(F,{number:2,title:"Breathe",why:"3 slow breaths: in 4, out 6.",active:2===s,completed:s>2,children:[!c&&(0,n.jsx)(D,{small:!0,onClick:()=>y(!0),children:"Start"}),(0,n.jsx)(L,{active:c,audioEnabled:b,onComplete:()=>{y(!1),eT()}})]}),(0,n.jsx)(F,{number:3,title:"Orient",why:"Name 3 colours in the room.",active:3===s,completed:s>3,children:(0,n.jsx)(D,{small:!0,onClick:eT,children:"Done →"})}),(0,n.jsx)(F,{number:4,title:"Body scan",why:"Head to toe. Name sensations.",active:4===s,completed:s>4,children:(0,n.jsx)(D,{small:!0,onClick:eT,children:"Scanned →"})}),(0,n.jsx)(F,{number:5,title:"Walk",why:"10 slow steps. Count each.",active:5===s,completed:s>5,children:(0,n.jsx)(D,{small:!0,onClick:eT,children:"Done →"})}),(0,n.jsx)(F,{number:6,title:"Second scan",why:'What changed? "Not worse" counts.',active:6===s,completed:w,children:(0,n.jsx)(D,{small:!0,onClick:eT,children:"Gate →"})}),w&&!B&&(0,n.jsx)(A,{onYes:function(){G(!0)},onNo:function(){if(T<2)H(2),d(1),C(!1);else{_(!0);let e=[...em,{date:S(),timeOfDay:z(),sessionType:i||"acute",gatePassed:!1,escalated:!0,attempts:2,journal:null,sensations:[],loadDomain:"",hrv:et?Number(et):null,hr:es?Number(es):null,notes:"",burnout:ex,redLine:!1}];ef(e),eM(g,e)}},attempt:T})]})]})]}),"work"===e&&(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:22},children:[(0,n.jsx)(W,{icon:"⏱",title:"Work Mode",subtitle:"90-minute ultradian cycles with meeting recovery and end-of-day discharge."}),(0,n.jsx)(ea,{workData:ew,onSave:e=>{eC(e),eM(p,e)},onNavigateToLoop:()=>{eL(),t("loop")}}),(0,n.jsx)(el,{transitions:ez,onComplete:e=>{let t=[...ez,e];eB(t),eM(m,t)}}),(0,n.jsx)(ed,{transitions:ez})]}),"dgaep"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(W,{icon:"↑",title:"DGAEP",subtitle:"When regulation fails, escalation is the next step."}),(0,n.jsx)(ei,{})]}),"tracking"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(W,{icon:"\uD83D\uDCC8",title:"Tracking",subtitle:"The pattern matters."}),0===em.length?(0,n.jsx)("div",{style:{textAlign:"center",padding:"44px 22px"},children:(0,n.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,color:a.textMuted},children:"No entries yet"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z,{entries:em}),(0,n.jsx)("div",{style:{height:22}}),(0,n.jsx)($,{entries:em})]})]}),"weekly"===e&&(0,n.jsx)(J,{entries:em,resets:ev,onComplete:e=>{let i=[...ev,e];ej(i),eM(u,i),t("tracking")},onNavigateToLoop:()=>{eL(),t("loop")}}),"defects"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(W,{icon:"\uD83D\uDD27",title:"Defect Log",subtitle:"Structured post-mortems. Not failure — engineering data."}),(0,n.jsx)(ec,{defects:eD,onSave:e=>{let t=[...eD,e];eW(t),eM(f,t)}})]}),"analysis"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(W,{icon:"\uD83E\uDDE0",title:"Analysis"}),(0,n.jsx)(er,{})]}),"redlines"===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(W,{icon:"\uD83D\uDCD5",title:"Red Lines",subtitle:"Non-negotiable structural load limits."}),(0,n.jsx)(eo,{})]})]}),(0,n.jsxs)("footer",{style:{borderTop:"2px solid ".concat(a.border),padding:"18px 22px",textAlign:"center",background:a.white},children:[(0,n.jsx)("div",{style:{fontSize:13,color:a.textMuted},children:"NSOM — Yve Bergeron — Neurodiversity & Autism Studies, UCC"}),(0,n.jsx)("div",{style:{fontSize:12,color:a.textLight,marginTop:4,fontStyle:"italic"},children:"The nervous system is the last interface."})]})]})}}},function(e){e.O(0,[953,971,117,744],function(){return e(e.s=34819)}),_N_E=e.O()}]);