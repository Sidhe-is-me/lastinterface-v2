(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532],{1716:function(e,t,n){Promise.resolve().then(n.bind(n,5512))},5512:function(e,t,n){"use strict";n.d(t,{default:function(){return V}});var i=n(7437),o=n(2265),r=n(7625),a=n(8173),s=n(6940),l=n(7059),d=n(2994),c=n(8147),g=n(4962),h=n(3263),p=n(4061);let u="nsom-tracker-v3",m="nsom-daily-v3",x="nsom-dgaep-session",f={bg:"#F0F5F4",bgDeep:"#E2ECEB",bgWarm:"#D5E3E1",white:"#FFFFFF",text:"#1A2F2E",textMuted:"#3D5C5A",textLight:"#5A7B79",accent:"#1B7A72",accentSoft:"#2A9D93",accentGlow:"rgba(27, 122, 114, 0.1)",green:"#1A6B4A",greenSoft:"rgba(26, 107, 74, 0.1)",greenDark:"#145438",amber:"#7A5D1A",amberSoft:"rgba(122, 93, 26, 0.12)",red:"#8B2E2E",redSoft:"rgba(139, 46, 46, 0.08)",blue:"#2B6684",blueSoft:"rgba(43, 102, 132, 0.1)",border:"#B8CCC9",borderLight:"#CDDAD8",focusRing:"#0E5A54"},y=["Cognitive","Emotional","Sensory","Social","Executive"],b=["Racing thoughts","Tight chest","Shallow breathing","Jaw clenched","Hands shaking","Nausea","Head pressure","Skin crawling","Heart pounding","Can't sit still","Frozen/stuck","Crying","Hot face","Numb","Dizzy","Hyperventilating"];function v(e,t){try{let n=localStorage.getItem(e);return n?JSON.parse(n):t}catch(e){return t}}function j(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){}}function S(){return new Date().toISOString().split("T")[0]}function w(){return new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}let k={outline:"3px solid ".concat(f.focusRing),outlineOffset:"2px"},z={position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},C=[{number:1,title:"Pause",instruction:"Stop what you are doing. Sit or stand still for 10 seconds.",rationale:"Interrupts the current autonomic trajectory. The nervous system cannot begin regulation while the body is still in motion toward the stressor. Stopping creates the micro-gap the vagus nerve needs to initiate a shift.",timerSeconds:10,timerLabel:"10-second pause",trackPrompt:"I've paused",trackWhat:"Paused and held still"},{number:2,title:"Breathe",instruction:"3 slow breaths: in through the nose (4 counts), out through the mouth (6 counts).",rationale:"Extended exhale activates the vagus nerve directly. The 4:6 ratio is not arbitrary — the exhale must be longer than the inhale to trigger parasympathetic engagement. This is the single most reliable first-line vagal activation technique in the research literature.",hasBreathingGuide:!0,trackPrompt:"Breathing complete",trackWhat:"3 slow breaths (4-in, 6-out)"},{number:3,title:"Orient Visually",instruction:"Find and name 3 colors in the room. Say them out loud or internally.",rationale:"Activates the ventral vagal complex through visual orientation without emotional content. Naming colors engages the prefrontal cortex in a low-demand task, competing with the amygdala for processing resources. This is neuroception — telling the nervous system 'I can see, therefore I am safe enough to look.'",timerSeconds:30,timerLabel:"Orientation time",trackPrompt:"I've named 3 colors",trackWhat:"Named 3 colors in room"},{number:4,title:"Body Scan",instruction:"Notice sensations from head to toe. Name what you find: tight, heavy, buzzy, numb, warm, cold.",rationale:"Naming without interpreting prevents the scan from becoming a trigger. Interoception — the ability to notice internal body states — is the foundation of regulation. Many neurodivergent people have altered interoception (either heightened or diminished). This step trains the channel without overloading it.",timerSeconds:60,timerLabel:"Body scan timer",trackPrompt:"Scan complete",trackWhat:"Head-to-toe body scan"},{number:5,title:"Walk",instruction:"10 slow steps, counting each one. Or rock gently if walking isn't possible.",rationale:"Rhythmic bilateral movement activates both hemispheres simultaneously. This is the most reliably effective single intervention in the protocol. Walking engages proprioception, vestibular input, and motor cortex — all of which compete with the cognitive loop maintaining the dysregulation. The body moves before the mind decides to.",timerSeconds:45,timerLabel:"Walking timer",trackPrompt:"10 steps done",trackWhat:"10 slow counted steps"},{number:6,title:"Second Body Scan",instruction:"Notice what changed. Any change counts. Even 'not worse' is valid.",rationale:"The protocol asks 'did anything change?' not 'do you feel better?' This is the critical distinction. Regulation is not about feeling good — it is about the system showing any capacity to shift state. A 2% change and a 90% change are both valid gate passes. The body decides, not the mind.",timerSeconds:45,timerLabel:"Second scan",trackPrompt:"Go to decision gate",trackWhat:"Second body scan — noted changes"}];function R(e){let{children:t,onClick:n,variant:o="primary",disabled:r,small:a,style:s,ariaLabel:l}=e,d={padding:a?"8px 18px":"12px 26px",borderRadius:8,fontSize:a?14:15,fontWeight:600,cursor:r?"default":"pointer",fontFamily:"inherit",border:"none",transition:"background 0.2s, color 0.2s",minHeight:44,minWidth:44,...s},c={primary:{background:r?f.bgWarm:f.accent,color:r?f.textLight:f.white},secondary:{background:"transparent",color:f.textMuted,border:"2px solid ".concat(f.border)},green:{background:f.green,color:f.white},amber:{background:f.amber,color:f.white},ghost:{background:"transparent",color:f.textMuted,padding:a?"6px 12px":"10px 18px"}};return(0,i.jsx)("button",{onClick:n,disabled:r,"aria-label":l,"aria-disabled":r||void 0,style:{...d,...c[o]},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:t})}function T(e){let{title:t,subtitle:n,level:o=2}=e;return(0,i.jsxs)("div",{style:{marginBottom:16},children:[(0,i.jsx)("h".concat(o),{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:1===o?28:24,fontWeight:700,color:f.text,lineHeight:1.2,margin:0},children:t}),n&&(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,marginTop:4,margin:"4px 0 0"},children:n})]})}function D(e){let{children:t,type:n="info",role:o="note"}=e,r={info:{bg:f.amberSoft,border:f.amber},success:{bg:f.greenSoft,border:f.green},warning:{bg:f.redSoft,border:f.red},neutral:{bg:f.bgDeep,border:f.accent}}[n];return(0,i.jsx)("div",{role:o,style:{background:r.bg,borderLeft:"4px solid ".concat(r.border),borderRadius:10,padding:"14px 18px",color:f.text,fontSize:15,lineHeight:1.7},children:t})}function W(e){var t,n;let{active:r,onComplete:a}=e,[s,l]=(0,o.useState)("ready"),[d,c]=(0,o.useState)(0),[g,h]=(0,o.useState)(0),p=(0,o.useRef)(null),u=null===(t=(n=window).matchMedia)||void 0===t?void 0:t.call(n,"(prefers-reduced-motion: reduce)").matches;if((0,o.useEffect)(()=>{if(!r){l("ready"),c(0),h(0);return}"ready"===s&&(l("inhale"),c(4),h(1))},[r]),(0,o.useEffect)(()=>{if(r&&"ready"!==s&&"done"!==s)return p.current=setInterval(()=>{c(e=>{if(e<=1){if("inhale"===s)return l("exhale"),6;if("exhale"===s)return g>=3?(l("done"),clearInterval(p.current),setTimeout(()=>null==a?void 0:a(),600),0):(h(e=>e+1),l("inhale"),4)}return e-1})},1e3),()=>clearInterval(p.current)},[s,r,g]),!r||"ready"===s)return null;let m=u?90:"inhale"===s?120:"exhale"===s?60:90,x="inhale"===s?"Breathe in through your nose...":"exhale"===s?"Breathe out through your mouth...":"Complete";return(0,i.jsxs)("div",{role:"timer","aria-live":"polite","aria-label":"Breathing guide. ".concat(x," ").concat(d," seconds remaining. Breath ").concat(Math.min(g,3)," of 3."),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:14,padding:"24px 0"},children:[(0,i.jsx)("div",{style:{width:m,height:m,borderRadius:"50%",background:"radial-gradient(circle, ".concat(f.accentSoft,"44 0%, ").concat(f.accent,"22 100%)"),border:"3px solid ".concat(f.accent),transition:u?"none":"all 1s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)("span",{"aria-hidden":"true",style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:28,color:f.accent,fontWeight:700},children:"done"===s?"✓":d})}),(0,i.jsx)("span",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,color:f.text,fontStyle:"italic"},children:x}),(0,i.jsxs)("span",{style:{fontSize:13,color:f.textMuted},children:["Breath ",Math.min(g,3)," of 3"]})]})}function B(e){let{duration:t,label:n,onComplete:r}=e,[a,s]=(0,o.useState)(t),[l,d]=(0,o.useState)(!1),c=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(!l){clearInterval(c.current);return}return c.current=setInterval(()=>{s(e=>e<=1?(clearInterval(c.current),d(!1),null==r||r(),0):e-1)},1e3),()=>clearInterval(c.current)},[l]);let g=Math.floor(a/60),h=a%60,p=(t-a)/t*100,u=g>0?"".concat(g,":").concat(h.toString().padStart(2,"0")):"".concat(h,"s");return(0,i.jsxs)("div",{role:"timer","aria-label":"".concat(n,": ").concat(u," remaining"),style:{background:f.white,border:"1px solid ".concat(f.borderLight),borderRadius:10,padding:"14px 18px",marginTop:10},children:[(0,i.jsx)("div",{style:{fontSize:13,color:f.textMuted,marginBottom:6},children:n}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:14},children:[(0,i.jsx)("div",{"aria-live":"polite",style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:32,fontWeight:700,color:0===a?f.green:f.text,minWidth:70},children:u}),(0,i.jsx)("div",{style:{flex:1},role:"progressbar","aria-valuenow":Math.round(p),"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Timer progress: ".concat(Math.round(p),"%"),children:(0,i.jsx)("div",{style:{height:6,background:f.bgDeep,borderRadius:3,overflow:"hidden"},children:(0,i.jsx)("div",{style:{height:"100%",width:"".concat(p,"%"),background:0===a?f.green:f.accent,borderRadius:3,transition:"width 1s linear"}})})}),(0,i.jsx)("div",{style:{display:"flex",gap:6},children:0===a?(0,i.jsx)("span",{style:{fontSize:14,color:f.green,fontWeight:700},role:"status",children:"Complete"}):l?(0,i.jsx)(R,{small:!0,variant:"secondary",onClick:function(){d(!1)},ariaLabel:"Pause timer",children:"Pause"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R,{small:!0,onClick:function(){d(!0)},ariaLabel:a<t?"Resume timer":"Start timer",children:a<t?"Resume":"Start"}),a<t&&(0,i.jsx)(R,{small:!0,variant:"ghost",onClick:function(){d(!1),s(t)},ariaLabel:"Reset timer",children:"Reset"})]})})]})]})}function F(e){let{stepDef:t,active:n,completed:r,completedTime:a,onComplete:s,onBreathingStart:l,breathingActive:d}=e,[c,g]=(0,o.useState)(!1),h=(0,o.useRef)(null),{number:p,title:u,instruction:m,rationale:x,timerSeconds:y,timerLabel:b,hasBreathingGuide:v,trackPrompt:j}=t;return(0,o.useEffect)(()=>{n&&h.current&&h.current.focus({preventScroll:!1})},[n]),(0,i.jsxs)("article",{ref:h,tabIndex:n?0:-1,"aria-label":"Step ".concat(p,": ").concat(u).concat(r?" — completed":n?" — current step":" — upcoming"),"aria-current":n?"step":void 0,style:{background:r?f.greenSoft:n?f.white:f.bgDeep,border:"2px solid ".concat(n?f.accent:r?f.green:f.borderLight),borderRadius:14,overflow:"hidden",transition:"border-color 0.2s",opacity:n||r?1:.6},onFocus:e=>{n&&Object.assign(e.currentTarget.style,{outline:"3px solid ".concat(f.focusRing),outlineOffset:"2px"})},onBlur:e=>{e.currentTarget.style.outline="none"},children:[(0,i.jsxs)("div",{style:{padding:"16px 20px",display:"flex",alignItems:"center",gap:14},children:[(0,i.jsx)("div",{"aria-hidden":"true",style:{width:36,height:36,borderRadius:"50%",background:r?f.green:n?f.accent:f.bgWarm,color:r||n?f.white:f.textMuted,display:"flex",alignItems:"center",justifyContent:"center",fontSize:15,fontWeight:700,flexShrink:0},children:r?"✓":p}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:19,fontWeight:700,color:f.text,margin:0},children:u}),r&&a&&(0,i.jsxs)("div",{style:{fontSize:13,color:f.greenDark,marginTop:2},children:["Completed at ",a]})]}),r&&(0,i.jsx)("span",{style:{padding:"4px 12px",borderRadius:12,background:f.green,color:f.white,fontSize:12,fontWeight:700,letterSpacing:.5},"aria-hidden":"true",children:"DONE"})]}),n&&(0,i.jsxs)("div",{style:{padding:"0 20px 20px",borderTop:"1px solid ".concat(f.borderLight),paddingTop:16},children:[(0,i.jsx)("p",{style:{fontSize:15,color:f.text,lineHeight:1.7,marginBottom:12,margin:"0 0 12px"},children:m}),(0,i.jsxs)("button",{onClick:()=>g(!c),"aria-expanded":c,"aria-controls":"rationale-".concat(p),style:{background:"none",border:"none",cursor:"pointer",fontSize:14,color:f.accent,fontWeight:600,fontFamily:"inherit",padding:"6px 0",marginBottom:c?8:12,display:"flex",alignItems:"center",gap:8,minHeight:44},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:[(0,i.jsx)("span",{"aria-hidden":"true",style:{transition:"transform 0.2s",transform:c?"rotate(90deg)":"rotate(0deg)",display:"inline-block"},children:"▸"}),c?"Hide rationale":"Why this works"]}),c&&(0,i.jsx)("div",{id:"rationale-".concat(p),role:"region","aria-label":"Rationale for step ".concat(p),style:{fontSize:14,color:f.textMuted,lineHeight:1.7,padding:"14px 18px",marginBottom:14,background:f.bgDeep,borderRadius:8,borderLeft:"3px solid ".concat(f.accentSoft)},children:x}),y&&!v&&(0,i.jsx)(B,{duration:y,label:b,onComplete:()=>{}}),v&&(0,i.jsxs)(i.Fragment,{children:[!d&&(0,i.jsx)(R,{small:!0,onClick:l,ariaLabel:"Start guided breathing exercise",style:{marginBottom:8},children:"Start breathing guide"}),(0,i.jsx)(W,{active:d,onComplete:s})]}),!v&&(0,i.jsx)("div",{style:{marginTop:14,display:"flex",justifyContent:"flex-end"},children:(0,i.jsxs)(R,{small:!0,onClick:s,ariaLabel:"Mark step ".concat(p," as complete: ").concat(j),children:[j," →"]})})]})]})}function M(e){let{onYes:t,onNo:n,attempt:o}=e;return(0,i.jsxs)("section",{"aria-label":"Decision gate",role:"region",style:{background:"linear-gradient(135deg, ".concat(f.amberSoft,", ").concat(f.accentGlow,")"),border:"2px solid ".concat(f.amber),borderRadius:14,padding:"28px 24px",textAlign:"center"},children:[(0,i.jsxs)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:13,fontWeight:700,textTransform:"uppercase",letterSpacing:2.5,color:f.amber,marginBottom:10,margin:"0 0 10px"},children:["Decision Gate",o>1?" — Attempt ".concat(o):""]}),(0,i.jsx)("p",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:f.text,marginBottom:8,margin:"0 0 8px"},children:"Did the body show any change?"}),(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,marginBottom:22,lineHeight:1.7,maxWidth:460,margin:"0 auto 22px"},children:'Any change counts: breathing slightly slower, shoulders slightly lower, thoughts slightly less loud. Even "not worse" is valid.'}),(0,i.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"},children:[(0,i.jsx)(R,{variant:"green",onClick:t,ariaLabel:"Yes, something shifted — pass the gate",children:"Yes — something shifted"}),(0,i.jsx)(R,{variant:"secondary",onClick:n,ariaLabel:"No change detected",children:"No change"})]})]})}function L(e){let{completedSteps:t,totalSteps:n}=e,o=n>0?t/n*100:0;return(0,i.jsxs)("div",{style:{background:f.white,border:"1px solid ".concat(f.borderLight),borderRadius:12,padding:"14px 18px",marginBottom:16},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,i.jsx)("span",{style:{fontSize:14,fontWeight:700,color:f.text},children:"Today's Loop"}),(0,i.jsxs)("span",{style:{fontSize:14,color:t===n&&t>0?f.green:f.textMuted,fontWeight:700},children:[t,"/",n," steps"]})]}),(0,i.jsx)("div",{role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":n,"aria-label":"Daily progress: ".concat(t," of ").concat(n," steps completed"),children:(0,i.jsx)("div",{style:{height:8,background:f.bgDeep,borderRadius:4,overflow:"hidden"},children:(0,i.jsx)("div",{style:{height:"100%",width:"".concat(o,"%"),background:t===n&&t>0?f.green:f.accent,borderRadius:4,transition:"width 0.5s ease"}})})})]})}async function G(e,t){try{var n;let i=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1e3,system:e,messages:[{role:"user",content:t}]})}),o=await i.json();return(null===(n=o.content)||void 0===n?void 0:n.map(e=>e.text||"").join("\n"))||"No response received."}catch(e){return"Unable to connect to analysis. Please try again."}}function N(){let[e,t]=(0,o.useState)(""),[n,r]=(0,o.useState)(null),[a,s]=(0,o.useState)(!1);async function l(){if(!e.trim())return;s(!0);let t=await G('You are an expert in autonomic nervous system regulation for neurodivergent individuals, specifically trained on the Nervous System Operating Manual (NSOM) framework by Yve Bergeron.\n\nYour task is to identify which of the Five Load Domains are currently active based on a person\'s description of their state. The five domains are:\n\n1. COGNITIVE — processing demands: thinking, learning, holding info. Markers: head pressure, mental fog, "too many tabs open"\n2. EMOTIONAL — felt and unfelt emotion, masking suppression. Markers: chest tightness, throat constriction, facial heat, disproportionate tears/anger\n3. SENSORY — total sensory channel input. Markers: skin crawling, causeless irritability, flinching at sounds, filtering difficulty\n4. SOCIAL — interaction processing demands, masking. Markers: post-social exhaustion, mental rehearsal, eye contact difficulty\n5. EXECUTIVE — planning, organizing, initiating, transitioning. Markers: paralysis, decision fatigue, the "wall" between intention and action\n\nRespond in this exact JSON format only, no markdown, no backticks:\n{"primary":"domain name","secondary":"domain name or null","confidence":"high/medium/low","explanation":"2-3 sentences explaining why","intervention":"1-2 specific intervention suggestions based on the identified domain"}',"Here is what I'm experiencing right now: ".concat(e));try{let e=t.replace(/```json|```/g,"").trim();r(JSON.parse(e))}catch(e){r({primary:"Unknown",secondary:null,confidence:"low",explanation:t,intervention:"Try describing your physical sensations and current situation in more detail."})}s(!1)}let d={Cognitive:f.blue,Emotional:f.red,Sensory:f.amber,Social:f.accent,Executive:f.green};return(0,i.jsxs)("section",{"aria-label":"Load domain detection",style:{background:f.white,border:"1px solid ".concat(f.border),borderRadius:12,padding:20},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:f.text,marginBottom:4,margin:"0 0 4px"},children:"Load Domain Detection"}),(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,marginBottom:14,margin:"0 0 14px"},children:"Describe what you're experiencing — physical sensations, situation, what's difficult right now."}),(0,i.jsx)("label",{htmlFor:"load-input",style:z,children:"Describe your current state"}),(0,i.jsx)("textarea",{id:"load-input",value:e,onChange:e=>t(e.target.value),placeholder:"e.g., I can't start the report even though I know what to write. My head feels foggy and I keep checking my phone instead...",style:{width:"100%",minHeight:80,padding:14,border:"2px solid ".concat(f.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:f.text,background:f.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box",outline:"none"},onFocus:e=>{e.target.style.borderColor=f.focusRing,Object.assign(e.target.style,k)},onBlur:e=>{e.target.style.borderColor=f.borderLight,e.target.style.outline="none"}}),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:(0,i.jsx)(R,{onClick:l,disabled:!e.trim()||a,ariaLabel:"Analyze load domains",children:a?"Analyzing...":"Identify Load Domains"})}),n&&(0,i.jsxs)("div",{role:"region","aria-live":"polite","aria-label":"Analysis results",style:{marginTop:16,padding:16,background:f.bgDeep,borderRadius:10},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:[(0,i.jsxs)("span",{style:{padding:"5px 14px",borderRadius:20,background:d[n.primary]||f.accent,color:f.white,fontSize:14,fontWeight:700},children:["Primary: ",n.primary]}),n.secondary&&"null"!==n.secondary&&(0,i.jsxs)("span",{style:{padding:"5px 14px",borderRadius:20,background:f.bgWarm,color:d[n.secondary]||f.accent,fontSize:14,fontWeight:700,border:"2px solid ".concat(d[n.secondary]||f.accent)},children:["Secondary: ",n.secondary]})]}),(0,i.jsx)("p",{style:{fontSize:14,color:f.text,lineHeight:1.7,marginBottom:10,margin:"0 0 10px"},children:n.explanation}),(0,i.jsxs)("div",{style:{fontSize:14,color:f.greenDark,lineHeight:1.7,padding:"12px 16px",background:f.greenSoft,borderRadius:8},children:[(0,i.jsx)("strong",{children:"Intervention:"})," ",n.intervention]})]})]})}function O(e){var t;let{entries:n}=e,[r,a]=(0,o.useState)(null),[s,l]=(0,o.useState)(!1),d=n.filter(e=>(new Date-new Date(e.date))/864e5<=7);async function c(){if(0===d.length)return;l(!0);let e=d.map(e=>"Date:".concat(e.date," Gate:").concat(e.gatePassed?"passed":"no"," Attempts:").concat(e.attempts||1," Steps:").concat((e.stepsCompleted||[]).join(",")," Domain:").concat(e.loadDomain||"?"," Sensations:").concat((e.sensations||[]).join(",")," HRV:").concat(e.hrv||"?"," Journal:").concat(e.journal||"none")).join("\n"),t=await G('You are an expert in autonomic nervous system regulation for neurodivergent individuals, trained on the NSOM framework by Yve Bergeron.\n\nPerform a Weekly Pattern Analysis. Your job:\n1. Identify recurring patterns — what keeps showing up (not why)\n2. Note which load domains appear most often\n3. Note body sensation patterns\n4. Assess gate pass rate\n5. Suggest ONE concrete action\n\nRules: Look for patterns, not causes. One decision maximum. Do not psychoanalyze.\n\nRespond in JSON only, no markdown, no backticks:\n{"patterns":["pattern 1","pattern 2","pattern 3"],"dominant_domain":"most frequent domain or null","sensation_pattern":"recurring body sensations","gate_rate":"X/Y with brief interpretation","risk_flags":["any red line concerns"],"one_decision":"single concrete action suggested","summary":"3-4 sentence overall assessment"}',"Regulation log entries from the past 7 days:\n\n".concat(e));try{a(JSON.parse(t.replace(/```json|```/g,"").trim()))}catch(e){a({patterns:[],dominant_domain:null,sensation_pattern:"",gate_rate:"",risk_flags:[],one_decision:"",summary:t})}l(!1)}return(0,i.jsxs)("section",{"aria-label":"Weekly pattern analysis",style:{background:f.white,border:"1px solid ".concat(f.border),borderRadius:12,padding:20},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:f.text,margin:"0 0 4px"},children:"Weekly Pattern Analysis"}),(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,margin:"0 0 14px"},children:0===d.length?"No entries in the past 7 days.":"".concat(d.length," entries available.")}),(0,i.jsx)(R,{onClick:c,disabled:0===d.length||s,ariaLabel:"Analyze ".concat(d.length," entries"),children:s?"Analyzing...":"Analyze ".concat(d.length," entries")}),r&&(0,i.jsxs)("div",{role:"region","aria-live":"polite",style:{marginTop:16,display:"flex",flexDirection:"column",gap:12},children:[(0,i.jsx)("p",{style:{padding:14,background:f.bgDeep,borderRadius:10,fontSize:14,color:f.text,lineHeight:1.7,margin:0},children:r.summary}),(null===(t=r.patterns)||void 0===t?void 0:t.length)>0&&(0,i.jsxs)("div",{style:{padding:14,background:f.blueSoft,borderRadius:10},children:[(0,i.jsx)("h4",{style:{fontSize:13,fontWeight:700,color:f.blue,marginBottom:6,textTransform:"uppercase",letterSpacing:1,margin:"0 0 6px"},children:"Recurring Patterns"}),r.patterns.map((e,t)=>(0,i.jsx)("p",{style:{fontSize:14,color:f.text,lineHeight:1.7,paddingLeft:12,borderLeft:"2px solid ".concat(f.blue),marginBottom:6,margin:"0 0 6px"},children:e},t))]}),r.one_decision&&(0,i.jsxs)("div",{style:{padding:14,background:f.greenSoft,borderRadius:10,borderLeft:"4px solid ".concat(f.green)},children:[(0,i.jsx)("h4",{style:{fontSize:13,fontWeight:700,color:f.greenDark,margin:"0 0 4px"},children:"One Decision (Maximum)"}),(0,i.jsx)("p",{style:{fontSize:15,color:f.text,lineHeight:1.7,margin:0},children:r.one_decision})]})]})]})}function A(){let[e,t]=(0,o.useState)(!1);return(0,i.jsx)("section",{"aria-label":"What is DGAEP",style:{marginBottom:20},children:(0,i.jsxs)("div",{style:{background:f.white,border:"2px solid ".concat(f.borderLight),borderRadius:14,padding:"20px 22px"},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:20,fontWeight:700,color:f.text,margin:"0 0 10px"},children:"What is DGAEP?"}),(0,i.jsxs)("p",{style:{fontSize:15,color:f.text,lineHeight:1.7,margin:"0 0 10px"},children:["The Decision-Gated Autonomic Escalation Protocol is what happens ",(0,i.jsx)("em",{children:"after"})," first-line regulation has been tried and has not worked. It is not a replacement for breathing, grounding, or body scanning. It is the structured next step when those approaches encounter a nervous system state that exceeds their operating range."]}),(0,i.jsxs)("p",{style:{fontSize:15,color:f.text,lineHeight:1.7,margin:"0 0 12px"},children:["If breathing three times did not work, breathing ten times will not work. The system needs ",(0,i.jsx)("em",{children:"different"})," input, not more of the same."]}),(0,i.jsxs)("button",{onClick:()=>t(!e),"aria-expanded":e,"aria-controls":"dgaep-principles",style:{background:"none",border:"none",cursor:"pointer",fontSize:14,color:f.accent,fontWeight:700,fontFamily:"inherit",padding:"6px 0",display:"flex",alignItems:"center",gap:8,minHeight:44},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:[(0,i.jsx)("span",{"aria-hidden":"true",style:{transition:"transform 0.2s",transform:e?"rotate(90deg)":"rotate(0deg)",display:"inline-block"},children:"▸"}),e?"Hide core principles":"Read the 5 core principles"]}),e&&(0,i.jsx)("div",{id:"dgaep-principles",role:"region","aria-label":"DGAEP core principles",style:{marginTop:10,display:"flex",flexDirection:"column",gap:10},children:[{title:"Regulation attempts may fail without indicating error",desc:"A technique that doesn't produce a calming response has not failed. It has encountered a system state that exceeds its operating range. The response is escalation to a different category of input."},{title:"Escalation is physiological, not emotional",desc:"DGAEP does not ask what you are feeling, why you are upset, or what triggered the activation. It asks only: did the body change? This is a physiological decision, not a psychological one."},{title:"Cognitive slowing is not always achievable",desc:"When voluntary cognitive slowing fails, the protocol shifts to cognitive interruption — not calming the thoughts, but redirecting the processing resources maintaining the loop toward external structured tasks."},{title:"Containment is a valid endpoint",desc:"Not every escalation resolves in calm. Sometimes the best achievable outcome is: the activation does not get worse, you do not harm yourself or others, and the system is given time."},{title:"Medical escalation has defined red flags",desc:"If chest pain, fainting, confusion, slurred speech, new neurological symptoms, or panic persisting for hours without fluctuation appear — the protocol terminates and medical support is sought. This is non-negotiable."}].map((e,t)=>(0,i.jsxs)("div",{style:{padding:"12px 16px",background:f.bgDeep,borderRadius:8,borderLeft:"3px solid ".concat(f.accent)},children:[(0,i.jsxs)("h4",{style:{fontSize:14,fontWeight:700,color:f.text,margin:"0 0 4px"},children:[t+1,". ",e.title]}),(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,lineHeight:1.6,margin:0},children:e.desc})]},t))})]})})}function H(e){let{label:t,stateKey:n,selectedStates:o,setSelectedStates:r,freeText:a,setFreeText:s,timestamp:l}=e,d=e=>r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]);return(0,i.jsxs)("div",{style:{background:f.bgDeep,borderRadius:10,padding:"16px 18px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[(0,i.jsx)("h4",{style:{fontSize:14,fontWeight:700,color:f.text,margin:0,textTransform:"uppercase",letterSpacing:1},children:t}),l&&(0,i.jsx)("span",{style:{fontSize:12,color:f.textMuted},children:l})]}),(0,i.jsxs)("fieldset",{style:{border:"none",padding:0,margin:0},children:[(0,i.jsxs)("legend",{style:z,children:[t," — select what you notice"]}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:10},role:"group","aria-label":"".concat(t," body sensations"),children:b.map(e=>(0,i.jsx)("button",{onClick:()=>d(e),role:"checkbox","aria-checked":o.includes(e),style:{padding:"6px 12px",borderRadius:20,border:"2px solid ".concat(o.includes(e)?f.accent:f.borderLight),background:o.includes(e)?f.accentGlow:"transparent",color:o.includes(e)?f.accent:f.textMuted,fontSize:13,cursor:"pointer",fontFamily:"inherit",fontWeight:o.includes(e)?700:400,minHeight:36},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:e},e))})]}),(0,i.jsx)("label",{htmlFor:"body-note-".concat(n),style:{fontSize:13,color:f.textMuted,display:"block",marginBottom:4},children:"Anything else you notice (optional)"}),(0,i.jsx)("input",{id:"body-note-".concat(n),type:"text",value:a,onChange:e=>s(e.target.value),placeholder:"e.g., left shoulder won't drop, vision tunneling...",style:{width:"100%",padding:"10px 14px",borderRadius:6,border:"2px solid ".concat(f.borderLight),fontSize:14,fontFamily:"inherit",color:f.text,background:f.white,boxSizing:"border-box",minHeight:44},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"}})]})}function I(e){let{beforeStates:t,beforeNote:n,afterStates:o,afterNote:r}=e;if(0===t.length&&0===o.length)return null;let a=t.filter(e=>!o.includes(e)),s=t.filter(e=>o.includes(e)),l=o.filter(e=>!t.includes(e));return(0,i.jsxs)("div",{role:"region","aria-label":"Before and after comparison",style:{background:f.white,border:"2px solid ".concat(f.borderLight),borderRadius:12,padding:"16px 18px",marginTop:12},children:[(0,i.jsx)("h4",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:17,fontWeight:700,color:f.text,margin:"0 0 12px"},children:"What Changed"}),a.length>0&&(0,i.jsxs)("div",{style:{marginBottom:10},children:[(0,i.jsx)("span",{style:{fontSize:13,fontWeight:700,color:f.green,textTransform:"uppercase",letterSpacing:.5},children:"Resolved"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginTop:4},children:a.map(e=>(0,i.jsx)("span",{style:{padding:"3px 10px",borderRadius:16,background:f.greenSoft,color:f.green,fontSize:13,fontWeight:600,textDecoration:"line-through"},children:e},e))})]}),s.length>0&&(0,i.jsxs)("div",{style:{marginBottom:10},children:[(0,i.jsx)("span",{style:{fontSize:13,fontWeight:700,color:f.amber,textTransform:"uppercase",letterSpacing:.5},children:"Still present"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginTop:4},children:s.map(e=>(0,i.jsx)("span",{style:{padding:"3px 10px",borderRadius:16,background:f.amberSoft,color:f.amber,fontSize:13,fontWeight:600},children:e},e))})]}),l.length>0&&(0,i.jsxs)("div",{style:{marginBottom:10},children:[(0,i.jsx)("span",{style:{fontSize:13,fontWeight:700,color:f.blue,textTransform:"uppercase",letterSpacing:.5},children:"New"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginTop:4},children:l.map(e=>(0,i.jsx)("span",{style:{padding:"3px 10px",borderRadius:16,background:f.blueSoft,color:f.blue,fontSize:13,fontWeight:600},children:e},e))})]}),0===a.length&&0===s.length&&0===l.length&&(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,margin:0,fontStyle:"italic"},children:"No changes detected between states."}),(n||r)&&(0,i.jsxs)("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid ".concat(f.borderLight),fontSize:13,color:f.textMuted},children:[n&&(0,i.jsxs)("p",{style:{margin:"0 0 4px"},children:[(0,i.jsx)("strong",{children:"Before note:"})," ",n]}),r&&(0,i.jsxs)("p",{style:{margin:0},children:[(0,i.jsx)("strong",{children:"After note:"})," ",r]})]})]})}function E(){let[e,t]=(0,o.useState)(null),[n,r]=(0,o.useState)(!1),[a,s]=(0,o.useState)([]),[l,d]=(0,o.useState)(""),[c,g]=(0,o.useState)(null),[h,p]=(0,o.useState)({}),[u,m]=(0,o.useState)({}),[y,b]=(0,o.useState)({}),[z,C]=(0,o.useState)([]),[T,W]=(0,o.useState)(""),[F,M]=(0,o.useState)(!1);function L(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};j(x,{date:S(),started:n,beforeStates:a,beforeNote:l,beforeTime:c,afterStates:h,afterNotes:u,levelResults:y,...e})}function G(e){let t={...h,[e]:z},n={...u,[e]:T};p(t),m(n),M(!1),C([]),W(""),L({afterStates:t,afterNotes:n})}function N(e,t){let n={...y,[e]:{result:t,time:w()}};b(n),L({levelResults:n})}(0,o.useEffect)(()=>{let e=v(x,null);e&&e.date===S()&&(r(e.started||!1),s(e.beforeStates||[]),d(e.beforeNote||""),g(e.beforeTime||null),p(e.afterStates||{}),m(e.afterNotes||{}),b(e.levelResults||{}))},[]);let O=Math.max(...Object.keys(h).map(Number),0),E=h[O]||[],P=u[O]||"";return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,i.jsx)(A,{}),n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:f.accentGlow,borderRadius:10,padding:"10px 16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{fontSize:13,fontWeight:700,color:f.accent},children:"Escalation session active"}),c&&(0,i.jsxs)("span",{style:{fontSize:13,color:f.textMuted,marginLeft:8},children:["Started ",c]})]}),(0,i.jsx)(R,{small:!0,variant:"ghost",onClick:function(){confirm("Reset this escalation session? Your before/after notes will be cleared.")&&(r(!1),s([]),d(""),g(null),p({}),m({}),b({}),t(null),M(!1),C([]),W(""),j(x,{date:S()}))},ariaLabel:"Reset escalation session",children:"Reset session"})]}),a.length>0&&(0,i.jsxs)("div",{style:{background:f.bgDeep,borderRadius:10,padding:"12px 16px"},children:[(0,i.jsxs)("span",{style:{fontSize:12,fontWeight:700,color:f.textMuted,textTransform:"uppercase",letterSpacing:.5},children:["Before state (",c,"): "]}),(0,i.jsx)("span",{style:{fontSize:13,color:f.text},children:a.join(", ")}),l&&(0,i.jsxs)("span",{style:{fontSize:13,color:f.textMuted},children:[" — ",l]})]}),(0,i.jsxs)(D,{type:"info",children:[(0,i.jsx)("strong",{children:"Decision gate at every level:"})," After the timer — how does the body feel now? Record it below. If the body changed (even slightly) → stay at this level. If no change → escalate to the next level."]}),[{level:1,name:"Postural Reset & Breathing",time:"3–5 min",seconds:240,desc:"Change position. Drink water (cold if available). 3 slow breaths: inhale nose, exhale mouth. Place both feet on the floor.",rationale:"Postural change interrupts proprioceptive feedback. Hydration addresses dehydration-driven sympathetic activation."},{level:2,name:"Sensory Weight",time:"15–20 min",seconds:1020,desc:"Weighted blanket, heavy hoodie, or lap pad. Apply firm pressure — palms together, squeeze arms, press back into wall. If tolerated: cold water on wrists.",rationale:"Deep pressure activates parasympathetic response through proprioceptive loading. Cold input triggers the mammalian dive reflex."},{level:3,name:"Cognitive Loop Interruption",time:"10–15 min",seconds:720,desc:"Count backwards from 100 by 7s. Name objects by category. Describe a physical object in exact detail.",rationale:"Reroutes cognitive resources maintaining the dysregulation loop toward external structured tasks. This is not distraction — it is deliberate cognitive redirection."},{level:4,name:"Rhythmic Override",time:"10–20 min",seconds:900,desc:"Walking (any pace, rhythmic). Rocking. Bilateral tapping — alternate tapping knees or shoulders. Drumming at steady beat. Let the body choose its rhythm.",rationale:"Vestibular and proprioceptive input competes with the cognitive loop for processing resources. Pattern interrupts at the motor cortex level."},{level:5,name:"Sensory Containment",time:"20–30 min",seconds:1500,desc:"Darken room. Noise-canceling headphones or silence. Functional language only. No questions about feelings. No reassurance loops. Containment, not engagement.",rationale:"When the system hasn't responded to increased input, reduce total sensory load. The system is overwhelmed by input volume — including regulatory input."},{level:6,name:"Time-Based Holding",time:"20–30 min",seconds:1500,desc:"Set timer. Stay present. No interventions. No fixing. No techniques. Time and physical safety only.",rationale:"Containment is a valid endpoint. Not every escalation resolves in calm. The goal is that activation does not worsen and the system is given time."}].map(n=>{let o=y[n.level],r=h[n.level];return(0,i.jsxs)("div",{role:"region","aria-label":"Level ".concat(n.level,": ").concat(n.name).concat(o?" — ".concat(o.result):""),style:{background:f.white,borderRadius:12,overflow:"hidden",border:"2px solid ".concat((null==o?void 0:o.result)==="shifted"?f.green:(null==o?void 0:o.result)==="escalate"?f.amber:e===n.level?f.accent:f.borderLight)},children:[(0,i.jsxs)("button",{onClick:()=>{t(e===n.level?null:n.level),M(!1)},"aria-expanded":e===n.level,"aria-controls":"dgaep-level-".concat(n.level),style:{width:"100%",padding:"16px 20px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",background:"transparent",border:"none",fontFamily:"inherit",minHeight:48,textAlign:"left"},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)("div",{"aria-hidden":"true",style:{width:32,height:32,borderRadius:"50%",background:(null==o?void 0:o.result)==="shifted"?f.green:(null==o?void 0:o.result)==="escalate"?f.amber:f.accent,color:f.white,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700},children:(null==o?void 0:o.result)==="shifted"?"✓":(null==o?void 0:o.result)==="escalate"?"↑":n.level}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:17,fontWeight:700,color:f.text},children:n.name}),o&&(0,i.jsxs)("div",{style:{fontSize:12,color:"shifted"===o.result?f.green:f.amber,marginTop:2},children:["shifted"===o.result?"Body shifted":"Escalated"," at ",o.time]})]})]}),(0,i.jsx)("span",{style:{fontSize:13,color:f.textMuted},children:n.time})]}),e===n.level&&(0,i.jsxs)("div",{id:"dgaep-level-".concat(n.level),style:{padding:"0 20px 20px",borderTop:"1px solid ".concat(f.borderLight),paddingTop:14},children:[(0,i.jsx)("p",{style:{fontSize:15,color:f.text,lineHeight:1.7,margin:"0 0 10px"},children:n.desc}),(0,i.jsx)("p",{style:{fontSize:13,color:f.textMuted,lineHeight:1.6,fontStyle:"italic",margin:"0 0 14px",paddingLeft:12,borderLeft:"2px solid ".concat(f.bgWarm)},children:n.rationale}),(0,i.jsx)(B,{duration:n.seconds,label:"Level ".concat(n.level," timer"),onComplete:()=>M(!0)}),!o&&(0,i.jsx)("div",{style:{marginTop:14},children:F?(0,i.jsxs)("div",{style:{marginTop:10},children:[(0,i.jsx)(H,{label:"After Level ".concat(n.level),stateKey:"after-".concat(n.level),selectedStates:z,setSelectedStates:C,freeText:T,setFreeText:W,timestamp:w()}),(0,i.jsxs)("div",{style:{marginTop:12},children:[(0,i.jsx)("p",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:16,fontWeight:700,color:f.text,margin:"0 0 10px"},children:"Did the body show any change?"}),(0,i.jsxs)("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[(0,i.jsx)(R,{variant:"green",onClick:()=>{G(n.level),N(n.level,"shifted")},ariaLabel:"Body shifted — stay at this level",children:"Yes — something shifted"}),(0,i.jsx)(R,{variant:"secondary",onClick:()=>{G(n.level),N(n.level,"escalate")},ariaLabel:"No change — escalate to next level",children:"No change — escalate"})]})]})]}):(0,i.jsx)(R,{small:!0,variant:"secondary",onClick:()=>M(!0),ariaLabel:"Record how your body feels after this level",children:"Record body state after this level"})}),o&&r&&(0,i.jsxs)("div",{style:{marginTop:12,padding:"10px 14px",background:f.bgDeep,borderRadius:8},children:[(0,i.jsx)("span",{style:{fontSize:12,fontWeight:700,color:f.textMuted,textTransform:"uppercase"},children:"Recorded after state: "}),(0,i.jsx)("span",{style:{fontSize:13,color:f.text},children:r.join(", ")||"None selected"}),u[n.level]&&(0,i.jsxs)("span",{style:{fontSize:13,color:f.textMuted},children:[" — ",u[n.level]]})]})]})]},n.level)}),O>0&&(0,i.jsx)(I,{beforeStates:a,beforeNote:l,afterStates:E,afterNote:P}),(0,i.jsxs)("div",{role:"alert",style:{background:f.redSoft,borderRadius:12,padding:"16px 20px",borderLeft:"4px solid ".concat(f.red),marginTop:4},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:15,fontWeight:700,color:f.red,margin:"0 0 4px"},children:"Medical Red Flags — Stop protocol, seek immediate medical help"}),(0,i.jsx)("p",{style:{fontSize:14,color:f.text,lineHeight:1.7,margin:0},children:"Chest pain \xb7 Fainting \xb7 Confusion or disorientation \xb7 Slurred speech \xb7 New neurological symptoms \xb7 Panic persisting for hours without fluctuation"})]})]}):(0,i.jsxs)("section",{"aria-label":"Begin escalation session",style:{background:f.white,border:"2px solid ".concat(f.accent),borderRadius:14,padding:"22px 22px"},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:18,fontWeight:700,color:f.text,margin:"0 0 8px"},children:"Before you begin — capture your body state"}),(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,lineHeight:1.7,margin:"0 0 14px"},children:"This records how your body feels right now, before any escalation steps. You'll capture your state again after each level so you can see what changed. Your working memory is already compromised during escalation — let the tool remember for you."}),(0,i.jsx)(H,{label:"Body State — Right Now",stateKey:"before",selectedStates:a,setSelectedStates:s,freeText:l,setFreeText:d}),(0,i.jsx)("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)(R,{onClick:function(){let e=w();r(!0),g(e),L({started:!0,beforeTime:e})},ariaLabel:"Save body state and begin escalation protocol",children:"Save state & begin escalation"})})]})]})}function P(e){let{entry:t,setEntry:n,sensations:o,setSensations:r,loadDomain:a,setLoadDomain:s,hrv:l,setHrv:d,hr:c,setHr:g,onSave:h,notes:p,setNotes:u}=e,m=e=>r(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]);return(0,i.jsxs)("section",{"aria-label":"Journaling",style:{display:"flex",flexDirection:"column",gap:16},children:[(0,i.jsx)("div",{role:"status",style:{background:f.greenSoft,borderRadius:10,padding:"10px 16px",textAlign:"center"},children:(0,i.jsx)("span",{style:{fontSize:14,fontWeight:700,color:f.green,textTransform:"uppercase",letterSpacing:1.5},children:"Gate Passed — Journaling Unlocked"})}),(0,i.jsxs)(D,{type:"neutral",children:[(0,i.jsx)("strong",{children:"Journaling rules:"})," Storage, not understanding. No decisions while journaling. No reviewing immediately after. If the body worsens, stop."]}),(0,i.jsxs)("fieldset",{style:{border:"none",padding:0,margin:0},children:[(0,i.jsx)("legend",{style:{fontSize:14,fontWeight:700,color:f.textMuted,marginBottom:8},children:"Body Sensations (from your scan)"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6},role:"group","aria-label":"Select body sensations",children:["Tight","Heavy","Buzzy","Numb","Warm","Cold","Racing","Foggy","Shallow breathing","Chest pressure","Throat constriction","Jaw clenched"].map(e=>(0,i.jsx)("button",{onClick:()=>m(e),role:"checkbox","aria-checked":o.includes(e),style:{padding:"7px 14px",borderRadius:20,border:"2px solid ".concat(o.includes(e)?f.accent:f.borderLight),background:o.includes(e)?f.accentGlow:"transparent",color:o.includes(e)?f.accent:f.textMuted,fontSize:13,cursor:"pointer",fontFamily:"inherit",fontWeight:o.includes(e)?700:400,minHeight:36},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:e},e))})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"load-domain",style:{fontSize:13,color:f.textMuted,marginBottom:4,display:"block"},children:"Primary Load Domain"}),(0,i.jsxs)("select",{id:"load-domain",value:a,onChange:e=>s(e.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:6,border:"2px solid ".concat(f.borderLight),fontSize:14,fontFamily:"inherit",color:f.text,background:f.bg,minHeight:44},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:[(0,i.jsx)("option",{value:"",children:"Select..."}),y.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"hrv-input",style:{fontSize:13,color:f.textMuted,marginBottom:4,display:"block"},children:"HRV (SDNN ms)"}),(0,i.jsx)("input",{id:"hrv-input",type:"number",value:l,onChange:e=>d(e.target.value),placeholder:"e.g. 38",style:{width:"100%",padding:"10px 12px",borderRadius:6,border:"2px solid ".concat(f.borderLight),fontSize:14,fontFamily:"inherit",color:f.text,background:f.bg,boxSizing:"border-box",minHeight:44},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"hr-input",style:{fontSize:13,color:f.textMuted,marginBottom:4,display:"block"},children:"Resting HR (bpm)"}),(0,i.jsx)("input",{id:"hr-input",type:"number",value:c,onChange:e=>g(e.target.value),placeholder:"e.g. 68",style:{width:"100%",padding:"10px 12px",borderRadius:6,border:"2px solid ".concat(f.borderLight),fontSize:14,fontFamily:"inherit",color:f.text,background:f.bg,boxSizing:"border-box",minHeight:44},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"journal-entry",style:{fontSize:14,fontWeight:700,color:f.textMuted,marginBottom:6,display:"block"},children:"Journal Entry — describe, don't analyze"}),(0,i.jsx)("textarea",{id:"journal-entry",value:t,onChange:e=>n(e.target.value),placeholder:'"My chest was tight. Shoulders were high. Breathing was shallow." — Description only.',style:{width:"100%",minHeight:100,padding:14,border:"2px solid ".concat(f.borderLight),borderRadius:8,fontSize:15,fontFamily:"'Source Serif 4', Georgia, serif",color:f.text,background:f.bg,resize:"vertical",lineHeight:1.7,boxSizing:"border-box"},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"context-notes",style:{fontSize:13,color:f.textMuted,marginBottom:4,display:"block"},children:"Context notes (what was happening)"}),(0,i.jsx)("input",{id:"context-notes",type:"text",value:p,onChange:e=>u(e.target.value),placeholder:"Brief context...",style:{width:"100%",padding:"10px 14px",borderRadius:6,border:"2px solid ".concat(f.borderLight),fontSize:14,fontFamily:"inherit",color:f.text,background:f.bg,boxSizing:"border-box",minHeight:44},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"}})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("span",{style:{fontSize:13,color:f.textMuted},children:"Store. Save and close. Do not re-read."}),(0,i.jsx)(R,{onClick:h,ariaLabel:"Store journal entry and close",children:"Store & Close"})]})]})}function Y(e){let{entries:t}=e,n=t.filter(e=>e.hrv).sort((e,t)=>e.date.localeCompare(t.date)).map(e=>({date:new Date(e.date+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}),hrv:e.hrv,hr:e.hr||null}));if(n.length<2)return(0,i.jsxs)("div",{style:{textAlign:"center",padding:"32px 20px",color:f.textMuted},children:[(0,i.jsx)("p",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:17,margin:0},children:"Need at least 2 HRV entries to show a trend"}),(0,i.jsx)("p",{style:{fontSize:14,marginTop:6,margin:"6px 0 0"},children:"Log your HRV reading from Apple Health when creating regulation entries."})]});let o=Math.round(n.reduce((e,t)=>e+t.hrv,0)/n.length);return(0,i.jsxs)("section",{"aria-label":"HRV trend chart",children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:12},children:[(0,i.jsx)("span",{style:{fontSize:14,color:f.textMuted},children:"HRV (SDNN ms) — higher indicates better parasympathetic recovery"}),(0,i.jsxs)("span",{style:{fontSize:14,color:f.textMuted},children:["Avg: ",(0,i.jsxs)("strong",{children:[o," ms"]})]})]}),(0,i.jsx)("div",{style:{background:f.white,borderRadius:12,border:"1px solid ".concat(f.borderLight),padding:"16px 8px 8px 0"},children:(0,i.jsx)(r.h,{width:"100%",height:220,children:(0,i.jsxs)(a.c,{data:n,margin:{top:5,right:20,left:0,bottom:5},children:[(0,i.jsx)("defs",{children:(0,i.jsxs)("linearGradient",{id:"hrvGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,i.jsx)("stop",{offset:"5%",stopColor:f.accent,stopOpacity:.2}),(0,i.jsx)("stop",{offset:"95%",stopColor:f.accent,stopOpacity:0})]})}),(0,i.jsx)(s.q,{strokeDasharray:"3 3",stroke:f.borderLight}),(0,i.jsx)(l.K,{dataKey:"date",tick:{fontSize:12,fill:f.textMuted}}),(0,i.jsx)(d.B,{tick:{fontSize:12,fill:f.textMuted},domain:["dataMin - 5","dataMax + 5"]}),(0,i.jsx)(c.u,{contentStyle:{background:f.white,border:"1px solid ".concat(f.border),borderRadius:8,fontSize:14}}),(0,i.jsx)(g.d,{y:o,stroke:f.textMuted,strokeDasharray:"4 4"}),(0,i.jsx)(h.u,{type:"monotone",dataKey:"hrv",stroke:"none",fill:"url(#hrvGradient)"}),(0,i.jsx)(p.x,{type:"monotone",dataKey:"hrv",stroke:f.accent,strokeWidth:2.5,dot:{fill:f.accent,r:3}}),n.some(e=>e.hr)&&(0,i.jsx)(p.x,{type:"monotone",dataKey:"hr",stroke:f.red,strokeWidth:1.5,strokeDasharray:"4 4",dot:!1})]})})})]})}function _(e){let{entries:t}=e,n=[...t].sort((e,t)=>t.date.localeCompare(e.date)),o=n.filter(e=>(new Date-new Date(e.date))/864e5<=7),r=o.length>0?Math.round(o.filter(e=>e.gatePassed).length/o.length*100):0,a=o.length>0?(o.reduce((e,t)=>e+(t.attempts||1),0)/o.length).toFixed(1):"—",s=o.length>0?(o.reduce((e,t)=>{var n;return e+((null===(n=t.stepsCompleted)||void 0===n?void 0:n.length)||0)},0)/o.length).toFixed(1):"—";return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:10,marginBottom:20},role:"group","aria-label":"7-day summary statistics",children:[{val:"".concat(r,"%"),label:"Gate pass (7d)",color:f.green,bg:f.greenSoft},{val:a,label:"Avg attempts",color:f.amber,bg:f.amberSoft},{val:s,label:"Avg steps",color:f.blue,bg:f.blueSoft},{val:"".concat(n.length),label:"Total entries",color:f.accent,bg:f.accentGlow}].map((e,t)=>(0,i.jsxs)("div",{style:{background:e.bg,borderRadius:10,padding:14,textAlign:"center"},"aria-label":"".concat(e.label,": ").concat(e.val),children:[(0,i.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:26,fontWeight:700,color:e.color},children:e.val}),(0,i.jsx)("div",{style:{fontSize:12,color:f.textMuted},children:e.label})]},t))}),(0,i.jsx)("div",{role:"list","aria-label":"Regulation history entries",children:n.slice(0,20).map((e,t)=>{var n;return(0,i.jsxs)("div",{role:"listitem",style:{background:f.white,borderRadius:8,padding:"12px 16px",border:"1px solid ".concat(f.borderLight),marginBottom:6},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,i.jsx)("div",{"aria-hidden":"true",style:{width:10,height:10,borderRadius:"50%",background:e.gatePassed?f.green:e.escalated?f.amber:f.red,flexShrink:0}}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsxs)("div",{style:{fontSize:14,color:f.text,fontWeight:600},children:[new Date(e.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),e.timeOfDay?" \xb7 ".concat(e.timeOfDay):"",e.loadDomain&&(0,i.jsx)("span",{style:{marginLeft:8,padding:"2px 10px",borderRadius:10,background:f.bgDeep,fontSize:12,color:f.textMuted},children:e.loadDomain})]}),e.journal&&(0,i.jsx)("div",{style:{fontSize:13,color:f.textMuted,marginTop:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.journal})]}),(0,i.jsxs)("div",{style:{fontSize:12,color:f.textMuted,textAlign:"right",flexShrink:0},children:[e.gatePassed?"Gate ✓":e.escalated?"Escalated":"No shift",e.stepsCompleted&&(0,i.jsxs)("div",{children:[e.stepsCompleted.length,"/6 steps"]}),e.hrv?(0,i.jsxs)("div",{children:[e.hrv," ms"]}):null]})]}),(null===(n=e.stepsCompleted)||void 0===n?void 0:n.length)>0&&(0,i.jsx)("div",{style:{display:"flex",gap:4,marginTop:8,paddingTop:8,borderTop:"1px solid ".concat(f.borderLight)},"aria-label":"".concat(e.stepsCompleted.length," of 6 steps completed"),children:C.map(t=>(0,i.jsx)("div",{style:{flex:1,height:5,borderRadius:3,background:e.stepsCompleted.includes(t.number)?f.green:f.bgDeep},title:"Step ".concat(t.number,": ").concat(t.title," — ").concat(e.stepsCompleted.includes(t.number)?"completed":"not completed")},t.number))})]},t)})})]})}function J(){return(0,i.jsx)("div",{role:"list","aria-label":"Red line thresholds",style:{display:"flex",flexDirection:"column",gap:10},children:[{title:"Sleep below 5 hours for 2+ consecutive nights",action:"Cancel all non-essential commitments. The system cannot regulate on insufficient sleep."},{title:"Sustained activation for 4+ hours",action:"Activate acute dysregulation protocol → DGAEP → seek human support."},{title:"Loss of appetite for 24+ hours",action:"Dorsal vagal signaling — shutdown. Reduce all demands. Prioritize gentle movement and warmth."},{title:"Inability to complete the regulation loop",action:"Load failure, not regulation failure. Seek co-regulation from a safe person or environment."},{title:"Suicidal ideation or self-harm urges",action:"Medical emergency. Contact emergency services, crisis helpline, or trusted person immediately.",critical:!0}].map((e,t)=>(0,i.jsxs)("div",{role:"listitem",style:{background:e.critical?f.redSoft:f.white,border:"2px solid ".concat(e.critical?f.red:f.border),borderRadius:10,padding:"14px 18px",borderLeft:"4px solid ".concat(f.red)},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:16,fontWeight:700,color:f.text,margin:"0 0 4px"},children:e.title}),(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,lineHeight:1.6,margin:0},children:e.action})]},t))})}function V(){let[e,t]=(0,o.useState)("loop"),[n,r]=(0,o.useState)(1),[a,s]=(0,o.useState)(!1),[l,d]=(0,o.useState)(!1),[c,g]=(0,o.useState)(!1),[h,p]=(0,o.useState)(1),[x,y]=(0,o.useState)(!1),[b,W]=(0,o.useState)(""),[B,G]=(0,o.useState)([]),[A,H]=(0,o.useState)(""),[I,V]=(0,o.useState)(""),[q,U]=(0,o.useState)(""),[K,X]=(0,o.useState)(""),[Q,Z]=(0,o.useState)([]),[$,ee]=(0,o.useState)(!1),[et,en]=(0,o.useState)({});function ei(){r(1),s(!1),d(!1),g(!1),p(1),y(!1),W(""),G([]),H(""),V(""),U(""),X(""),ee(!1)}return(0,o.useEffect)(()=>{Z(v(u,[]));let e=v(m,{date:null,steps:{}});e.date===S()?en(e.steps):j(m,{date:S(),steps:{}})},[]),(0,i.jsxs)("div",{style:{minHeight:"100vh",background:f.bg,fontFamily:"'Source Serif 4', Georgia, serif"},children:[(0,i.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Source+Serif+4:ital,wght@0,300;0,400;0,500;0,600;1,400&display=swap",rel:"stylesheet"}),(0,i.jsx)("a",{href:"#main-content",style:{...z,position:"absolute",top:0,left:0,background:f.accent,color:f.white,padding:"12px 20px",zIndex:100,fontSize:14},onFocus:e=>{e.target.style.position="static",e.target.style.clip="auto",e.target.style.width="auto",e.target.style.height="auto",e.target.style.margin="0",e.target.style.overflow="visible",e.target.style.whiteSpace="normal"},onBlur:e=>Object.assign(e.target.style,z),children:"Skip to main content"}),(0,i.jsx)("header",{style:{borderBottom:"1px solid ".concat(f.border),padding:"24px 20px 18px",background:f.white},children:(0,i.jsxs)("div",{style:{maxWidth:720,margin:"0 auto"},children:[(0,i.jsx)("div",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:12,fontWeight:700,textTransform:"uppercase",letterSpacing:3,color:f.accent,marginBottom:4},children:"The Nervous System Operating Manual"}),(0,i.jsx)("h1",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:28,fontWeight:700,color:f.text,lineHeight:1.2,marginBottom:3,margin:"0 0 3px"},children:"Daily Regulation Protocol"}),(0,i.jsx)("p",{style:{fontSize:15,color:f.textMuted,fontStyle:"italic",margin:0},children:"Your body has a job. Its job is to keep you safe. This protocol tells you how to let it."})]})}),(0,i.jsx)("nav",{"aria-label":"Protocol sections",style:{borderBottom:"1px solid ".concat(f.border),background:f.white,position:"sticky",top:0,zIndex:10},children:(0,i.jsx)("div",{style:{maxWidth:720,margin:"0 auto",display:"flex",overflowX:"auto"},role:"tablist",children:[{id:"loop",label:"Regulation Loop"},{id:"dgaep",label:"Escalation"},{id:"tracking",label:"Tracking"},{id:"analysis",label:"Analysis"},{id:"redlines",label:"Red Lines"}].map(n=>(0,i.jsx)("button",{role:"tab","aria-selected":e===n.id,"aria-controls":"panel-".concat(n.id),id:"tab-".concat(n.id),onClick:()=>t(n.id),style:{padding:"12px 18px",border:"none",borderBottom:e===n.id?"3px solid ".concat(f.accent):"3px solid transparent",background:"transparent",color:e===n.id?f.accent:f.textMuted,fontSize:14,fontWeight:e===n.id?700:400,cursor:"pointer",fontFamily:"inherit",whiteSpace:"nowrap",minHeight:48},onFocus:e=>Object.assign(e.target.style,k),onBlur:e=>{e.target.style.outline="none",e.target.style.outlineOffset="0"},children:n.label},n.id))})}),(0,i.jsxs)("main",{id:"main-content",style:{maxWidth:720,margin:"0 auto",padding:"20px 16px 80px"},children:[(0,i.jsx)("div",{role:"tabpanel",id:"panel-loop","aria-labelledby":"tab-loop",hidden:"loop"!==e,children:"loop"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L,{completedSteps:Object.keys(et).filter(e=>{var t;return null===(t=et[e])||void 0===t?void 0:t.completed}).length,totalSteps:6}),(0,i.jsxs)(D,{type:"info",children:[(0,i.jsx)("strong",{children:"Core Principle:"})," No body change = no next step. The body is the authority, not the mind, not the schedule, not the therapist, and not the protocol itself."]}),(0,i.jsx)("div",{style:{height:16}}),$?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px"},role:"status",children:[(0,i.jsx)("div",{"aria-hidden":"true",style:{fontSize:44,marginBottom:12},children:"○"}),(0,i.jsx)("h2",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:f.green,margin:"0 0 6px"},children:"Entry Stored"}),(0,i.jsx)("p",{style:{fontSize:15,color:f.textMuted,margin:"0 0 20px"},children:"Do not re-read. Processing happens later, on a different day, with full capacity."}),(0,i.jsx)(R,{variant:"secondary",onClick:ei,ariaLabel:"Start a new regulation loop",children:"Start a new loop"})]}):x?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px"},role:"status",children:[(0,i.jsx)("div",{"aria-hidden":"true",style:{fontSize:44,marginBottom:12},children:"↑"}),(0,i.jsx)("h2",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:22,fontWeight:700,color:f.amber,margin:"0 0 6px"},children:"Escalate to DGAEP"}),(0,i.jsx)("p",{style:{fontSize:15,color:f.textMuted,margin:"0 0 6px"},children:"The regulation loop was attempted twice and the body has not shifted. This is not failure — the activation level exceeds first-line capacity."}),(0,i.jsx)("p",{style:{fontSize:14,color:f.textMuted,fontStyle:"italic",margin:"0 0 20px"},children:"When first-line regulation fails, escalation is not failure. It is the next step in the protocol."}),(0,i.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[(0,i.jsx)(R,{onClick:()=>t("dgaep"),ariaLabel:"Open the DGAEP escalation protocol",children:"Open DGAEP Protocol"}),(0,i.jsx)(R,{variant:"secondary",onClick:ei,ariaLabel:"Reset the regulation loop",children:"Reset"})]})]}):c?(0,i.jsx)(P,{entry:b,setEntry:W,sensations:B,setSensations:G,loadDomain:A,setLoadDomain:H,hrv:I,setHrv:V,hr:q,setHr:U,notes:K,setNotes:X,onSave:function(){let e=[...Q,{date:S(),timeOfDay:12>new Date().getHours()?"Morning":17>new Date().getHours()?"Afternoon":"Evening",gatePassed:!0,escalated:!1,attempts:h,stepsCompleted:Object.keys(et).filter(e=>{var t;return null===(t=et[e])||void 0===t?void 0:t.completed}).map(Number),journal:b.trim()||null,sensations:B,loadDomain:A,hrv:I?Number(I):null,hr:q?Number(q):null,notes:K.trim()||null}];Z(e),j(u,e),ee(!0)}}):(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},role:"list","aria-label":"Regulation loop steps",children:[h>1&&(0,i.jsx)("div",{role:"alert",style:{background:f.amberSoft,borderRadius:8,padding:"10px 16px",fontSize:14,color:f.amber,fontWeight:600,textAlign:"center"},children:"Second attempt — if no change this time, escalate to DGAEP."}),C.map(e=>{var t,o;return(0,i.jsx)(F,{stepDef:e,active:n===e.number,completed:n>e.number||(null===(t=et[e.number])||void 0===t?void 0:t.completed)&&n!==e.number,completedTime:null===(o=et[e.number])||void 0===o?void 0:o.time,onComplete:()=>{e.hasBreathingGuide&&s(!1),function(e){let t={...et,[e]:{completed:!0,time:w()}};en(t),j(m,{date:S(),steps:t})}(n),n<6?r(n+1):d(!0)},onBreathingStart:()=>s(!0),breathingActive:a},e.number)}),l&&!c&&(0,i.jsx)(M,{onYes:function(){g(!0)},onNo:function(){if(h<2)p(2),r(1),d(!1);else{y(!0);let e=[...Q,{date:S(),timeOfDay:12>new Date().getHours()?"Morning":17>new Date().getHours()?"Afternoon":"Evening",gatePassed:!1,escalated:!0,attempts:2,stepsCompleted:Object.keys(et).filter(e=>{var t;return null===(t=et[e])||void 0===t?void 0:t.completed}).map(Number),journal:null,sensations:[],loadDomain:"",hrv:I?Number(I):null,hr:q?Number(q):null,notes:""}];Z(e),j(u,e)}},attempt:h})]})]})}),(0,i.jsx)("div",{role:"tabpanel",id:"panel-dgaep","aria-labelledby":"tab-dgaep",hidden:"dgaep"!==e,children:"dgaep"===e&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(E,{})})}),(0,i.jsx)("div",{role:"tabpanel",id:"panel-tracking","aria-labelledby":"tab-tracking",hidden:"tracking"!==e,children:"tracking"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:16},children:[(0,i.jsx)(T,{title:"Tracking",subtitle:"The pattern matters, not the individual day."}),Q.length>0&&(0,i.jsx)(R,{small:!0,variant:"ghost",onClick:()=>{confirm("Clear all data?")&&(Z([]),j(u,[]))},ariaLabel:"Clear all tracking data",children:"Reset"})]}),0===Q.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:f.textMuted},children:[(0,i.jsx)("p",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:17,margin:0},children:"No entries yet"}),(0,i.jsx)("p",{style:{fontSize:14,marginTop:6,margin:"6px 0 0"},children:"Complete your first regulation loop to begin tracking."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Y,{entries:Q}),(0,i.jsx)("div",{style:{height:20}}),(0,i.jsx)(_,{entries:Q})]})]})}),(0,i.jsx)("div",{role:"tabpanel",id:"panel-analysis","aria-labelledby":"tab-analysis",hidden:"analysis"!==e,children:"analysis"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T,{title:"Analysis",subtitle:"Claude-powered pattern detection and load domain identification."}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[(0,i.jsx)(N,{}),(0,i.jsx)(O,{entries:Q})]})]})}),(0,i.jsx)("div",{role:"tabpanel",id:"panel-redlines","aria-labelledby":"tab-redlines",hidden:"redlines"!==e,children:"redlines"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T,{title:"Red Lines",subtitle:"Non-negotiable structural load limits. Crossing a red line is not failure — it is the system signaling that protective action is required."}),(0,i.jsx)(J,{}),(0,i.jsxs)("div",{style:{marginTop:24,background:f.bgDeep,borderRadius:12,padding:"18px 20px"},children:[(0,i.jsx)("h3",{style:{fontFamily:"'Cormorant Garamond', Georgia, serif",fontSize:17,fontWeight:700,color:f.text,margin:"0 0 10px"},children:"What Success Looks Like"}),[{period:"Daily",desc:"The regulation loop produces a body change more often than it does not. Some days it will not work. The pattern matters."},{period:"Weekly",desc:"The weekly reset identifies at least one recurring pattern. You begin to see the system's habits rather than being caught in them."},{period:"Monthly",desc:"Baseline HRV and resting HR trend favorably. More time in ventral vagal, less in sustained sympathetic or dorsal vagal."},{period:"Quarterly",desc:"Higher load tolerance before the gate's 'no change' branch. Window of tolerance widened through sustained regulation."}].map((e,t)=>(0,i.jsxs)("p",{style:{fontSize:14,color:f.textMuted,lineHeight:1.7,margin:"0 0 6px"},children:[(0,i.jsxs)("strong",{style:{color:f.text},children:[e.period,":"]})," ",e.desc]},t)),(0,i.jsx)("p",{style:{marginTop:12,fontSize:14,color:f.textMuted,fontStyle:"italic",borderTop:"1px solid ".concat(f.border),paddingTop:10,margin:"12px 0 0"},children:"The protocol does not cure anything. It manages load. This is not dependency — it is maintenance. You do not stop maintaining a bridge because it has not collapsed yet."})]})]})})]}),(0,i.jsxs)("footer",{style:{borderTop:"1px solid ".concat(f.border),padding:"16px 20px",textAlign:"center",background:f.white},children:[(0,i.jsx)("p",{style:{fontSize:12,color:f.textMuted,margin:0},children:"The Nervous System Operating Manual — Yve Bergeron — Neurodiversity & Autism Studies, University College Cork"}),(0,i.jsx)("p",{style:{fontSize:11,color:f.textMuted,marginTop:2,fontStyle:"italic",margin:"2px 0 0"},children:"The nervous system is the last interface."})]})]})}}},function(e){e.O(0,[273,971,117,744],function(){return e(e.s=1716)}),_N_E=e.O()}]);